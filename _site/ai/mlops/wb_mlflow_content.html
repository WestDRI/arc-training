<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Marie-Hélène Burle">

<title>Experiment tracking with MLflow – Research Computing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../ai/mlops/wb_mlflow.html" rel="prev">
<link href="../..//img/favicon_sfu.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-48758e0ea246f80a9d80e8901e3a7c2a.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-3ab34fd50eaf4c251bc27ae6cc09dd28.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-7E8D6VP6FH"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-7E8D6VP6FH', { 'anonymize_ip': true});
</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../img/favicon_sfudrac.png" alt="SFU &amp; DRAC logos" class="navbar-logo light-content">
    <img src="../../img/favicon_sfudrac.png" alt="SFU &amp; DRAC logos" class="navbar-logo dark-content">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../ai/index.html" aria-current="page"> 
<span class="menu-text">AI</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../r/index.html"> 
<span class="menu-text">R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../python/index.html"> 
<span class="menu-text">Python</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../julia/index.html"> 
<span class="menu-text">Julia</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../git/index.html"> 
<span class="menu-text">Git</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../bash/index.html"> 
<span class="menu-text">Bash/Zsh</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../emacs/index.html"> 
<span class="menu-text">Emacs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tools/index.html"> 
<span class="menu-text">Tools</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/WestDRI" title="" class="quarto-navigation-tool px-1" aria-label="GitHub organization" target="_blank"><i class="bi bi-github"></i></a>
    <a href="https://docs.alliancecan.ca/wiki/Technical_documentation" title="" class="quarto-navigation-tool px-1" aria-label="Alliance wikipedia" target="_blank"><i class="bi bi-wikipedia"></i></a>
    <a href="https://www.youtube.com/channel/UCfgds4Qf7VFOv4ORRvFFmhw" title="" class="quarto-navigation-tool px-1" aria-label="YouTube channel" target="_blank"><i class="bi bi-youtube"></i></a>
    <a href="../../calendar.html" title="Upcoming training events" class="quarto-navigation-tool px-1" aria-label="Training calendar"><i class="bi bi-calendar-week"></i></a>
    <a href="../../newsletter.html" title="Training events mailing list" class="quarto-navigation-tool px-1" aria-label="Newsletter"><i class="bi bi-envelope-fill"></i></a>
    <a href="../../contact.html" title="Contact" class="quarto-navigation-tool px-1" aria-label="Contact us"><i class="bi bi-mailbox2"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title">Experiment tracking with MLflow</h1>
        </a>     
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><br>&nbsp;<em><b>AI</b></em><br><br></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../ai/top_pt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><b><em>Intro DL with PyTorch</em></b></span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../ai/pt/pt_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/pt/pt_intro_content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><em>Slides content</em></span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/pt/pt_choosing_frameworks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Which framework to choose?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/pt/pt_high_level_frameworks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">High-level frameworks</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../ai/pt/pt_nn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to NN</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/pt/pt_nn_content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><em>Slides content</em></span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/pt/pt_pytorch.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The PyTorch API</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/pt/pt_tensors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PyTorch tensors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/pt/pt_autograd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/pt/pt_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workflow</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/pt/pt_checkpoints.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Creating checkpoints</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/pt/pt_mnist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Example: the MNIST</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/pt/pt_hpc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DL on production clusters</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/pt/pt_resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../ai/top_jx.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><b><em>The JAX library</em></b></span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/jx/jx_why.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Why JAX?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/jx/jx_map.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How does it work?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/jx/jx_install.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Installation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/jx/jx_jobs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Running jobs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/jx/jx_numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Relation to NumPy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/jx/jx_jit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">JIT compilation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/jx/jx_benchmark.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Benchmarking JAX code</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/jx/jx_accelerator.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Accelerators</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/jx/jx_pytree.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pytrees</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/jx/jx_ad.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/jx/jx_parallel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Parallel computing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/jx/jx_optimizations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pushing optimizations further</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/jx/jx_libraries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Libraries built on JAX</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/jx/jx_resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../ai/top_fl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><b><em>Intro DL with JAX</em></b></span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../ai/fl/fl_jax.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction: JAX</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/fl/fl_jax_content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><em>Slides content</em></span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/fl/fl_run.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Running JAX</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/fl/fl_install.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Installing packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/fl/fl_numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Relation to NumPy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/fl/fl_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Loading data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/fl/fl_preprocess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preprocessing data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/fl/fl_nn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Defining a model architecture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/fl/fl_load_weights.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Loading pre-trained weights</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/fl/fl_hyperparameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hyperparameters</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/fl/fl_finetune.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fine-tuning the model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/fl/fl_scale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Training at scale</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/fl/fl_resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../ai/sk_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><b><em>ML with Scikit-learn</em></b></span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/sk_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">What is scikit-learn?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/sk_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sklearn workflow</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../ai/top_ws.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><b><em>Workshops</em></b></span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/pt/ws_audio_dataloader.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Audio DataLoader with PyTorch</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/pt/ws_pretrained_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Finding pre-trained models</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../ai/ws_hss_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Intro ML for the humanities</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/ws_hss_intro_content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><em>Slides content</em></span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../ai/ws_dl_nlp_llm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Intro to DL, NLP, and LLMs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/ws_dl_nlp_llm_content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><em>Slides content</em></span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../ai/top_wb.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><b><em>Webinars</em></b></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../ai/wb_frameworks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Current ML frameworks</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/wb_frameworks_content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><em>Slides content</em></span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../ai/wb_dvc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data &amp; model version control</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/wb_dvc_content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><em>Slides content</em></span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../ai/jx/wb_jax.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Accelerated array &amp; AD</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/jx/wb_jax_content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><em>Slides content</em></span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../ai/pt/wb_upscaling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Image upscaling</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/pt/wb_upscaling_content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><em>Slides content</em></span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../ai/wb_copilot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AI-powered coding</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/wb_copilot_content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><em>Slides content</em></span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/pt/wb_fastai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Easier PyTorch with fastai</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/wb_flux.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DL in Julia with Flux</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../ai/pt/wb_torchtensors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PyTorch tensors in depth</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-17" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/pt/wb_torchtensors_content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><em>Slides content</em></span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../ai/jxbayesian/wb_bayesian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian inference in JAX</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-18" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/jxbayesian/wb_bayesian_content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><em>Slides content</em></span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../ai/mlops/wb_mlflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ML experiment tracking</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-19" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ai/mlops/wb_mlflow_content.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><em>Slides content</em></span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title"><em>On this page:</em></h2>
   
  <ul>
  <li><a href="#experiment-tracking" id="toc-experiment-tracking" class="nav-link active" data-scroll-target="#experiment-tracking">Experiment tracking</a>
  <ul>
  <li><a href="#lots-of-moving-parts" id="toc-lots-of-moving-parts" class="nav-link" data-scroll-target="#lots-of-moving-parts">Lots of moving parts</a></li>
  <li><a href="#challenging-tracking" id="toc-challenging-tracking" class="nav-link" data-scroll-target="#challenging-tracking">Challenging tracking</a></li>
  <li><a href="#experiment-tracking-tools" id="toc-experiment-tracking-tools" class="nav-link" data-scroll-target="#experiment-tracking-tools">Experiment tracking tools</a></li>
  </ul></li>
  <li><a href="#mlflow-overview" id="toc-mlflow-overview" class="nav-link" data-scroll-target="#mlflow-overview">MLflow overview</a>
  <ul>
  <li><a href="#platform-for-ai-life-cycle" id="toc-platform-for-ai-life-cycle" class="nav-link" data-scroll-target="#platform-for-ai-life-cycle">Platform for AI life cycle</a></li>
  <li><a href="#use-cases" id="toc-use-cases" class="nav-link" data-scroll-target="#use-cases">Use cases</a></li>
  <li><a href="#foss-compatible" id="toc-foss-compatible" class="nav-link" data-scroll-target="#foss-compatible">FOSS &amp; compatible</a></li>
  <li><a href="#used-by-proprietary-tools" id="toc-used-by-proprietary-tools" class="nav-link" data-scroll-target="#used-by-proprietary-tools">Used by proprietary tools</a></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations">Limitations</a></li>
  </ul></li>
  <li><a href="#tracking-with-mlflow" id="toc-tracking-with-mlflow" class="nav-link" data-scroll-target="#tracking-with-mlflow">Tracking with MLflow</a>
  <ul>
  <li><a href="#install-mlflow" id="toc-install-mlflow" class="nav-link" data-scroll-target="#install-mlflow">Install MLflow</a></li>
  <li><a href="#definitions-in-mlflow-context" id="toc-definitions-in-mlflow-context" class="nav-link" data-scroll-target="#definitions-in-mlflow-context">Definitions in MLflow context</a></li>
  <li><a href="#mlflow-tracking-workflow" id="toc-mlflow-tracking-workflow" class="nav-link" data-scroll-target="#mlflow-tracking-workflow">MLflow tracking workflow</a></li>
  <li><a href="#mlflow-tracking-setup" id="toc-mlflow-tracking-setup" class="nav-link" data-scroll-target="#mlflow-tracking-setup">MLflow tracking setup</a>
  <ul>
  <li><a href="#create-an-experiment" id="toc-create-an-experiment" class="nav-link" data-scroll-target="#create-an-experiment">Create an experiment</a></li>
  <li><a href="#launch-mlflow-server" id="toc-launch-mlflow-server" class="nav-link" data-scroll-target="#launch-mlflow-server">Launch MLflow server</a>
  <ul class="collapse">
  <li><a href="#alliance-clusters" id="toc-alliance-clusters" class="nav-link" data-scroll-target="#alliance-clusters">Alliance clusters</a></li>
  </ul></li>
  <li><a href="#access-the-ui" id="toc-access-the-ui" class="nav-link" data-scroll-target="#access-the-ui">Access the UI</a>
  <ul class="collapse">
  <li><a href="#alliance-clusters-1" id="toc-alliance-clusters-1" class="nav-link" data-scroll-target="#alliance-clusters-1">Alliance clusters</a></li>
  </ul></li>
  <li><a href="#log-tracking-data" id="toc-log-tracking-data" class="nav-link" data-scroll-target="#log-tracking-data">Log tracking data</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#use-case-1-model-tracking" id="toc-use-case-1-model-tracking" class="nav-link" data-scroll-target="#use-case-1-model-tracking">Use case 1: model tracking</a>
  <ul>
  <li><a href="#benefits-of-using-mlflow" id="toc-benefits-of-using-mlflow" class="nav-link" data-scroll-target="#benefits-of-using-mlflow">Benefits of using MLflow</a></li>
  <li><a href="#workflow" id="toc-workflow" class="nav-link" data-scroll-target="#workflow">Workflow</a></li>
  <li><a href="#model-demo" id="toc-model-demo" class="nav-link" data-scroll-target="#model-demo">Model demo</a>
  <ul>
  <li><a href="#create-an-experiment-1" id="toc-create-an-experiment-1" class="nav-link" data-scroll-target="#create-an-experiment-1">Create an experiment</a></li>
  <li><a href="#launch-mlflow-server-1" id="toc-launch-mlflow-server-1" class="nav-link" data-scroll-target="#launch-mlflow-server-1">Launch MLflow server</a></li>
  <li><a href="#access-the-ui-1" id="toc-access-the-ui-1" class="nav-link" data-scroll-target="#access-the-ui-1">Access the UI</a></li>
  <li><a href="#log-tracking-data-1" id="toc-log-tracking-data-1" class="nav-link" data-scroll-target="#log-tracking-data-1">Log tracking data</a>
  <ul class="collapse">
  <li><a href="#prepare-data" id="toc-prepare-data" class="nav-link" data-scroll-target="#prepare-data">Prepare data</a></li>
  <li><a href="#define-model" id="toc-define-model" class="nav-link" data-scroll-target="#define-model">Define model</a></li>
  <li><a href="#set-training-conditions" id="toc-set-training-conditions" class="nav-link" data-scroll-target="#set-training-conditions">Set training conditions</a></li>
  <li><a href="#train" id="toc-train" class="nav-link" data-scroll-target="#train">Train</a></li>
  </ul></li>
  <li><a href="#visualize-metrics" id="toc-visualize-metrics" class="nav-link" data-scroll-target="#visualize-metrics">Visualize metrics</a></li>
  <li><a href="#create-a-new-run" id="toc-create-a-new-run" class="nav-link" data-scroll-target="#create-a-new-run">Create a new run</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#use-case-2-tuning" id="toc-use-case-2-tuning" class="nav-link" data-scroll-target="#use-case-2-tuning">Use case 2: tuning</a>
  <ul>
  <li><a href="#hyperparameter-tuning" id="toc-hyperparameter-tuning" class="nav-link" data-scroll-target="#hyperparameter-tuning">Hyperparameter tuning</a></li>
  <li><a href="#tuning-frameworks" id="toc-tuning-frameworks" class="nav-link" data-scroll-target="#tuning-frameworks">Tuning frameworks</a></li>
  <li><a href="#workflow-1" id="toc-workflow-1" class="nav-link" data-scroll-target="#workflow-1">Workflow</a></li>
  <li><a href="#tuning-demo" id="toc-tuning-demo" class="nav-link" data-scroll-target="#tuning-demo">Tuning demo</a>
  <ul>
  <li><a href="#create-an-experiment-2" id="toc-create-an-experiment-2" class="nav-link" data-scroll-target="#create-an-experiment-2">Create an experiment</a></li>
  <li><a href="#launch-mlflow-server-2" id="toc-launch-mlflow-server-2" class="nav-link" data-scroll-target="#launch-mlflow-server-2">Launch MLflow server</a></li>
  <li><a href="#access-the-ui-2" id="toc-access-the-ui-2" class="nav-link" data-scroll-target="#access-the-ui-2">Access the UI</a></li>
  <li><a href="#log-tracking-data-2" id="toc-log-tracking-data-2" class="nav-link" data-scroll-target="#log-tracking-data-2">Log tracking data</a>
  <ul class="collapse">
  <li><a href="#prepare-data-1" id="toc-prepare-data-1" class="nav-link" data-scroll-target="#prepare-data-1">Prepare data</a></li>
  <li><a href="#objective-function" id="toc-objective-function" class="nav-link" data-scroll-target="#objective-function">Objective function</a></li>
  <li><a href="#optimization-task" id="toc-optimization-task" class="nav-link" data-scroll-target="#optimization-task">Optimization task</a></li>
  </ul></li>
  <li><a href="#visualize-trials-errors" id="toc-visualize-trials-errors" class="nav-link" data-scroll-target="#visualize-trials-errors">Visualize trials errors</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#use-case-3-model-registry" id="toc-use-case-3-model-registry" class="nav-link" data-scroll-target="#use-case-3-model-registry">Use case 3: model registry</a>
  <ul>
  <li><a href="#benefits" id="toc-benefits" class="nav-link" data-scroll-target="#benefits">Benefits</a></li>
  <li><a href="#register-models" id="toc-register-models" class="nav-link" data-scroll-target="#register-models">Register models</a>
  <ul>
  <li><a href="#register-models-in-the-ui" id="toc-register-models-in-the-ui" class="nav-link" data-scroll-target="#register-models-in-the-ui">Register models in the UI</a></li>
  <li><a href="#register-programmatically" id="toc-register-programmatically" class="nav-link" data-scroll-target="#register-programmatically">Register programmatically</a></li>
  </ul></li>
  <li><a href="#load-registered-model" id="toc-load-registered-model" class="nav-link" data-scroll-target="#load-registered-model">Load registered model</a></li>
  <li><a href="#model-registry-demo" id="toc-model-registry-demo" class="nav-link" data-scroll-target="#model-registry-demo">Model registry demo</a>
  <ul>
  <li><a href="#register-models-in-the-ui-1" id="toc-register-models-in-the-ui-1" class="nav-link" data-scroll-target="#register-models-in-the-ui-1">Register models in the UI</a></li>
  <li><a href="#register-models-in-python" id="toc-register-models-in-python" class="nav-link" data-scroll-target="#register-models-in-python">Register models in Python</a></li>
  <li><a href="#load-registered-models" id="toc-load-registered-models" class="nav-link" data-scroll-target="#load-registered-models">Load registered models</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#models-signatures" id="toc-models-signatures" class="nav-link" data-scroll-target="#models-signatures">Models signatures</a>
  <ul>
  <li><a href="#benefits-of-models-signatures" id="toc-benefits-of-models-signatures" class="nav-link" data-scroll-target="#benefits-of-models-signatures">Benefits of models signatures</a></li>
  <li><a href="#input-examples" id="toc-input-examples" class="nav-link" data-scroll-target="#input-examples">Input examples</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a>
  <ul>
  <li><a href="#signature-test" id="toc-signature-test" class="nav-link" data-scroll-target="#signature-test">Signature test</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#use-case-4-datasets-tracking" id="toc-use-case-4-datasets-tracking" class="nav-link" data-scroll-target="#use-case-4-datasets-tracking">Use case 4: datasets tracking</a>
  <ul>
  <li><a href="#benefits-1" id="toc-benefits-1" class="nav-link" data-scroll-target="#benefits-1">Benefits</a></li>
  <li><a href="#supported-data-types" id="toc-supported-data-types" class="nav-link" data-scroll-target="#supported-data-types">Supported data types</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Experiment tracking with MLflow</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Marie-Hélène Burle </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="def">
<p><em>Content from <a href="../../ai/mlops/wb_mlflow_slides.html">the webinar slides</a> for easier browsing.</em></p>
</div>
<section id="experiment-tracking" class="level2">
<h2 class="anchored" data-anchor-id="experiment-tracking">Experiment tracking</h2>
<section id="lots-of-moving-parts" class="level3">
<h3 class="anchored" data-anchor-id="lots-of-moving-parts">Lots of moving parts</h3>
<p>AI experiments come with a lot of components:</p>
<ul>
<li>Datasets</li>
<li>Model architectures</li>
<li>Hyperparameters</li>
</ul>
<p>While developing an efficient model, various datasets will be trained on various architectures tuned with various hyperparameters.</p>
</section>
<section id="challenging-tracking" class="level3">
<h3 class="anchored" data-anchor-id="challenging-tracking">Challenging tracking</h3>
<div class="right">
<p><span class="small">*hp = hyperparameter</span></p>
</div>
<div class="cell" data-fig-height="50%" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<svg width="672" height="NaN" viewbox="0.00 0.00 422.00 188.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 184)">
<!-- data1 -->
<g id="node1" class="node">
<title>data1</title>
<ellipse fill="none" stroke="darkviolet" stroke-width="0.5" cx="27" cy="-162" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="27" y="-159.3" font-family="Inconsolata, sans-serif" font-size="9.00">data1</text>
</g>
<!-- model1 -->
<g id="node7" class="node">
<title>model1</title>
<ellipse fill="none" stroke="#009acd" stroke-width="0.5" cx="135" cy="-90" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="135" y="-87.3" font-family="Inconsolata, sans-serif" font-size="9.00">model1</text>
</g>
<!-- data1&#45;&gt;model1 -->
<g id="edge1" class="edge">
<title>data1-&gt;model1</title>
<path fill="none" stroke="darkviolet" stroke-width="0.5" d="M45.81,-148.81C64.24,-136.86 92.35,-118.64 112.08,-105.86"></path>
<polygon fill="darkviolet" stroke="darkviolet" stroke-width="0.5" points="116.4,-103.05 113.43,-107.66 114.31,-104.41 112.21,-105.77 112.21,-105.77 112.21,-105.77 114.31,-104.41 110.98,-103.88 116.4,-103.05 116.4,-103.05"></polygon>
</g>
<!-- model2 -->
<g id="node8" class="node">
<title>model2</title>
<ellipse fill="none" stroke="#009acd" stroke-width="0.5" cx="207" cy="-90" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="207" y="-87.3" font-family="Inconsolata, sans-serif" font-size="9.00">model2</text>
</g>
<!-- data1&#45;&gt;model2 -->
<g id="edge2" class="edge">
<title>data1-&gt;model2</title>
<path fill="none" stroke="darkviolet" stroke-width="0.5" d="M48.13,-150.51C52.97,-148.25 58.12,-145.96 63,-144 109.96,-125.16 124.04,-126.84 171,-108 174.35,-106.66 177.84,-105.15 181.26,-103.61"></path>
<polygon fill="darkviolet" stroke="darkviolet" stroke-width="0.5" points="185.87,-101.49 182.26,-105.62 183.59,-102.54 181.32,-103.58 181.32,-103.58 181.32,-103.58 183.59,-102.54 180.38,-101.53 185.87,-101.49 185.87,-101.49"></polygon>
</g>
<!-- model3 -->
<g id="node9" class="node">
<title>model3</title>
<ellipse fill="none" stroke="#009acd" stroke-width="0.5" cx="279" cy="-90" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="279" y="-87.3" font-family="Inconsolata, sans-serif" font-size="9.00">model3</text>
</g>
<!-- data1&#45;&gt;model3 -->
<g id="edge3" class="edge">
<title>data1-&gt;model3</title>
<path fill="none" stroke="darkviolet" stroke-width="0.5" d="M47.59,-150.23C52.54,-147.93 57.88,-145.69 63,-144 140.46,-118.39 165.54,-133.61 243,-108 246.52,-106.84 250.14,-105.41 253.67,-103.89"></path>
<polygon fill="darkviolet" stroke="darkviolet" stroke-width="0.5" points="258.41,-101.77 254.77,-105.87 256.13,-102.79 253.85,-103.82 253.85,-103.82 253.85,-103.82 256.13,-102.79 252.93,-101.76 258.41,-101.77 258.41,-101.77"></polygon>
</g>
<!-- data2 -->
<g id="node2" class="node">
<title>data2</title>
<ellipse fill="none" stroke="darkviolet" stroke-width="0.5" cx="99" cy="-162" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="99" y="-159.3" font-family="Inconsolata, sans-serif" font-size="9.00">data2</text>
</g>
<!-- data2&#45;&gt;model1 -->
<g id="edge4" class="edge">
<title>data2-&gt;model1</title>
<path fill="none" stroke="darkviolet" stroke-width="0.5" d="M107.35,-144.76C112.39,-134.96 118.87,-122.36 124.29,-111.83"></path>
<polygon fill="darkviolet" stroke="darkviolet" stroke-width="0.5" points="126.7,-107.15 126.41,-112.62 125.55,-109.37 124.41,-111.59 124.41,-111.59 124.41,-111.59 125.55,-109.37 122.41,-110.56 126.7,-107.15 126.7,-107.15"></polygon>
</g>
<!-- data2&#45;&gt;model2 -->
<g id="edge5" class="edge">
<title>data2-&gt;model2</title>
<path fill="none" stroke="darkviolet" stroke-width="0.5" d="M117.81,-148.81C136.24,-136.86 164.35,-118.64 184.08,-105.86"></path>
<polygon fill="darkviolet" stroke="darkviolet" stroke-width="0.5" points="188.4,-103.05 185.43,-107.66 186.31,-104.41 184.21,-105.77 184.21,-105.77 184.21,-105.77 186.31,-104.41 182.98,-103.88 188.4,-103.05 188.4,-103.05"></polygon>
</g>
<!-- data2&#45;&gt;model3 -->
<g id="edge6" class="edge">
<title>data2-&gt;model3</title>
<path fill="none" stroke="darkviolet" stroke-width="0.5" d="M120.13,-150.51C124.97,-148.25 130.12,-145.96 135,-144 181.96,-125.16 196.04,-126.84 243,-108 246.35,-106.66 249.84,-105.15 253.26,-103.61"></path>
<polygon fill="darkviolet" stroke="darkviolet" stroke-width="0.5" points="257.87,-101.49 254.26,-105.62 255.59,-102.54 253.32,-103.58 253.32,-103.58 253.32,-103.58 255.59,-102.54 252.38,-101.53 257.87,-101.49 257.87,-101.49"></polygon>
</g>
<!-- data3 -->
<g id="node3" class="node">
<title>data3</title>
<ellipse fill="none" stroke="darkviolet" stroke-width="0.5" cx="171" cy="-162" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="171" y="-159.3" font-family="Inconsolata, sans-serif" font-size="9.00">data3</text>
</g>
<!-- data3&#45;&gt;model1 -->
<g id="edge7" class="edge">
<title>data3-&gt;model1</title>
<path fill="none" stroke="darkviolet" stroke-width="0.5" d="M162.65,-144.76C157.61,-134.96 151.13,-122.36 145.71,-111.83"></path>
<polygon fill="darkviolet" stroke="darkviolet" stroke-width="0.5" points="143.3,-107.15 147.59,-110.56 144.45,-109.37 145.59,-111.59 145.59,-111.59 145.59,-111.59 144.45,-109.37 143.59,-112.62 143.3,-107.15 143.3,-107.15"></polygon>
</g>
<!-- data3&#45;&gt;model2 -->
<g id="edge8" class="edge">
<title>data3-&gt;model2</title>
<path fill="none" stroke="darkviolet" stroke-width="0.5" d="M179.35,-144.76C184.39,-134.96 190.87,-122.36 196.29,-111.83"></path>
<polygon fill="darkviolet" stroke="darkviolet" stroke-width="0.5" points="198.7,-107.15 198.41,-112.62 197.55,-109.37 196.41,-111.59 196.41,-111.59 196.41,-111.59 197.55,-109.37 194.41,-110.56 198.7,-107.15 198.7,-107.15"></polygon>
</g>
<!-- data3&#45;&gt;model3 -->
<g id="edge9" class="edge">
<title>data3-&gt;model3</title>
<path fill="none" stroke="darkviolet" stroke-width="0.5" d="M189.81,-148.81C208.24,-136.86 236.35,-118.64 256.08,-105.86"></path>
<polygon fill="darkviolet" stroke="darkviolet" stroke-width="0.5" points="260.4,-103.05 257.43,-107.66 258.31,-104.41 256.21,-105.77 256.21,-105.77 256.21,-105.77 258.31,-104.41 254.98,-103.88 260.4,-103.05 260.4,-103.05"></polygon>
</g>
<!-- hp1 -->
<g id="node4" class="node">
<title>hp1</title>
<ellipse fill="none" stroke="#528b8b" stroke-width="0.5" cx="243" cy="-162" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="243" y="-159.3" font-family="Inconsolata, sans-serif" font-size="9.00">hp1</text>
</g>
<!-- hp1&#45;&gt;model1 -->
<g id="edge10" class="edge">
<title>hp1-&gt;model1</title>
<path fill="none" stroke="#528b8b" stroke-width="0.5" d="M224.19,-148.81C205.76,-136.86 177.65,-118.64 157.92,-105.86"></path>
<polygon fill="#528b8b" stroke="#528b8b" stroke-width="0.5" points="153.6,-103.05 159.02,-103.88 155.69,-104.41 157.79,-105.77 157.79,-105.77 157.79,-105.77 155.69,-104.41 156.57,-107.66 153.6,-103.05 153.6,-103.05"></polygon>
</g>
<!-- hp1&#45;&gt;model2 -->
<g id="edge11" class="edge">
<title>hp1-&gt;model2</title>
<path fill="none" stroke="#528b8b" stroke-width="0.5" d="M234.65,-144.76C229.61,-134.96 223.13,-122.36 217.71,-111.83"></path>
<polygon fill="#528b8b" stroke="#528b8b" stroke-width="0.5" points="215.3,-107.15 219.59,-110.56 216.45,-109.37 217.59,-111.59 217.59,-111.59 217.59,-111.59 216.45,-109.37 215.59,-112.62 215.3,-107.15 215.3,-107.15"></polygon>
</g>
<!-- hp1&#45;&gt;model3 -->
<g id="edge12" class="edge">
<title>hp1-&gt;model3</title>
<path fill="none" stroke="#528b8b" stroke-width="0.5" d="M251.35,-144.76C256.39,-134.96 262.87,-122.36 268.29,-111.83"></path>
<polygon fill="#528b8b" stroke="#528b8b" stroke-width="0.5" points="270.7,-107.15 270.41,-112.62 269.55,-109.37 268.41,-111.59 268.41,-111.59 268.41,-111.59 269.55,-109.37 266.41,-110.56 270.7,-107.15 270.7,-107.15"></polygon>
</g>
<!-- hp2 -->
<g id="node5" class="node">
<title>hp2</title>
<ellipse fill="none" stroke="#528b8b" stroke-width="0.5" cx="315" cy="-162" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="315" y="-159.3" font-family="Inconsolata, sans-serif" font-size="9.00">hp2</text>
</g>
<!-- hp2&#45;&gt;model1 -->
<g id="edge13" class="edge">
<title>hp2-&gt;model1</title>
<path fill="none" stroke="#528b8b" stroke-width="0.5" d="M293.87,-150.51C289.03,-148.25 283.88,-145.96 279,-144 232.04,-125.16 217.96,-126.84 171,-108 167.65,-106.66 164.16,-105.15 160.74,-103.61"></path>
<polygon fill="#528b8b" stroke="#528b8b" stroke-width="0.5" points="156.13,-101.49 161.62,-101.53 158.41,-102.54 160.68,-103.58 160.68,-103.58 160.68,-103.58 158.41,-102.54 159.74,-105.62 156.13,-101.49 156.13,-101.49"></polygon>
</g>
<!-- hp2&#45;&gt;model2 -->
<g id="edge14" class="edge">
<title>hp2-&gt;model2</title>
<path fill="none" stroke="#528b8b" stroke-width="0.5" d="M296.19,-148.81C277.76,-136.86 249.65,-118.64 229.92,-105.86"></path>
<polygon fill="#528b8b" stroke="#528b8b" stroke-width="0.5" points="225.6,-103.05 231.02,-103.88 227.69,-104.41 229.79,-105.77 229.79,-105.77 229.79,-105.77 227.69,-104.41 228.57,-107.66 225.6,-103.05 225.6,-103.05"></polygon>
</g>
<!-- hp2&#45;&gt;model3 -->
<g id="edge15" class="edge">
<title>hp2-&gt;model3</title>
<path fill="none" stroke="#528b8b" stroke-width="0.5" d="M306.65,-144.76C301.61,-134.96 295.13,-122.36 289.71,-111.83"></path>
<polygon fill="#528b8b" stroke="#528b8b" stroke-width="0.5" points="287.3,-107.15 291.59,-110.56 288.45,-109.37 289.59,-111.59 289.59,-111.59 289.59,-111.59 288.45,-109.37 287.59,-112.62 287.3,-107.15 287.3,-107.15"></polygon>
</g>
<!-- hp3 -->
<g id="node6" class="node">
<title>hp3</title>
<ellipse fill="none" stroke="#528b8b" stroke-width="0.5" cx="387" cy="-162" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="387" y="-159.3" font-family="Inconsolata, sans-serif" font-size="9.00">hp3</text>
</g>
<!-- hp3&#45;&gt;model1 -->
<g id="edge16" class="edge">
<title>hp3-&gt;model1</title>
<path fill="none" stroke="#528b8b" stroke-width="0.5" d="M366.41,-150.23C361.46,-147.93 356.12,-145.69 351,-144 273.54,-118.39 248.46,-133.61 171,-108 167.48,-106.84 163.86,-105.41 160.33,-103.89"></path>
<polygon fill="#528b8b" stroke="#528b8b" stroke-width="0.5" points="155.59,-101.77 161.07,-101.76 157.87,-102.79 160.15,-103.82 160.15,-103.82 160.15,-103.82 157.87,-102.79 159.23,-105.87 155.59,-101.77 155.59,-101.77"></polygon>
</g>
<!-- hp3&#45;&gt;model2 -->
<g id="edge17" class="edge">
<title>hp3-&gt;model2</title>
<path fill="none" stroke="#528b8b" stroke-width="0.5" d="M365.87,-150.51C361.03,-148.25 355.88,-145.96 351,-144 304.04,-125.16 289.96,-126.84 243,-108 239.65,-106.66 236.16,-105.15 232.74,-103.61"></path>
<polygon fill="#528b8b" stroke="#528b8b" stroke-width="0.5" points="228.13,-101.49 233.62,-101.53 230.41,-102.54 232.68,-103.58 232.68,-103.58 232.68,-103.58 230.41,-102.54 231.74,-105.62 228.13,-101.49 228.13,-101.49"></polygon>
</g>
<!-- hp3&#45;&gt;model3 -->
<g id="edge18" class="edge">
<title>hp3-&gt;model3</title>
<path fill="none" stroke="#528b8b" stroke-width="0.5" d="M368.19,-148.81C349.76,-136.86 321.65,-118.64 301.92,-105.86"></path>
<polygon fill="#528b8b" stroke="#528b8b" stroke-width="0.5" points="297.6,-103.05 303.02,-103.88 299.69,-104.41 301.79,-105.77 301.79,-105.77 301.79,-105.77 299.69,-104.41 300.57,-107.66 297.6,-103.05 297.6,-103.05"></polygon>
</g>
<!-- performance -->
<g id="node10" class="node">
<title>performance</title>
<ellipse fill="none" stroke="#8b4500" stroke-width="0.5" cx="207" cy="-18" rx="77.42" ry="18"></ellipse>
<text text-anchor="middle" x="207" y="-15.3" font-family="Inconsolata, sans-serif" font-size="9.00">performance1 ... performance27</text>
</g>
<!-- model1&#45;&gt;performance -->
<g id="edge19" class="edge">
<title>model1-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M109.6,-83.27C95.77,-72.41 115.97,-48.53 148.1,-33.14"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="152.92,-30.93 149.31,-35.06 150.65,-31.97 148.38,-33.01 148.38,-33.01 148.38,-33.01 150.65,-31.97 147.44,-30.96 152.92,-30.93 152.92,-30.93"></polygon>
</g>
<!-- model1&#45;&gt;performance -->
<g id="edge22" class="edge">
<title>model1-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M115.91,-77.13C116.8,-65.57 133.81,-47.93 155.71,-35.11"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="160.15,-32.61 156.9,-37.02 157.97,-33.84 155.79,-35.06 155.79,-35.06 155.79,-35.06 157.97,-33.84 154.69,-33.1 160.15,-32.61 160.15,-32.61"></polygon>
</g>
<!-- model1&#45;&gt;performance -->
<g id="edge25" class="edge">
<title>model1-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M128.7,-72.41C135.05,-61.69 149.21,-47.76 164.82,-36.81"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="169.25,-33.8 166.37,-38.47 167.18,-35.21 165.11,-36.61 165.11,-36.61 165.11,-36.61 167.18,-35.21 163.85,-34.75 169.25,-33.8 169.25,-33.8"></polygon>
</g>
<!-- model1&#45;&gt;performance -->
<g id="edge28" class="edge">
<title>model1-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M140.67,-72.05C149.05,-61.79 162.41,-48.67 175.25,-38.04"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="179.21,-34.83 176.74,-39.73 177.27,-36.4 175.33,-37.98 175.33,-37.98 175.33,-37.98 177.27,-36.4 173.91,-36.23 179.21,-34.83 179.21,-34.83"></polygon>
</g>
<!-- model1&#45;&gt;performance -->
<g id="edge31" class="edge">
<title>model1-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M149.57,-74.83C160.05,-64.64 174.35,-50.74 186.06,-39.36"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="189.92,-35.61 187.9,-40.7 188.13,-37.35 186.33,-39.09 186.33,-39.09 186.33,-39.09 188.13,-37.35 184.77,-37.48 189.92,-35.61 189.92,-35.61"></polygon>
</g>
<!-- model1&#45;&gt;performance -->
<g id="edge34" class="edge">
<title>model1-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M155.95,-78.37C170.02,-68.18 186.95,-52.52 198.03,-39.84"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="201.28,-36.01 199.76,-41.28 199.66,-37.92 198.04,-39.82 198.04,-39.82 198.04,-39.82 199.66,-37.92 196.33,-38.37 201.28,-36.01 201.28,-36.01"></polygon>
</g>
<!-- model1&#45;&gt;performance -->
<g id="edge37" class="edge">
<title>model1-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M159.4,-81.9C178.79,-72.26 199.62,-54.61 210.05,-40.46"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="212.94,-36.19 212,-41.59 211.53,-38.26 210.13,-40.33 210.13,-40.33 210.13,-40.33 211.53,-38.26 208.27,-39.07 212.94,-36.19 212.94,-36.19"></polygon>
</g>
<!-- model1&#45;&gt;performance -->
<g id="edge40" class="edge">
<title>model1-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M160.75,-84.51C187.64,-75.76 213.56,-55.91 222.68,-40.33"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="224.95,-35.66 224.79,-41.14 223.86,-37.9 222.77,-40.15 222.77,-40.15 222.77,-40.15 223.86,-37.9 220.74,-39.17 224.95,-35.66 224.95,-35.66"></polygon>
</g>
<!-- model1&#45;&gt;performance -->
<g id="edge43" class="edge">
<title>model1-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M161.72,-85.99C197.58,-78.12 228.69,-56.36 235.46,-39.76"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="236.76,-34.8 237.67,-40.2 236.13,-37.22 235.49,-39.63 235.49,-39.63 235.49,-39.63 236.13,-37.22 233.32,-39.07 236.76,-34.8 236.76,-34.8"></polygon>
</g>
<!-- model2&#45;&gt;performance -->
<g id="edge20" class="edge">
<title>model2-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M180.9,-85.24C153.51,-76.28 146.29,-53.24 159.23,-36.86"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="162.95,-32.85 161.2,-38.04 161.25,-34.68 159.55,-36.51 159.55,-36.51 159.55,-36.51 161.25,-34.68 157.9,-34.98 162.95,-32.85 162.95,-32.85"></polygon>
</g>
<!-- model2&#45;&gt;performance -->
<g id="edge23" class="edge">
<title>model2-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M182.32,-82.54C166.69,-72.66 162.64,-53.4 170.17,-38.67"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="172.88,-34.25 172.18,-39.69 171.57,-36.38 170.27,-38.51 170.27,-38.51 170.27,-38.51 171.57,-36.38 168.35,-37.34 172.88,-34.25 172.88,-34.25"></polygon>
</g>
<!-- model2&#45;&gt;performance -->
<g id="edge26" class="edge">
<title>model2-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M186.75,-78.06C179.81,-67.95 178.22,-52.63 181.98,-40.13"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="183.76,-35.32 184.13,-40.79 182.89,-37.67 182.02,-40.01 182.02,-40.01 182.02,-40.01 182.89,-37.67 179.91,-39.23 183.76,-35.32 183.76,-35.32"></polygon>
</g>
<!-- model2&#45;&gt;performance -->
<g id="edge29" class="edge">
<title>model2-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M195.56,-73.46C193.3,-63.91 192.9,-51.52 194.37,-40.97"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="195.24,-35.96 196.6,-41.27 194.81,-38.42 194.38,-40.89 194.38,-40.89 194.38,-40.89 194.81,-38.42 192.17,-40.5 195.24,-35.96 195.24,-35.96"></polygon>
</g>
<!-- model2&#45;&gt;performance -->
<g id="edge32" class="edge">
<title>model2-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M207,-71.7C207,-62.46 207,-50.98 207,-41.11"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="207,-36.1 209.25,-41.1 207,-38.6 207,-41.1 207,-41.1 207,-41.1 207,-38.6 204.75,-41.1 207,-36.1 207,-36.1"></polygon>
</g>
<!-- model2&#45;&gt;performance -->
<g id="edge35" class="edge">
<title>model2-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M218.44,-73.46C220.7,-63.91 221.1,-51.52 219.63,-40.97"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="218.76,-35.96 221.83,-40.5 219.19,-38.42 219.62,-40.89 219.62,-40.89 219.62,-40.89 219.19,-38.42 217.4,-41.27 218.76,-35.96 218.76,-35.96"></polygon>
</g>
<!-- model2&#45;&gt;performance -->
<g id="edge38" class="edge">
<title>model2-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M227.25,-78.06C234.19,-67.95 235.78,-52.63 232.02,-40.13"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="230.24,-35.32 234.09,-39.23 231.11,-37.67 231.98,-40.01 231.98,-40.01 231.98,-40.01 231.11,-37.67 229.87,-40.79 230.24,-35.32 230.24,-35.32"></polygon>
</g>
<!-- model2&#45;&gt;performance -->
<g id="edge41" class="edge">
<title>model2-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M231.68,-82.54C247.31,-72.66 251.36,-53.4 243.83,-38.67"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="241.12,-34.25 245.65,-37.34 242.43,-36.38 243.73,-38.51 243.73,-38.51 243.73,-38.51 242.43,-36.38 241.82,-39.69 241.12,-34.25 241.12,-34.25"></polygon>
</g>
<!-- model2&#45;&gt;performance -->
<g id="edge44" class="edge">
<title>model2-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M233.1,-85.24C260.49,-76.28 267.71,-53.24 254.77,-36.86"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="251.05,-32.85 256.1,-34.98 252.75,-34.68 254.45,-36.51 254.45,-36.51 254.45,-36.51 252.75,-34.68 252.8,-38.04 251.05,-32.85 251.05,-32.85"></polygon>
</g>
<!-- model3&#45;&gt;performance -->
<g id="edge21" class="edge">
<title>model3-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M252.28,-85.99C216.42,-78.12 185.31,-56.36 178.54,-39.76"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="177.24,-34.8 180.68,-39.07 177.87,-37.22 178.51,-39.63 178.51,-39.63 178.51,-39.63 177.87,-37.22 176.33,-40.2 177.24,-34.8 177.24,-34.8"></polygon>
</g>
<!-- model3&#45;&gt;performance -->
<g id="edge24" class="edge">
<title>model3-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M253.25,-84.51C226.36,-75.76 200.44,-55.91 191.32,-40.33"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="189.05,-35.66 193.26,-39.17 190.14,-37.9 191.23,-40.15 191.23,-40.15 191.23,-40.15 190.14,-37.9 189.21,-41.14 189.05,-35.66 189.05,-35.66"></polygon>
</g>
<!-- model3&#45;&gt;performance -->
<g id="edge27" class="edge">
<title>model3-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M254.6,-81.9C235.21,-72.26 214.38,-54.61 203.95,-40.46"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="201.06,-36.19 205.73,-39.07 202.47,-38.26 203.87,-40.33 203.87,-40.33 203.87,-40.33 202.47,-38.26 202,-41.59 201.06,-36.19 201.06,-36.19"></polygon>
</g>
<!-- model3&#45;&gt;performance -->
<g id="edge30" class="edge">
<title>model3-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M258.05,-78.37C243.98,-68.18 227.05,-52.52 215.97,-39.84"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="212.72,-36.01 217.67,-38.37 214.34,-37.92 215.96,-39.82 215.96,-39.82 215.96,-39.82 214.34,-37.92 214.24,-41.28 212.72,-36.01 212.72,-36.01"></polygon>
</g>
<!-- model3&#45;&gt;performance -->
<g id="edge33" class="edge">
<title>model3-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M264.43,-74.83C253.95,-64.64 239.65,-50.74 227.94,-39.36"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="224.08,-35.61 229.23,-37.48 225.87,-37.35 227.67,-39.09 227.67,-39.09 227.67,-39.09 225.87,-37.35 226.1,-40.7 224.08,-35.61 224.08,-35.61"></polygon>
</g>
<!-- model3&#45;&gt;performance -->
<g id="edge36" class="edge">
<title>model3-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M273.33,-72.05C264.95,-61.79 251.59,-48.67 238.75,-38.04"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="234.79,-34.83 240.09,-36.23 236.73,-36.4 238.67,-37.98 238.67,-37.98 238.67,-37.98 236.73,-36.4 237.26,-39.73 234.79,-34.83 234.79,-34.83"></polygon>
</g>
<!-- model3&#45;&gt;performance -->
<g id="edge39" class="edge">
<title>model3-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M285.3,-72.41C278.95,-61.69 264.79,-47.76 249.18,-36.81"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="244.75,-33.8 250.15,-34.75 246.82,-35.21 248.89,-36.61 248.89,-36.61 248.89,-36.61 246.82,-35.21 247.63,-38.47 244.75,-33.8 244.75,-33.8"></polygon>
</g>
<!-- model3&#45;&gt;performance -->
<g id="edge42" class="edge">
<title>model3-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M298.09,-77.13C297.2,-65.57 280.19,-47.93 258.29,-35.11"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="253.85,-32.61 259.31,-33.1 256.03,-33.84 258.21,-35.06 258.21,-35.06 258.21,-35.06 256.03,-33.84 257.1,-37.02 253.85,-32.61 253.85,-32.61"></polygon>
</g>
<!-- model3&#45;&gt;performance -->
<g id="edge45" class="edge">
<title>model3-&gt;performance</title>
<path fill="none" stroke="#009acd" stroke-width="0.5" d="M304.4,-83.27C318.23,-72.41 298.03,-48.53 265.9,-33.14"></path>
<polygon fill="#009acd" stroke="#009acd" stroke-width="0.5" points="261.08,-30.93 266.56,-30.96 263.35,-31.97 265.62,-33.01 265.62,-33.01 265.62,-33.01 263.35,-31.97 264.69,-35.06 261.08,-30.93 261.08,-30.93"></polygon>
</g>
</g>
</svg>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>How did we get <code>performance19</code> again? 🤯</p>
</section>
<section id="experiment-tracking-tools" class="level3">
<h3 class="anchored" data-anchor-id="experiment-tracking-tools">Experiment tracking tools</h3>
<p>The solution to this complexity is to use an experiment tracking tool such as <a href="https://mlflow.org/">MLflow</a> and, optionally, a data versioning tool such as <a href="https://dvc.org/">DVC</a>.</p>
<div class="note">
<p>See <a href="wb_dvc">our webinar on DVC</a>.</p>
</div>
</section>
</section>
<section id="mlflow-overview" class="level2">
<h2 class="anchored" data-anchor-id="mlflow-overview">MLflow overview</h2>
<section id="platform-for-ai-life-cycle" class="level3">
<h3 class="anchored" data-anchor-id="platform-for-ai-life-cycle">Platform for AI life cycle</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/mlflow_model_dev.png" class="img-fluid figure-img" style="width:80.0%" alt="noshadow"></p>
<figcaption>from <a href="https://mlflow.org/docs/latest/ml/">MLflow website</a></figcaption>
</figure>
</div>
</section>
<section id="use-cases" class="level3">
<h3 class="anchored" data-anchor-id="use-cases">Use cases</h3>
<ul>
<li>Compare algorithms</li>
<li>Keep track of pipelines</li>
<li>Generate SHAP plots (relative contributions of features to the prediction)</li>
<li>Track models at checkpoints</li>
<li>Compare models with different datasets</li>
<li>Track hyperparameter tuning experiments</li>
<li>Visualize plots of logged metrics in UI</li>
<li>Keep models and model versions in a registry</li>
</ul>
</section>
<section id="foss-compatible" class="level3">
<h3 class="anchored" data-anchor-id="foss-compatible">FOSS &amp; compatible</h3>
<ul>
<li><strong>Open-source</strong></li>
<li>Works with <strong>any ML or DL framework</strong></li>
<li><strong>Vendor-neutral</strong> if you run a server on a commercial platform</li>
<li><strong>Can be combined with <a href="https://dvc.org/">dvc</a> for <a href="https://dev.to/aws-builders/ml-done-right-versioning-datasets-and-models-with-dvc-mlflow-4p3f">dataset versioning</a></strong></li>
<li>Works with any hyperparameter tuning framework &nbsp;➔ &nbsp;e.g.&nbsp;<a href="https://mlflow.org/docs/latest/ml/traditional-ml/tutorials/hyperparameter-tuning/notebooks/hyperparameter-tuning-with-child-runs/">integration</a> with <a href="https://github.com/optuna/optuna">Optuna</a><br>
 &nbsp;                        &nbsp;<a href="https://docs.ray.io/en/latest/tune/examples/tune-mlflow.html">integration</a> with <a href="https://github.com/ray-project/ray">Ray Tune</a><br>
 &nbsp;                        &nbsp;<a href="https://mlflow.org/docs/3.1.3/ml/getting-started/hyperparameter-tuning/">integration</a> with <a href="https://github.com/hyperopt/hyperopt">hyperopt</a></li>
</ul>
</section>
<section id="used-by-proprietary-tools" class="level3">
<h3 class="anchored" data-anchor-id="used-by-proprietary-tools">Used by proprietary tools</h3>
<p>The foundation of many proprietary no-code/low-code tuning platforms that just add a layer on top to interface with the user with text rather than code.</p>
<div class="note">
<p>e.g.&nbsp;Microsoft Fabric, FLAML</p>
</div>
</section>
<section id="limitations" class="level3">
<h3 class="anchored" data-anchor-id="limitations">Limitations</h3>
<ul>
<li>Messy documentation (code typos, circular, confusing, many “Getting started” sections)</li>
<li><code>uv</code> not fully integrated (not supported in MLflow projects)</li>
<li>The UI can be unstable and inconsistent</li>
<li>Servers are not very resilient to by bad workflows, deletion and recreation of files, etc.</li>
<li>Nested runs don’t get logged as children runs if the workflow is not followed carefully</li>
</ul>
</section>
</section>
<section id="tracking-with-mlflow" class="level2">
<h2 class="anchored" data-anchor-id="tracking-with-mlflow">Tracking with MLflow</h2>
<section id="install-mlflow" class="level3">
<h3 class="anchored" data-anchor-id="install-mlflow">Install MLflow</h3>
<p><em>(With <a href="https://docs.astral.sh/uv/">uv</a>)</em></p>
<p>Create a <code>uv</code> project:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">uv</span> init <span class="at">--bare</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Install MLflow:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">uv</span> add mlflow</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="emph">
<p><code>uv</code> is an amazing Python projects/versions/virtual envs manager and I recommend using it on your machine. <strong>However, it is currently not supported on the Alliance clusters where you need to keep using <code>pip</code> or risk issues with undetected modules</strong>.</p>
</div>
<p>While installing MLflow with <code>uv</code> works without issues, MLflow models artifacts contain a conda.yaml file which expects <code>pip</code>.</p>
<p>To prevent getting the annoying warning:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>WARNING mlflow.utils.environment: Failed to resolve installed pip version.</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>``pip`` will be added to conda.yaml environment spec without a version specifier.</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>each time you log a model, you can install <code>pip</code> even if you never use it (or you can just ignore the warnings):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">uv</span> add pip</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="definitions-in-mlflow-context" class="level3">
<h3 class="anchored" data-anchor-id="definitions-in-mlflow-context">Definitions in MLflow context</h3>
<p><strong>Parent run</strong>:<br>
One experiment (e.g.&nbsp;optimization task) containing multiple children (nested) runs.</p>
<p><strong>Child run</strong>:<br>
Individual execution of a model training event.</p>
<p><strong>Model signature</strong>:<br>
Description of a model input and output data structure, data types, and features names.</p>
<p><strong>Model artifacts</strong>:<br>
Outputs of model training process: trained model, checkpoints, and associated metadata.</p>
<p><strong>Model Uniform Resource Identifier (URI)</strong>:<br>
Unique sequence of characters that identifies a model artifacts.</p>
</section>
<section id="mlflow-tracking-workflow" class="level3">
<h3 class="anchored" data-anchor-id="mlflow-tracking-workflow">MLflow tracking workflow</h3>
<ul>
<li>Create an experiment</li>
<li>Launch an MLflow server</li>
<li>Open the user interface in a browser to visualize the logged data</li>
<li>Log tracking data (e.g.&nbsp;train or tune a model)</li>
</ul>
</section>
<section id="mlflow-tracking-setup" class="level3">
<h3 class="anchored" data-anchor-id="mlflow-tracking-setup">MLflow tracking setup</h3>
<p>You can setup MLflow tracking locally or on a remote server, using databases or not<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p>In the next slides, I am breaking down the workflow for the various configurations.</p>
<section id="create-an-experiment" class="level4">
<h4 class="anchored" data-anchor-id="create-an-experiment">Create an experiment</h4>
<div class="quarto-layout-panel" data-layout="[30, 70]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 30.0%;justify-content: center;">
<p><img src="img/mlflow_tracking_setup1.png" class="img-fluid" alt="noshadow"></p>
</div>
<section id="local" class="level5 col2 quarto-layout-cell" style="flex-basis: 70.0%;justify-content: flex-start;">
<h5 class="anchored" data-anchor-id="local">Local</h5>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> mlflow</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>mlflow.set_experiment(<span class="st">"&lt;experiment-name&gt;"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Logs get stored in an <code>mlruns</code> directory.</p>
<div class="note">
<p>This method will be deprecated, so prefer the use of a database.</p>
</div>
</section>
</div>
</div>
<div class="quarto-layout-panel" data-layout="[30, 70]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 30.0%;justify-content: center;">
<p><img src="img/mlflow_tracking_setup2.png" class="img-fluid" alt="noshadow"></p>
</div>
<section id="local-with-database" class="level5 col2 quarto-layout-cell" style="flex-basis: 70.0%;justify-content: flex-start;">
<h5 class="anchored" data-anchor-id="local-with-database">Local with database</h5>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> mlflow</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>mlflow.set_tracking_uri(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sqlite:///&lt;database-name&gt;.db"</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>mlflow.set_experiment(<span class="st">"&lt;experiment-name&gt;"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Logs get stored in a <code>&lt;database-name&gt;.db</code> file.</p>
<div class="note">
<p>Here we use SQLite which works well for a local database.</p>
</div>
</section>
</div>
</div>
<div class="quarto-layout-panel" data-layout="[30, 70]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 30.0%;justify-content: center;">
<p><img src="img/mlflow_tracking_setup3.png" class="img-fluid" alt="noshadow"></p>
</div>
<section id="remote-tracking-server" class="level5 col2 quarto-layout-cell" style="flex-basis: 70.0%;justify-content: flex-start;">
<h5 class="anchored" data-anchor-id="remote-tracking-server">Remote tracking server</h5>
<div class="note">
<p>(For team development)</p>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> mlflow</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>mlflow.set_tracking_uri(<span class="st">"http://&lt;host&gt;:&lt;port&gt;"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>mlflow.set_experiment(<span class="st">"&lt;experiment-name&gt;"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</div>
</div>
</section>
<section id="launch-mlflow-server" class="level4">
<h4 class="anchored" data-anchor-id="launch-mlflow-server">Launch MLflow server</h4>
<div class="quarto-layout-panel" data-layout="[30, 70]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 30.0%;justify-content: center;">
<p><img src="img/mlflow_tracking_setup1.png" class="img-fluid" alt="noshadow"></p>
</div>
<section id="local-1" class="level5 col2 quarto-layout-cell" style="flex-basis: 70.0%;justify-content: flex-start;">
<h5 class="anchored" data-anchor-id="local-1">Local</h5>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">mlflow</span> server</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>The server listens on <a href="http://localhost:5000" class="uri">http://localhost:5000</a> by default.</p>
<div class="notenoit">
<p>To listen to another port (e.g.&nbsp;<code>8080</code>):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">mlflow</span> server <span class="at">--port</span> 8080</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</div>
</div>
<div class="quarto-layout-panel" data-layout="[30, 70]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 30.0%;justify-content: center;">
<p><img src="img/mlflow_tracking_setup2.png" class="img-fluid" alt="noshadow"></p>
</div>
<section id="local-with-database-1" class="level5 col2 quarto-layout-cell" style="flex-basis: 70.0%;justify-content: flex-start;">
<h5 class="anchored" data-anchor-id="local-with-database-1">Local with database</h5>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">mlflow</span> server <span class="dt">\</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">--backend-store-uri</span> <span class="dt">\</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>       sqlite:///<span class="op">&lt;</span>database-name<span class="op">&gt;</span>.db</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="notenoit">
<p>Default port is <code>5000</code>. To use another port (e.g.&nbsp;<code>8080</code>):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">mlflow</span> server <span class="dt">\</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">--backend-store-uri</span> <span class="dt">\</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>       sqlite:///<span class="op">&lt;</span>database-name<span class="op">&gt;</span>.db <span class="dt">\</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">--port</span> 8080</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</div>
</div>
<div class="quarto-layout-panel" data-layout="[30, 70]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 30.0%;justify-content: center;">
<p><img src="img/mlflow_tracking_setup3.png" class="img-fluid" alt="noshadow"></p>
</div>
<section id="remote-tracking-server-1" class="level5 col2 quarto-layout-cell" style="flex-basis: 70.0%;justify-content: flex-start;">
<h5 class="anchored" data-anchor-id="remote-tracking-server-1">Remote tracking server</h5>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">mlflow</span> server <span class="dt">\</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">--host</span> <span class="op">&lt;</span>host<span class="op">&gt;</span> <span class="dt">\</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">--backend-store-uri</span> <span class="dt">\</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>       postgresql+psycopg2://<span class="op">&lt;</span>username<span class="op">&gt;</span>:<span class="op">&lt;</span>password<span class="op">&gt;</span>@<span class="op">&lt;</span>host<span class="op">&gt;</span>:<span class="op">&lt;</span>port<span class="op">&gt;</span>/mlflowdb <span class="dt">\</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">--port</span> <span class="op">&lt;</span>port<span class="op">&gt;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="note">
<p>Here we use PostgreSQL which works well to manage a database in a collaborative remote client-server system.</p>
<p>(Requires installing the <code>psycopg2</code> package.)</p>
</div>
</section>
</div>
</div>
<section id="alliance-clusters" class="level5">
<h5 class="anchored" data-anchor-id="alliance-clusters">Alliance clusters</h5>
<ul>
<li>Launch the MLflow server in the background (with a trailing <code>&amp;</code>) as part of your job.</li>
<li>Use the <a href="#section-4">local workflow</a> with the additional argument <code>--host 0.0.0.0</code>.</li>
</ul>
<div class="example">
<p>Example job:</p>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#SBATCH ...</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SBATCH ...</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="ex">mlflow</span> server <span class="dt">\</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">--backend-store-uri</span> sqlite:///<span class="op">&lt;</span>database-name<span class="op">&gt;</span>.db <span class="at">--host</span> 0.0.0.0 <span class="kw">&amp;</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> <span class="op">&lt;</span>script<span class="op">&gt;</span>.py</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="access-the-ui" class="level4">
<h4 class="anchored" data-anchor-id="access-the-ui">Access the UI</h4>
<p>Open <code>http://&lt;host&gt;:&lt;port&gt;</code> in a browser to view logs in the UI.</p>
<div class="example">
<p>Example: for a local server on port <code>5000</code> (the default), open <a href="http://localhost:5000" class="uri">http://localhost:5000</a>.</p>
</div>
<section id="alliance-clusters-1" class="level5">
<h5 class="anchored" data-anchor-id="alliance-clusters-1">Alliance clusters</h5>
<p>Once the job is running, you need to create a connection between the compute node running the server and your computer.</p>
<p>First, you need to find the hostname of the compute node running the server. This is the value under <code>NODELIST</code> for your job when you run <code>sq</code>.</p>
<p>Then, <strong><em>from your computer</em></strong>, run the SSH tunnelling command:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ssh</span> <span class="at">-N</span> <span class="at">-f</span> <span class="at">-L</span> localhost:5000:<span class="op">&lt;</span>node<span class="op">&gt;</span>:5000 <span class="op">&lt;</span>user<span class="op">&gt;</span>@<span class="op">&lt;</span>cluster<span class="op">&gt;</span>.alliancecan.ca</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="note">
<p>Replace <code>&lt;node&gt;</code> by the compute node you identified, <code>&lt;user&gt;</code> by your user name, and <code>&lt;cluster&gt;</code> by the name of the Alliance cluster (e.g.&nbsp;<code>fir</code>).</p>
</div>
<p>Finally, open a browser (on your computer) and go to <a href="http://localhost:5000" class="uri">http://localhost:5000</a>.</p>
</section>
</section>
<section id="log-tracking-data" class="level4">
<h4 class="anchored" data-anchor-id="log-tracking-data">Log tracking data</h4>
<p>Define and run the experiment you want to track.</p>
<div class="notenoit">
<p>Examples:</p>
<p>Train a model,<br>
Tune hyperparameters,<br>
Run a model with different datasets,<br>
…</p>
</div>
</section>
</section>
</section>
<section id="use-case-1-model-tracking" class="level2">
<h2 class="anchored" data-anchor-id="use-case-1-model-tracking">Use case 1: model tracking</h2>
<section id="benefits-of-using-mlflow" class="level3">
<h3 class="anchored" data-anchor-id="benefits-of-using-mlflow">Benefits of using MLflow</h3>
<ul>
<li>Monitor model metrics (e.g.&nbsp;loss, accuracy)</li>
<li>Monitor system metrics (e.g.&nbsp;GPU, memory)</li>
<li>Save checkpoints with metrics</li>
<li>Record hyperparameters and optimizer settings</li>
<li>Snapshot library versions for reproducibility</li>
</ul>
</section>
<section id="workflow" class="level3">
<h3 class="anchored" data-anchor-id="workflow">Workflow</h3>
<ul>
<li>Create an experiment</li>
<li>Launch an MLflow server</li>
<li>Open the user interface in a browser to visualize the logged data</li>
<li>Log tracking data:
<ul>
<li>Prepare data</li>
<li>Define model</li>
<li>Define training parameters and optimizer</li>
<li>Train</li>
</ul></li>
</ul>
</section>
<section id="model-demo" class="level3">
<h3 class="anchored" data-anchor-id="model-demo">Model demo</h3>
<div class="figure-caption">
<p>modified from <a href="https://mlflow.org/docs/latest/ml/getting-started/deep-learning/">MLflow website</a></p>
</div>
<p>We need several packages for this demo. I create a bare <code>uv</code> project:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="ex">uv</span> init <span class="at">--bare</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>and install the packages in its virtual environment:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">uv</span> add mlflow psutil torch torchvision</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>I also install <a href="https://github.com/prompt-toolkit/ptpython">ptpython</a> because I like to use it instead of the default Python shell, but this is not necessary to run the demo (which is why I am adding it in the dev group):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">uv</span> add <span class="at">--dev</span> ptpython</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>I can now launch <code>ptpython</code> (or <code>python</code>) to run the code:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">uv</span> run ptpython</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<section id="create-an-experiment-1" class="level4">
<h4 class="anchored" data-anchor-id="create-an-experiment-1">Create an experiment</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> mlflow</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>mlflow.set_tracking_uri(<span class="st">"sqlite:///demos.db"</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>mlflow.set_experiment(<span class="st">"model_tracking_demo"</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>mlflow.config.enable_system_metrics_logging()</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>mlflow.config.set_system_metrics_sampling_interval(<span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="note">
<p>You can see that the database file <code>demos.db</code> gets created.</p>
</div>
</section>
<section id="launch-mlflow-server-1" class="level4">
<h4 class="anchored" data-anchor-id="launch-mlflow-server-1">Launch MLflow server</h4>
<p><em>In Bash (not Python):</em></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="ex">uv</span> run mlflow server <span class="at">--backend-store-uri</span> sqlite:///demos.db</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="access-the-ui-1" class="level4">
<h4 class="anchored" data-anchor-id="access-the-ui-1">Access the UI</h4>
<p>Open <a href="http://localhost:5000" class="uri">http://localhost:5000</a> in a browser to view logs in the UI.</p>
<p>You can see our <span class="codelike">model_tracking_demo</span> experiment.</p>
<p>Click on it to see the interface where the runs will be logged as we train our model.</p>
</section>
<section id="log-tracking-data-1" class="level4">
<h4 class="anchored" data-anchor-id="log-tracking-data-1">Log tracking data</h4>
<p>In this demo, we log a checkpoint and its metrics after each epoch, as well as the final model for the training of a basic PyTorch classification neural network on the classic <a href="https://en.wikipedia.org/wiki/Fashion-MNIST">Fashion-MNIST dataset</a>.</p>
<section id="prepare-data" class="level5">
<h5 class="anchored" data-anchor-id="prepare-data">Prepare data</h5>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch.utils.data <span class="im">import</span> DataLoader</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torchvision <span class="im">import</span> datasets, transforms</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define device</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>device <span class="op">=</span> torch.device(<span class="st">"cuda"</span> <span class="cf">if</span> torch.cuda.is_available() <span class="cf">else</span> <span class="st">"cpu"</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Load and prepare data</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>transform <span class="op">=</span> transforms.Compose(</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    [transforms.ToTensor(), transforms.Normalize((<span class="fl">0.1307</span>,), (<span class="fl">0.3081</span>,))]</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>train_dataset <span class="op">=</span> datasets.FashionMNIST(</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data"</span>, train<span class="op">=</span><span class="va">True</span>, download<span class="op">=</span><span class="va">True</span>, transform<span class="op">=</span>transform</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>test_dataset <span class="op">=</span> datasets.FashionMNIST(<span class="st">"data"</span>, train<span class="op">=</span><span class="va">False</span>, transform<span class="op">=</span>transform)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>train_loader <span class="op">=</span> DataLoader(train_dataset, batch_size<span class="op">=</span><span class="dv">64</span>, shuffle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>test_loader <span class="op">=</span> DataLoader(test_dataset, batch_size<span class="op">=</span><span class="dv">1000</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="define-model" class="level5">
<h5 class="anchored" data-anchor-id="define-model">Define model</h5>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.nn <span class="im">as</span> nn</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> NeuralNetwork(nn.Module):</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.flatten <span class="op">=</span> nn.Flatten()</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.linear_relu_stack <span class="op">=</span> nn.Sequential(</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>            nn.Linear(<span class="dv">28</span> <span class="op">*</span> <span class="dv">28</span>, <span class="dv">512</span>),</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>            nn.ReLU(),</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>            nn.Linear(<span class="dv">512</span>, <span class="dv">512</span>),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>            nn.ReLU(),</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>            nn.Linear(<span class="dv">512</span>, <span class="dv">10</span>),</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.flatten(x)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>        logits <span class="op">=</span> <span class="va">self</span>.linear_relu_stack(x)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> logits</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> NeuralNetwork().to(device)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="set-training-conditions" class="level5">
<h5 class="anchored" data-anchor-id="set-training-conditions">Set training conditions</h5>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.optim <span class="im">as</span> optim</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Training parameters</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"epochs"</span>: <span class="dv">4</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"learning_rate"</span>: <span class="fl">1e-3</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"batch_size"</span>: <span class="dv">64</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"optimizer"</span>: <span class="st">"SGD"</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"model_type"</span>: <span class="st">"MLP"</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hidden_units"</span>: [<span class="dv">512</span>, <span class="dv">512</span>],</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Define optimizer and loss function</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>loss_fn <span class="op">=</span> nn.CrossEntropyLoss()</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>optimizer <span class="op">=</span> optim.SGD(model.parameters(), lr<span class="op">=</span>params[<span class="st">"learning_rate"</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="train" class="level5">
<h5 class="anchored" data-anchor-id="train">Train</h5>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> mlflow.start_run(run_name<span class="op">=</span><span class="st">"run_1"</span>) <span class="im">as</span> run:</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Log training parameters</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    mlflow.log_params(params)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(params[<span class="st">"epochs"</span>]):</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>        model.train()</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>        train_loss, correct, total <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> batch_idx, (data, target) <span class="kw">in</span> <span class="bu">enumerate</span>(train_loader):</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>            data, target <span class="op">=</span> data.to(device), target.to(device)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Forward pass</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>            optimizer.zero_grad()</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> model(data)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> loss_fn(output, target)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Backward pass</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>            loss.backward()</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>            optimizer.step()</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate metrics</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>            train_loss <span class="op">+=</span> loss.item()</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>            _, predicted <span class="op">=</span> output.<span class="bu">max</span>(<span class="dv">1</span>)</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>            total <span class="op">+=</span> target.size(<span class="dv">0</span>)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>            correct <span class="op">+=</span> predicted.eq(target).<span class="bu">sum</span>().item()</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Log batch metrics (every 100 batches)</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> batch_idx <span class="op">%</span> <span class="dv">100</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>                batch_loss <span class="op">=</span> train_loss <span class="op">/</span> (batch_idx <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>                batch_acc <span class="op">=</span> <span class="fl">100.0</span> <span class="op">*</span> correct <span class="op">/</span> total</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>                mlflow.log_metrics(</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">"batch_loss"</span>: batch_loss, <span class="st">"batch_accuracy"</span>: batch_acc},</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>                    step<span class="op">=</span>epoch <span class="op">*</span> <span class="bu">len</span>(train_loader) <span class="op">+</span> batch_idx,</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Calculate epoch metrics</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>        epoch_loss <span class="op">=</span> train_loss <span class="op">/</span> <span class="bu">len</span>(train_loader)</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>        epoch_acc <span class="op">=</span> <span class="fl">100.0</span> <span class="op">*</span> correct <span class="op">/</span> total</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Validation</span></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>        model.<span class="bu">eval</span>()</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>        val_loss, val_correct, val_total <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> torch.no_grad():</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> data, target <span class="kw">in</span> test_loader:</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>                data, target <span class="op">=</span> data.to(device), target.to(device)</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>                output <span class="op">=</span> model(data)</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>                loss <span class="op">=</span> loss_fn(output, target)</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>                val_loss <span class="op">+=</span> loss.item()</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>                _, predicted <span class="op">=</span> output.<span class="bu">max</span>(<span class="dv">1</span>)</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>                val_total <span class="op">+=</span> target.size(<span class="dv">0</span>)</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>                val_correct <span class="op">+=</span> predicted.eq(target).<span class="bu">sum</span>().item()</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate and log epoch validation metrics</span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>        val_loss <span class="op">=</span> val_loss <span class="op">/</span> <span class="bu">len</span>(test_loader)</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>        val_acc <span class="op">=</span> <span class="fl">100.0</span> <span class="op">*</span> val_correct <span class="op">/</span> val_total</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Log epoch metrics</span></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>        mlflow.log_metrics(</span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>                <span class="st">"train_loss"</span>: epoch_loss,</span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>                <span class="st">"train_accuracy"</span>: epoch_acc,</span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>                <span class="st">"val_loss"</span>: val_loss,</span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>                <span class="st">"val_accuracy"</span>: val_acc,</span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>            step<span class="op">=</span>epoch,</span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Log checkpoint at the end of each epoch</span></span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a>        mlflow.pytorch.log_model(</span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a>            model,</span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a>            name<span class="op">=</span><span class="ss">f"fashionmnist_1_checkpoint_</span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(</span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"Epoch </span><span class="sc">{</span>epoch<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>params[<span class="st">'epochs'</span>]<span class="sc">}</span><span class="ss">, "</span></span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"Train Loss: </span><span class="sc">{</span>epoch_loss<span class="sc">:.4f}</span><span class="ss">, Train Acc: </span><span class="sc">{</span>epoch_acc<span class="sc">:.2f}</span><span class="ss">%, "</span></span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"Val Loss: </span><span class="sc">{</span>val_loss<span class="sc">:.4f}</span><span class="ss">, Val Acc: </span><span class="sc">{</span>val_acc<span class="sc">:.2f}</span><span class="ss">%"</span></span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Log the final trained model</span></span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a>    model_info <span class="op">=</span> mlflow.pytorch.log_model(</span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a>        model,</span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span><span class="st">"fashionmnist_1_trained"</span></span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="visualize-metrics" class="level4">
<h4 class="anchored" data-anchor-id="visualize-metrics">Visualize metrics</h4>
<p>Go to the UI in the browser. If you haven’t done so yet, click on the experiment we called <span class="codelike">model_tracking_demo</span>.</p>
<p>Then click on the run we called <span class="codelike">run_1</span> (if you don’t name runs, they get automatically generated names).</p>
<p>Finally go to the <span class="codelike">Model metrics</span> tab to see the metrics logged in real time.</p>
<p>The <span class="codelike">System metrics</span> tab allows you to monitor your resource usage.</p>
<p>Alternatively, you can click on the experiment and click on <img src="img/mlflow_chartview.png" class="img-fluid" width="50"> (<span class="codelike">Chart view</span> button).</p>
<p>This is a great method if you want to compare multiple runs.</p>
</section>
<section id="create-a-new-run" class="level4">
<h4 class="anchored" data-anchor-id="create-a-new-run">Create a new run</h4>
<p>We can create new runs by training the model again:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> mlflow.start_run(run_name<span class="op">=</span><span class="st">"run_2"</span>) <span class="im">as</span> run:</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Log training parameters</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    mlflow.log_params(params)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(params[<span class="st">"epochs"</span>]):</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>        model.train()</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>        train_loss, correct, total <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> batch_idx, (data, target) <span class="kw">in</span> <span class="bu">enumerate</span>(train_loader):</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>            data, target <span class="op">=</span> data.to(device), target.to(device)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Forward pass</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>            optimizer.zero_grad()</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> model(data)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> loss_fn(output, target)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Backward pass</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>            loss.backward()</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>            optimizer.step()</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate metrics</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>            train_loss <span class="op">+=</span> loss.item()</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>            _, predicted <span class="op">=</span> output.<span class="bu">max</span>(<span class="dv">1</span>)</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>            total <span class="op">+=</span> target.size(<span class="dv">0</span>)</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>            correct <span class="op">+=</span> predicted.eq(target).<span class="bu">sum</span>().item()</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Log batch metrics (every 100 batches)</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> batch_idx <span class="op">%</span> <span class="dv">100</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>                batch_loss <span class="op">=</span> train_loss <span class="op">/</span> (batch_idx <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>                batch_acc <span class="op">=</span> <span class="fl">100.0</span> <span class="op">*</span> correct <span class="op">/</span> total</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>                mlflow.log_metrics(</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>                    {<span class="st">"batch_loss"</span>: batch_loss, <span class="st">"batch_accuracy"</span>: batch_acc},</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>                    step<span class="op">=</span>epoch <span class="op">*</span> <span class="bu">len</span>(train_loader) <span class="op">+</span> batch_idx,</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Calculate epoch metrics</span></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>        epoch_loss <span class="op">=</span> train_loss <span class="op">/</span> <span class="bu">len</span>(train_loader)</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>        epoch_acc <span class="op">=</span> <span class="fl">100.0</span> <span class="op">*</span> correct <span class="op">/</span> total</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Validation</span></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>        model.<span class="bu">eval</span>()</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>        val_loss, val_correct, val_total <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> torch.no_grad():</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> data, target <span class="kw">in</span> test_loader:</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>                data, target <span class="op">=</span> data.to(device), target.to(device)</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>                output <span class="op">=</span> model(data)</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>                loss <span class="op">=</span> loss_fn(output, target)</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>                val_loss <span class="op">+=</span> loss.item()</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>                _, predicted <span class="op">=</span> output.<span class="bu">max</span>(<span class="dv">1</span>)</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>                val_total <span class="op">+=</span> target.size(<span class="dv">0</span>)</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>                val_correct <span class="op">+=</span> predicted.eq(target).<span class="bu">sum</span>().item()</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate and log epoch validation metrics</span></span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>        val_loss <span class="op">=</span> val_loss <span class="op">/</span> <span class="bu">len</span>(test_loader)</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>        val_acc <span class="op">=</span> <span class="fl">100.0</span> <span class="op">*</span> val_correct <span class="op">/</span> val_total</span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Log epoch metrics</span></span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>        mlflow.log_metrics(</span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>                <span class="st">"train_loss"</span>: epoch_loss,</span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>                <span class="st">"train_accuracy"</span>: epoch_acc,</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>                <span class="st">"val_loss"</span>: val_loss,</span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>                <span class="st">"val_accuracy"</span>: val_acc,</span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>            step<span class="op">=</span>epoch,</span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Log checkpoint at the end of each epoch</span></span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a>        mlflow.pytorch.log_model(</span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a>            model,</span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a>            name<span class="op">=</span><span class="ss">f"fashionmnist_2_checkpoint_</span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(</span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"Epoch </span><span class="sc">{</span>epoch<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>params[<span class="st">'epochs'</span>]<span class="sc">}</span><span class="ss">, "</span></span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"Train Loss: </span><span class="sc">{</span>epoch_loss<span class="sc">:.4f}</span><span class="ss">, Train Acc: </span><span class="sc">{</span>epoch_acc<span class="sc">:.2f}</span><span class="ss">%, "</span></span>
<span id="cb25-73"><a href="#cb25-73" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"Val Loss: </span><span class="sc">{</span>val_loss<span class="sc">:.4f}</span><span class="ss">, Val Acc: </span><span class="sc">{</span>val_acc<span class="sc">:.2f}</span><span class="ss">%"</span></span>
<span id="cb25-74"><a href="#cb25-74" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Log the final trained model</span></span>
<span id="cb25-75"><a href="#cb25-75" aria-hidden="true" tabindex="-1"></a>    model_info <span class="op">=</span> mlflow.pytorch.log_model(</span>
<span id="cb25-76"><a href="#cb25-76" aria-hidden="true" tabindex="-1"></a>        model,</span>
<span id="cb25-77"><a href="#cb25-77" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span><span class="st">"fashionmnist_2_trained"</span></span>
<span id="cb25-78"><a href="#cb25-78" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
</section>
<section id="use-case-2-tuning" class="level2">
<h2 class="anchored" data-anchor-id="use-case-2-tuning">Use case 2: tuning</h2>
<section id="hyperparameter-tuning" class="level3">
<h3 class="anchored" data-anchor-id="hyperparameter-tuning">Hyperparameter tuning</h3>
<p>The goal of hyperparameter tuning is to find the optimal set of hyperparameters that maximize a model’s predictive accuracy and performance.</p>
<p>➔ Find the right balance between high bias (underfitting) and high variance (overfitting) to improve the model’s ability to generalize and perform well on new, unseen data.</p>
</section>
<section id="tuning-frameworks" class="level3">
<h3 class="anchored" data-anchor-id="tuning-frameworks">Tuning frameworks</h3>
<p>Hyperparameters optimization used to be done manually following a systematic grid pattern. This was extremely inefficient.</p>
<p>Nowadays, there are many frameworks that do it automatically, faster, and better.</p>
<div class="example">
<p>Example:</p>
</div>
<ul>
<li><a href="https://optuna.org/">Optuna</a></li>
<li><a href="http://hyperopt.github.io/hyperopt/">Hyperopt</a></li>
<li><a href="https://docs.ray.io/en/latest/tune/index.html">Ray Tune</a></li>
</ul>
</section>
<section id="workflow-1" class="level3">
<h3 class="anchored" data-anchor-id="workflow-1">Workflow</h3>
<ul>
<li>Create an experiment</li>
<li>Launch an MLflow server</li>
<li>Open the user interface in a browser to visualize the logged data</li>
<li>Log tracking data:
<ul>
<li>Prepare data</li>
<li>Define an objective function</li>
<li>Run an optimization task</li>
</ul></li>
</ul>
</section>
<section id="tuning-demo" class="level3">
<h3 class="anchored" data-anchor-id="tuning-demo">Tuning demo</h3>
<div class="figure-caption">
<p>modified from <a href="https://mlflow.org/docs/latest/ml/getting-started/hyperparameter-tuning/">MLflow website</a></p>
</div>
<p>For this demo, we will use <a href="https://github.com/optuna/optuna">optuna</a> as the hyperparameter optimization framework, so we need to install it (in Bash, not Python):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="ex">uv</span> add optuna</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<section id="create-an-experiment-2" class="level4">
<h4 class="anchored" data-anchor-id="create-an-experiment-2">Create an experiment</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> mlflow</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>mlflow.set_tracking_uri(<span class="st">"sqlite:///demos.db"</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>mlflow.set_experiment(<span class="st">"tuning_demo"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="note">
<p>We are using the same database, but you could of course create a new one.</p>
</div>
</section>
<section id="launch-mlflow-server-2" class="level4">
<h4 class="anchored" data-anchor-id="launch-mlflow-server-2">Launch MLflow server</h4>
<p><em>In Bash/zsh (not in Python!) at root of project.</em></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb28"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="ex">mlflow</span> server <span class="at">--backend-store-uri</span> sqlite:///demos.db</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="note">
<p>If you are using the same database as in the previous demo and you kept the server running, you don’t have to do anything.</p>
</div>
</section>
<section id="access-the-ui-2" class="level4">
<h4 class="anchored" data-anchor-id="access-the-ui-2">Access the UI</h4>
<p>Open <a href="http://localhost:5000" class="uri">http://localhost:5000</a> in a browser.</p>
<p>Select the experiment <span class="codelike">tuning_demo</span>.</p>
</section>
<section id="log-tracking-data-2" class="level4">
<h4 class="anchored" data-anchor-id="log-tracking-data-2">Log tracking data</h4>
<p>In this demo, we train a <a href="https://en.wikipedia.org/wiki/Random_forest">random forest</a> regressor model on the classic <a href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.fetch_california_housing.html">scikit-learn California housing dataset</a> and tune its hyperparameters (random forest max depth, number of estimators, and max features) by minimizing the mean squared error between the predicted and validation values using the hyperparameter optimization package <a href="https://github.com/optuna/optuna">optuna</a>.</p>
<section id="prepare-data-1" class="level5">
<h5 class="anchored" data-anchor-id="prepare-data-1">Prepare data</h5>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> fetch_california_housing</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>X, y <span class="op">=</span> fetch_california_housing(return_X_y<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>X_train, X_val, y_train, y_val <span class="op">=</span> train_test_split(X, y, random_state<span class="op">=</span><span class="dv">0</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="objective-function" class="level5">
<h5 class="anchored" data-anchor-id="objective-function">Objective function</h5>
<p>Define an objective function:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> objective(trial):</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Setting nested=True will create a child run under the parent run.</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> mlflow.start_run(</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>            nested<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>            run_name<span class="op">=</span><span class="ss">f"trial_</span><span class="sc">{</span>trial<span class="sc">.</span>number<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="im">as</span> child_run:</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>        rf_max_depth <span class="op">=</span> trial.suggest_int(<span class="st">"rf_max_depth"</span>, <span class="dv">2</span>, <span class="dv">32</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>        rf_n_estimators <span class="op">=</span> trial.suggest_int(</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">"rf_n_estimators"</span>,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>            <span class="dv">50</span>,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>            <span class="dv">300</span>,</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>            step<span class="op">=</span><span class="dv">10</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>        rf_max_features <span class="op">=</span> trial.suggest_float(<span class="st">"rf_max_features"</span>, <span class="fl">0.2</span>, <span class="fl">1.0</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>        params <span class="op">=</span> {</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">"max_depth"</span>: rf_max_depth,</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">"n_estimators"</span>: rf_n_estimators,</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">"max_features"</span>: rf_max_features,</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Log current trial's parameters</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>        mlflow.log_params(params)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>        regressor_obj <span class="op">=</span> sklearn.ensemble.RandomForestRegressor(<span class="op">**</span>params)</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>        regressor_obj.fit(X_train, y_train)</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>        y_pred <span class="op">=</span> regressor_obj.predict(X_val)</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>        error <span class="op">=</span> sklearn.metrics.mean_squared_error(y_val, y_pred)</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Log current trial's error metric</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>        mlflow.log_metrics({<span class="st">"error"</span>: error})</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Log the model file</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>        mlflow.sklearn.log_model(regressor_obj, name<span class="op">=</span><span class="st">"calhousing_1"</span>)</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Make it easy to retrieve the best-performing child run later</span></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>        trial.set_user_attr(<span class="st">"run_id"</span>, child_run.info.run_id)</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> error</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="optimization-task" class="level5">
<h5 class="anchored" data-anchor-id="optimization-task">Optimization task</h5>
<p>Then run an optimization task:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> optuna</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a parent run that contains all child runs for different trials</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> mlflow.start_run(run_name<span class="op">=</span><span class="st">"calhousing_1_optimization_1"</span>) <span class="im">as</span> run:</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Log the experiment settings</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    n_trials <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    mlflow.log_param(<span class="st">"n_trials"</span>, n_trials)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    study <span class="op">=</span> optuna.create_study(direction<span class="op">=</span><span class="st">"minimize"</span>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    study.optimize(objective, n_trials<span class="op">=</span>n_trials)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Log the best trial and its run ID</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    mlflow.log_params(study.best_trial.params)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    mlflow.log_metrics({<span class="st">"best_error"</span>: study.best_value})</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> best_run_id <span class="op">:=</span> study.best_trial.user_attrs.get(<span class="st">"run_id"</span>):</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>        mlflow.log_param(<span class="st">"best_child_run_id"</span>, best_run_id)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="visualize-trials-errors" class="level4">
<h4 class="anchored" data-anchor-id="visualize-trials-errors">Visualize trials errors</h4>
<p>Go to the UI in the browser. If you haven’t done so yet, click on the experiment we called <span class="codelike">tuning_demo</span>.</p>
<p>Then click on the <span class="codelike">+</span> sign next to our <span class="codelike">optimization</span> experiment to expand it.</p>
<p>Finally click on <img src="img/mlflow_chartview.png" class="img-fluid" width="50"> (<span class="codelike">Chart view</span> button) to compare the trials.</p>
</section>
</section>
</section>
<section id="use-case-3-model-registry" class="level2">
<h2 class="anchored" data-anchor-id="use-case-3-model-registry">Use case 3: model registry</h2>
<section id="benefits" class="level3">
<h3 class="anchored" data-anchor-id="benefits">Benefits</h3>
<ul>
<li>Tracks development pipelines of models</li>
<li>Tracks model versions</li>
<li>Central place for all models (local or remote for collaborations)</li>
<li>Aliases, tags, annotations, metadata associated with models</li>
</ul>
</section>
<section id="register-models" class="level3">
<h3 class="anchored" data-anchor-id="register-models">Register models</h3>
<p>Whenever you care about a model, you should add it to the model registry.</p>
<p>You can do so when you log it by adding a value to the <code>registered_model_name</code> argument of the <code>log_model</code> function.</p>
<p>But often, you will do so afterwards, once you have looked at the logs and decided that they look good.</p>
<section id="register-models-in-the-ui" class="level4">
<h4 class="anchored" data-anchor-id="register-models-in-the-ui">Register models in the UI</h4>
<div class="columns">
<div class="column" style="width:55%;">
<section id="version-1" class="level5">
<h5 class="anchored" data-anchor-id="version-1">Version 1</h5>
<ul>
<li>Click on the experiment name containing the model</li>
<li>Click on <span class="codelike">Models</span> in the left menus</li>
<li>Click on the model to register</li>
<li>Click on the <span class="codelike">Register model</span> button in top right corner</li>
<li>In drop-down menu click <span class="codelike">Create New Model</span></li>
<li>Enter name of model</li>
<li>Click <span class="codelike">Register</span></li>
</ul>
</section>
</div><div class="column" style="width:45%;">
<section id="versions-2" class="level5">
<h5 class="anchored" data-anchor-id="versions-2">Versions 2+</h5>
<ul>
<li></li>
<li></li>
<li></li>
<li></li>
<li>In drop-down menu select model for which you want to create a new version</li>
<li>Click <span class="codelike">Register</span></li>
</ul>
</section>
</div>
</div>
</section>
<section id="register-programmatically" class="level4">
<h4 class="anchored" data-anchor-id="register-programmatically">Register programmatically</h4>
<p>You can also register models programmatically.</p>
<p>From model ID:</p>
<ul>
<li>Click on the experiment name containing the model</li>
<li>Click on <span class="codelike">Models</span> in the left menus</li>
<li>Click on the model to register</li>
</ul>
<p>Then run:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>mlflow.register_model(<span class="st">"models:/&lt;model-id&gt;"</span>, <span class="st">"&lt;name-of-registered-model&gt;"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="notenoit">
<ul>
<li><code>&lt;model-id&gt;</code> = the letters and digits after <span class="codelike">Model ID</span></li>
<li><code>&lt;name-of-registered-model&gt;</code> = the name you give to your registered model</li>
</ul>
</div>
<p>From run ID:</p>
<p>Navigate to and click on the model to register.</p>
<p>Then run:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>mlflow.register_model(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"runs:/&lt;source-run-id&gt;/&lt;model-name&gt;"</span>,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"&lt;name-of-registered-model&gt;"</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="notenoit">
<ul>
<li><code>&lt;source-run-id&gt;</code> = the digits in top right corner after <span class="codelike">Source run ID</span></li>
<li><code>&lt;model-name&gt;</code> = the name of the model in top left corner (the model you just clicked on)</li>
<li><code>&lt;name-of-registered-model&gt;</code> = the name you give to your registered model</li>
</ul>
</div>
</section>
</section>
<section id="load-registered-model" class="level3">
<h3 class="anchored" data-anchor-id="load-registered-model">Load registered model</h3>
<p>You can then load any of your registered models with:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>mlflow.<span class="op">&lt;</span>flavour<span class="op">&gt;</span>.load_model(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"models:/&lt;your_registered_model_name&gt;/&lt;model_version&gt;"</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="notenoit">
<p><code>&lt;flavour&gt;</code> = any ML/DL <a href="https://mlflow.org/docs/latest/ml/traditional-ml/tutorials/creating-custom-pyfunc/part1-named-flavors/">flavour</a> such as <code>pytorch</code>, <code>sklearn</code>, or any other named flavour (predefined code for supported ML/DL frameworks), or a custom PyFunc for unsupported frameworks.</p>
</div>
</section>
<section id="model-registry-demo" class="level3">
<h3 class="anchored" data-anchor-id="model-registry-demo">Model registry demo</h3>
<p>In the previous demos, we logged a number of models:</p>
<ul>
<li>the checkpoints of both our FashionMNIST runs</li>
<li>the final models of those two runs</li>
<li>the trials (child runs) of the California housing tuning experiment</li>
</ul>
<p>Let’s register some of these models.</p>
<section id="register-models-in-the-ui-1" class="level4">
<h4 class="anchored" data-anchor-id="register-models-in-the-ui-1">Register models in the UI</h4>
<div class="columns">
<div class="column" style="width:50%;">
<p>FashionMNIST:</p>
<ul>
<li>Click on <span class="codelike">model_tracking_demo</span></li>
<li>Click on <span class="codelike">Models</span> in the left menus</li>
<li>Click on <span class="codelike">fashionmnist_1_trained</span></li>
<li>Click on the <span class="codelike">Register model</span> button in top right corner</li>
<li>In drop-down menu click <span class="codelike">Create New Model</span></li>
<li>Enter: “fashionmnist_1”</li>
<li>Click <span class="codelike">Register</span></li>
</ul>
</div><div class="column" style="width:50%;">
<p>California housing:</p>
<ul>
<li>Click on <span class="codelike">tuning_demo</span></li>
<li>Click on <span class="codelike">Models</span> in the left menus</li>
<li>Click on the <span class="codelike">calhousing_1</span> line corresponding to our best trial run</li>
<li>Click on the <span class="codelike">Register model</span> button in top right corner</li>
<li>In drop-down menu click <span class="codelike">Create New Model</span></li>
<li>Enter: “calhousing_1_best”</li>
<li>Click <span class="codelike">Register</span></li>
</ul>
</div>
</div>
</section>
<section id="register-models-in-python" class="level4">
<h4 class="anchored" data-anchor-id="register-models-in-python">Register models in Python</h4>
<p>In the UI:</p>
<ul>
<li>Click on <span class="codelike">model_tracking_demo</span></li>
<li>Click on <span class="codelike">Models</span> in the left menus</li>
<li>Click on <span class="codelike">fashionmnist_2_trained</span></li>
</ul>
<p>Then run:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>mlflow.register_model(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"models:/m-a7a4cd35cc4c4fe4b2e3d839b1307b5d"</span>,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"fashionmnist_2"</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>In the UI:</p>
<ul>
<li>Click on <span class="codelike">model_tracking_demo</span></li>
<li>Click on <span class="codelike">Models</span> in the left menus</li>
<li>Click on <span class="codelike">fashionmnist_2_trained</span></li>
</ul>
<p>Alternatively:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>mlflow.register_model(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"runs:/1a2844d0125e40cfac528ae44c4ae76a/fashionmnist_2_trained"</span>,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"fashionmnist_2"</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="load-registered-models" class="level4">
<h4 class="anchored" data-anchor-id="load-registered-models">Load registered models</h4>
<p>You can load back any registered model by its name and version number:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>fashionmnist_1 <span class="op">=</span> mlflow.pytorch.load_model(<span class="st">"models:/fashionmnist_1/1"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>calhousing_1_best <span class="op">=</span> mlflow.sklearn.load_model(<span class="st">"models:/calhousing_1_best/1"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Let’s print the <code>fashionmnist_1</code> model:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>fashionmnist_1</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>and the <code>calhousing_1_best</code> model:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>calhousing_1_best</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
</section>
<section id="models-signatures" class="level2">
<h2 class="anchored" data-anchor-id="models-signatures">Models signatures</h2>
<p>You might have noticed that we got the following warning at each model we logged:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb40"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>WARNING mlflow.models.model: Model logged without a signature and input example.</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>Please set `input_example` parameter when logging the model to auto infer the model signature.</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Let’s dive into this.</p>
<section id="benefits-of-models-signatures" class="level3">
<h3 class="anchored" data-anchor-id="benefits-of-models-signatures">Benefits of models signatures</h3>
<p>Model signatures describe the schema of inputs and outputs.<br>
They help in model understanding and define how the model should be used.</p>
</section>
<section id="input-examples" class="level3">
<h3 class="anchored" data-anchor-id="input-examples">Input examples</h3>
<p>Input examples illustrate the data type and format that should be used with models and ensures validation that the models work properly. MLflow can infer a model signature for a model from an input example.</p>
<p>The input example also provides a test for the model during logging. It thus a good practice to add an input example whenever a model is logged.</p>
</section>
<section id="example" class="level3">
<h3 class="anchored" data-anchor-id="example">Example</h3>
<p>Let’s go back to the objective function we defined in the tuning demo as an example and let’s add the first the first element of the <code>X</code> ndarray an input example.</p>
<p>When we define an objective function, we had the following:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> objective(trial):</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Setting nested=True will create a child run under the parent run.</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> mlflow.start_run(</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>            nested<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>            run_name<span class="op">=</span><span class="ss">f"trial_</span><span class="sc">{</span>trial<span class="sc">.</span>number<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="im">as</span> child_run:</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>        rf_max_depth <span class="op">=</span> trial.suggest_int(<span class="st">"rf_max_depth"</span>, <span class="dv">2</span>, <span class="dv">32</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>        rf_n_estimators <span class="op">=</span> trial.suggest_int(</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">"rf_n_estimators"</span>,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>            <span class="dv">50</span>,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>            <span class="dv">300</span>,</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>            step<span class="op">=</span><span class="dv">10</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>        rf_max_features <span class="op">=</span> trial.suggest_float(<span class="st">"rf_max_features"</span>, <span class="fl">0.2</span>, <span class="fl">1.0</span>)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>        params <span class="op">=</span> {</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">"max_depth"</span>: rf_max_depth,</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">"n_estimators"</span>: rf_n_estimators,</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">"max_features"</span>: rf_max_features,</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Log current trial's parameters</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>        mlflow.log_params(params)</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>        regressor_obj <span class="op">=</span> sklearn.ensemble.RandomForestRegressor(<span class="op">**</span>params)</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>        regressor_obj.fit(X_train, y_train)</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>        y_pred <span class="op">=</span> regressor_obj.predict(X_val)</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>        error <span class="op">=</span> sklearn.metrics.mean_squared_error(y_val, y_pred)</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Log current trial's error metric</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>        mlflow.log_metrics({<span class="st">"error"</span>: error})</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Log the model file</span></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>        mlflow.sklearn.log_model(regressor_obj, name<span class="op">=</span><span class="st">"calhousing_1"</span>)</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Make it easy to retrieve the best-performing child run later</span></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>        trial.set_user_attr(<span class="st">"run_id"</span>, child_run.info.run_id)</span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> error</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Let’s add the additional <code>input_example</code> argument in:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>mlflow.sklearn.log_model(regressor_obj, name<span class="op">=</span><span class="st">"calhousing_1"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>And have it look like:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>mlflow.sklearn.log_model(</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    regressor_obj,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"calhousing_1"</span>,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    input_example<span class="op">=</span>X[[<span class="dv">0</span>]]</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> objective(trial):</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Setting nested=True will create a child run under the parent run.</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> mlflow.start_run(</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>            nested<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>            run_name<span class="op">=</span><span class="ss">f"trial_</span><span class="sc">{</span>trial<span class="sc">.</span>number<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="im">as</span> child_run:</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>        rf_max_depth <span class="op">=</span> trial.suggest_int(<span class="st">"rf_max_depth"</span>, <span class="dv">2</span>, <span class="dv">32</span>)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>        rf_n_estimators <span class="op">=</span> trial.suggest_int(</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">"rf_n_estimators"</span>,</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>            <span class="dv">50</span>,</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>            <span class="dv">300</span>,</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>            step<span class="op">=</span><span class="dv">10</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>        rf_max_features <span class="op">=</span> trial.suggest_float(<span class="st">"rf_max_features"</span>, <span class="fl">0.2</span>, <span class="fl">1.0</span>)</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>        params <span class="op">=</span> {</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">"max_depth"</span>: rf_max_depth,</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">"n_estimators"</span>: rf_n_estimators,</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">"max_features"</span>: rf_max_features,</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Log current trial's parameters</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>        mlflow.log_params(params)</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>        regressor_obj <span class="op">=</span> sklearn.ensemble.RandomForestRegressor(<span class="op">**</span>params)</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>        regressor_obj.fit(X_train, y_train)</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>        y_pred <span class="op">=</span> regressor_obj.predict(X_val)</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>        error <span class="op">=</span> sklearn.metrics.mean_squared_error(y_val, y_pred)</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Log current trial's error metric</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>        mlflow.log_metrics({<span class="st">"error"</span>: error})</span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Log the model file</span></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>        mlflow.sklearn.log_model(</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>            regressor_obj,</span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>            name<span class="op">=</span><span class="st">"calhousing_1"</span>,</span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>            input_example<span class="op">=</span>X[[<span class="dv">0</span>]]</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Make it easy to retrieve the best-performing child run later</span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>        trial.set_user_attr(<span class="st">"run_id"</span>, child_run.info.run_id)</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> error</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>If we re-run our optimization task now, we don’t get any warnings about missing signatures anymore:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> optuna</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a parent run that contains all child runs for different trials</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> mlflow.start_run(run_name<span class="op">=</span><span class="st">"calhousing_1_optimization_1"</span>) <span class="im">as</span> run:</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Log the experiment settings</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    n_trials <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    mlflow.log_param(<span class="st">"n_trials"</span>, n_trials)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    study <span class="op">=</span> optuna.create_study(direction<span class="op">=</span><span class="st">"minimize"</span>)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    study.optimize(objective, n_trials<span class="op">=</span>n_trials)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Log the best trial and its run ID</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    mlflow.log_params(study.best_trial.params)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    mlflow.log_metrics({<span class="st">"best_error"</span>: study.best_value})</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> best_run_id <span class="op">:=</span> study.best_trial.user_attrs.get(<span class="st">"run_id"</span>):</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>        mlflow.log_param(<span class="st">"best_child_run_id"</span>, best_run_id)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<section id="signature-test" class="level4">
<h4 class="anchored" data-anchor-id="signature-test">Signature test</h4>
<p>You can do a sanity check of your signature by running your input example in the model.</p>
<p>First, register the model and load it (let’s use the model we already registered):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>calhousing_1_best <span class="op">=</span> mlflow.sklearn.load_model(<span class="st">"models:/calhousing_1_best/1"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Then test the input example:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> calhousing_1_best.predict(X[[<span class="dv">0</span>]])</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"✅ Signature validation passed"</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"❌ Signature issue: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<pre><code>✅ Signature validation passed</code></pre>
<p>If you used a bad input sample, you will get some informative error:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> calhousing_1_best.predict(X[<span class="dv">0</span>])</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"✅ Signature validation passed"</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"❌ Signature issue: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<pre><code>❌ Signature issue: Expected 2D array, got 1D array instead:
array=[   8.3252      41.           6.984127     1.0238096  322.
    2.5555556   37.88      -122.23     ].
Reshape your data either using array.reshape(-1, 1) if your data has 
a single feature or array.reshape(1, -1) if it contains a single sample.</code></pre>
</section>
</section>
</section>
<section id="use-case-4-datasets-tracking" class="level2">
<h2 class="anchored" data-anchor-id="use-case-4-datasets-tracking">Use case 4: datasets tracking</h2>
<section id="benefits-1" class="level3">
<h3 class="anchored" data-anchor-id="benefits-1">Benefits</h3>
<ul>
<li>Keep data and models together for reproducibility</li>
<li>Keep data versions for traceability</li>
<li>Record metadata and data sources</li>
<li>Share data for collaborations (when using remote servers)</li>
</ul>
</section>
<section id="supported-data-types" class="level3">
<h3 class="anchored" data-anchor-id="supported-data-types">Supported data types</h3>
<ul>
<li><code>PandasDataset</code>: Pandas DataFrames</li>
<li><code>SparkDataset</code>: Apache Spark DataFrames</li>
<li><code>NumpyDataset</code>: NumPy arrays</li>
<li><code>PolarsDataset</code>: Polars DataFrames</li>
<li><code>HuggingFaceDataset</code>: Hugging Face datasets</li>
<li><code>TensorFlowDataset</code>: TensorFlow datasets</li>
<li><code>MetaDataset</code>: metadata-only datasets (no actual data storage)</li>
</ul>
<p>Non supported data types (e.g.&nbsp;<code>torchvision</code> datasets) need to be converted to supported types or logged via custom functions.</p>
</section>
<section id="example-1" class="level3">
<h3 class="anchored" data-anchor-id="example-1">Example</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> pl.DataFrame({<span class="st">"X"</span>: X_train, <span class="st">"y"</span>: y_train})</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>val_data <span class="op">=</span> pl.DataFrame({<span class="st">"X"</span>: X_val, <span class="st">"y"</span>: y_val})</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>train_dataset <span class="op">=</span> mlflow.data.from_polars(train_data, name<span class="op">=</span><span class="st">"calhousing_train"</span>)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>val_dataset <span class="op">=</span> mlflow.data.from_polars(val_data, name<span class="op">=</span><span class="st">"calhousing_val"</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> mlflow.start_run():</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    mlflow.log_input(train_dataset, context<span class="op">=</span><span class="st">"training"</span>)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    mlflow.log_input(val_dataset, context<span class="op">=</span><span class="st">"validation"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Usage without databases will be deprecated at some point and is not recommended.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/mint\.westdri\.ca\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../ai/mlops/wb_mlflow.html" class="pagination-link" aria-label="ML experiment tracking">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">ML experiment tracking</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../about.html">
<p>About</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../talks/index.html">
<p>Talks</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/WestDRI" target="_blank">
      <i class="bi bi-github" role="img" aria-label="GitHub organization">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://docs.alliancecan.ca/wiki/Technical_documentation" target="_blank">
      <i class="bi bi-wikipedia" role="img" aria-label="Alliance wikipedia">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/channel/UCfgds4Qf7VFOv4ORRvFFmhw" target="_blank">
      <i class="bi bi-youtube" role="img" aria-label="YouTube channel">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://mint.westdri.ca/calendar">
      <i class="bi bi-calendar-week" role="img" aria-label="Training calendar">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://mint.westdri.ca/newsletter">
      <i class="bi bi-envelope-fill" role="img" aria-label="Newsletter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://mint.westdri.ca/contact">
      <i class="bi bi-mailbox2" role="img" aria-label="Contact us">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>
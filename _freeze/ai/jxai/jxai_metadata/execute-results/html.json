{
  "hash": "43e895bdc55d4730ed6e6d6f18a19f10",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Compiling the metadata\nauthor: Marie-Hélène Burle\n---\n\n:::{.def}\n\nIn this section, we process some of the metadata associated with the NABirds dataset by creating a [Polars](https://github.com/pola-rs/polars) DataFrame collecting all the information we will need while processing the images and training our model.\n\n*[Polars](/python/hpc_polars) is a modern and ultra fast package that you should use instead of [pandas](https://github.com/pandas-dev/pandas) whenever you can if you care about performance.*\n\n:::\n\n## Fix problem files\n\nThe metadata comes in various space-separated CSV files. Two of them are problematic because they are jagged: the number of elements per line is inconsistent.\n\nFirst of all, let's create new files without comma from these files. This should be easy to do in the Python function that we will use later, but for some reason that I could never figure out, I failed to implement it in Python. For this reason, I am cheating and doing it in Bash (or Zsh) using the utility [sed](https://en.wikipedia.org/wiki/Sed) that makes such transformations so easy.\n\nIn Bash or Zsh:\n\n```{.bash}\nsed 's/,//g' <path-of-the-nabirds-dir>/photographers.txt >\n    <path-of-the-nabirds-dir>/photographers_nocommas.txt\n\nsed 's/,//g' <path-of-the-nabirds-dir>/classes.txt >\n    <path-of-the-nabirds-dir>/classes_nocommas.txt\n```\n\n:::{.note}\n\n`<path-of-the-nabirds-dir>` is the path in which you downloaded the `nabirds` dataset.\n\n:::\n\nAlternatively:\n\n```{.bash}\ncd <path-of-the-nabirds-dir>\n\nsed 's/,//g' photographers.txt > photographers_nocommas.txt\nsed 's/,//g' classes.txt > classes_nocommas.txt\n```\n\nWe could finish fixing these files in Bash (which would be a lot easier and much less wordy!) but because this is a Python course, let's do the rest in Python.\n\nLet's create a function that will do the rest of the cleaning and write two new files that won't be problematic:\n\n```{.python}\nbase_dir = \"<path-of-the-nabirds-dir>\"\n```\n\n:::{.note}\n\nTo be replaced by proper path.\n\n:::\n\n```{.python}\nimport os\nimport csv\n\ndef replace_spaces_except_first(input_filepath, output_filepath):\n    \"\"\"\n    Replaces all spaces with underscores in a CSV file, except the first space\n    on each line.\n\n    Args:\n        input_filepath (str): the path of the input file.\n        output_filepath (str): the path of the output file.\n    \"\"\"\n    with open(input_filepath, 'r') as infile, \\\n         open(output_filepath, 'w') as outfile:\n        reader = csv.reader(infile)\n        writer = csv.writer(outfile)\n\n        for row in reader:\n            processed_row = []\n            for item in row:\n                # Remove quotes\n                item = item.replace('\"', '')\n\n                # Find the first space\n                first_space_index = item.find(' ')\n\n                # Keep the part up to the first space\n                # and replace subsequent spaces with underscores\n                part_with_first_space = item[:first_space_index + 1]\n                part_after_first_space = item[first_space_index + 1:].replace(' ', '_')\n                processed_item = part_with_first_space + part_after_first_space\n                processed_row.append(processed_item)\n            writer.writerow(processed_row)\n```\n\nThen we can apply the function on our files:\n\n```{.python}\nreplace_spaces_except_first(\n    os.path.join(base_dir, \"photographers_nocommas.txt\"),\n    os.path.join(base_dir, \"photographers_fixed.txt\")\n)\n\nreplace_spaces_except_first(\n    os.path.join(base_dir, \"classes_nocommas.txt\"),\n    os.path.join(base_dir, \"classes_fixed.txt\")\n)\n```\n\n## Create variables\n\n\n\n::: {#efdf5e52 .cell execution_count=3}\n``` {.python .cell-code}\nimport os\n\nimg_dir = os.path.join(base_dir, \"images\")\nbb_file = os.path.join(base_dir, \"bounding_boxes.txt\")\nclasses_translation_file = os.path.join(base_dir, \"classes_fixed.txt\")\nclass_labels_file = os.path.join(base_dir, \"image_class_labels.txt\")\nimg_file = os.path.join(base_dir, \"images.txt\")\nphotographers_file = os.path.join(base_dir, \"photographers_fixed.txt\")\nsizes_file = os.path.join(base_dir, \"sizes.txt\")\ntrain_test_split_file = os.path.join(base_dir, \"train_test_split.txt\")\n```\n:::\n\n\n## Create a metadata Dataframe\n\nFirst, we create a series of DataFrames from each CSV file:\n\n::: {#00b4cdf7 .cell execution_count=4}\n``` {.python .cell-code}\nimport polars as pl\n\nbb = pl.read_csv(\n    bb_file,\n    separator=\" \",\n    has_header=False,\n    new_columns=[\"UUID\", \"bb_x\", \"bb_y\", \"bb_width\", \"bb_height\"]\n)\n\nclasses = pl.read_csv(\n    class_labels_file,\n    separator=\" \",\n    has_header=False,\n    new_columns=[\"UUID\", \"class\"]\n)\n\nclasses_translation = pl.read_csv(\n    classes_translation_file,\n    separator=\" \",\n    has_header=False,\n    new_columns=[\"class\", \"id\"]\n)\n\nimg_paths = pl.read_csv(\n    img_file,\n    separator=\" \",\n    has_header=False,\n    new_columns=[\"UUID\", \"path\"]\n)\n\nphotographers = pl.read_csv(\n    photographers_file,\n    separator=\" \",\n    has_header=False,\n    new_columns=[\"UUID\", \"photographer\"]\n)\n\nsizes = pl.read_csv(\n    sizes_file,\n    separator=\" \",\n    has_header=False,\n    new_columns=[\"UUID\", \"img_width\", \"img_height\"]\n)\n\ntrain_test_split = pl.read_csv(\n    train_test_split_file,\n    separator=\" \",\n    has_header=False,\n    new_columns=[\"UUID\", \"is_training_img\"]\n)\n```\n:::\n\n\nThen we can combine the classes DataFrames so that the birds identifications becomes associated with the birds UUIDs:\n\n::: {#0639f7d3 .cell execution_count=5}\n``` {.python .cell-code}\nclasses_metadata = (\n    classes.join(classes_translation, on=\"class\")\n)\n```\n:::\n\n\nFinally, we combine all the DataFrames:\n\n::: {#7c43a439 .cell execution_count=6}\n``` {.python .cell-code}\nmetadata = (\n    bb.join(classes_metadata, on=\"UUID\")\n    .join(img_paths, on=\"UUID\")\n    .join(photographers, on=\"UUID\")\n    .join(sizes, on=\"UUID\")\n    .join(train_test_split, on=\"UUID\")\n)\n```\n:::\n\n\n## Sanity checks\n\nLet's see what our DataFrame looks like:\n\n::: {#97f976d0 .cell execution_count=7}\n``` {.python .cell-code}\nprint(metadata)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nshape: (48_562, 12)\n┌──────────────┬──────┬──────┬──────────┬───┬──────────────┬───────────┬────────────┬──────────────┐\n│ UUID         ┆ bb_x ┆ bb_y ┆ bb_width ┆ … ┆ photographer ┆ img_width ┆ img_height ┆ is_training_ │\n│ ---          ┆ ---  ┆ ---  ┆ ---      ┆   ┆ ---          ┆ ---       ┆ ---        ┆ img          │\n│ str          ┆ i64  ┆ i64  ┆ i64      ┆   ┆ str          ┆ i64       ┆ i64        ┆ ---          │\n│              ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆ i64          │\n╞══════════════╪══════╪══════╪══════════╪═══╪══════════════╪═══════════╪════════════╪══════════════╡\n│ 0000139e-21d ┆ 83   ┆ 59   ┆ 128      ┆ … ┆ Ruth_Cantwel ┆ 296       ┆ 341        ┆ 0            │\n│ c-4d0c-bfe1- ┆      ┆      ┆          ┆   ┆ l            ┆           ┆            ┆              │\n│ 4cae3c…      ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n│ 0000d9fc-4e0 ┆ 328  ┆ 88   ┆ 163      ┆ … ┆ Christopher_ ┆ 640       ┆ 427        ┆ 0            │\n│ 2-4c06-a0af- ┆      ┆      ┆          ┆   ┆ L._Wood_Chri ┆           ┆            ┆              │\n│ a55cfb…      ┆      ┆      ┆          ┆   ┆ s_Wood       ┆           ┆            ┆              │\n│ 00019306-9d8 ┆ 174  ┆ 367  ┆ 219      ┆ … ┆ Ryan_Schain  ┆ 730       ┆ 1024       ┆ 0            │\n│ 3-4334-b255- ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n│ a44774…      ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n│ 0001afd4-99a ┆ 307  ┆ 179  ┆ 492      ┆ … ┆ Laura_Ericks ┆ 1024      ┆ 680        ┆ 1            │\n│ 1-4a67-b940- ┆      ┆      ┆          ┆   ┆ on           ┆           ┆            ┆              │\n│ d41941…      ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n│ 000332b8-997 ┆ 395  ┆ 139  ┆ 262      ┆ … ┆ Dan_Irizarry ┆ 1024      ┆ 682        ┆ 0            │\n│ c-4540-9647- ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n│ 2f0a84…      ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n│ …            ┆ …    ┆ …    ┆ …        ┆ … ┆ …            ┆ …         ┆ …          ┆ …            │\n│ fff86e8b-795 ┆ 344  ┆ 163  ┆ 291      ┆ … ┆ Nancy_Landry ┆ 1024      ┆ 819        ┆ 1            │\n│ f-400a-91e8- ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n│ 565bbb…      ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n│ fff926d7-cca ┆ 330  ┆ 180  ┆ 339      ┆ … ┆ Ruth_Sulliva ┆ 1024      ┆ 956        ┆ 1            │\n│ d-4788-839e- ┆      ┆      ┆          ┆   ┆ n            ┆           ┆            ┆              │\n│ 97af2d…      ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n│ fffa33ef-a76 ┆ 184  ┆ 94   ┆ 258      ┆ … ┆ Gerry_Dewagh ┆ 640       ┆ 800        ┆ 1            │\n│ 5-408d-8d66- ┆      ┆      ┆          ┆   ┆ e            ┆           ┆            ┆              │\n│ 6efc7f…      ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n│ ffff0d87-bc8 ┆ 102  ┆ 210  ┆ 461      ┆ … ┆ Muriel_Nedde ┆ 731       ┆ 1024       ┆ 0            │\n│ 4-4ef2-a47e- ┆      ┆      ┆          ┆   ┆ rmeyer       ┆           ┆            ┆              │\n│ a4bfa4…      ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n│ fffff3a5-2a7 ┆ 281  ┆ 164  ┆ 524      ┆ … ┆ Dominic_Sher ┆ 1024      ┆ 683        ┆ 0            │\n│ 5-47d0-887f- ┆      ┆      ┆          ┆   ┆ ony          ┆           ┆            ┆              │\n│ 03871e…      ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n└──────────────┴──────┴──────┴──────────┴───┴──────────────┴───────────┴────────────┴──────────────┘\n```\n:::\n:::\n\n\nAnd then let's explore a number of characteristics:\n\n::: {#3c69ff1b .cell execution_count=8}\n``` {.python .cell-code}\nprint(metadata.columns)\nprint(metadata.row(0))\nprint(metadata.row(-1))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n['UUID', 'bb_x', 'bb_y', 'bb_width', 'bb_height', 'class', 'id', 'path', 'photographer', 'img_width', 'img_height', 'is_training_img']\n('0000139e-21dc-4d0c-bfe1-4cae3c85c829', 83, 59, 128, 228, 817, 'Oak_Titmouse', '0817/0000139e21dc4d0cbfe14cae3c85c829.jpg', 'Ruth_Cantwell', 296, 341, 0)\n('fffff3a5-2a75-47d0-887f-03871e3f9a37', 281, 164, 524, 279, 880, 'Black-throated_Gray_Warbler', '0880/fffff3a52a7547d0887f03871e3f9a37.jpg', 'Dominic_Sherony', 1024, 683, 0)\n```\n:::\n:::\n\n\n::: {#060f6614 .cell execution_count=9}\n``` {.python .cell-code}\nprint(metadata.head())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nshape: (5, 12)\n┌──────────────┬──────┬──────┬──────────┬───┬──────────────┬───────────┬────────────┬──────────────┐\n│ UUID         ┆ bb_x ┆ bb_y ┆ bb_width ┆ … ┆ photographer ┆ img_width ┆ img_height ┆ is_training_ │\n│ ---          ┆ ---  ┆ ---  ┆ ---      ┆   ┆ ---          ┆ ---       ┆ ---        ┆ img          │\n│ str          ┆ i64  ┆ i64  ┆ i64      ┆   ┆ str          ┆ i64       ┆ i64        ┆ ---          │\n│              ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆ i64          │\n╞══════════════╪══════╪══════╪══════════╪═══╪══════════════╪═══════════╪════════════╪══════════════╡\n│ 0000139e-21d ┆ 83   ┆ 59   ┆ 128      ┆ … ┆ Ruth_Cantwel ┆ 296       ┆ 341        ┆ 0            │\n│ c-4d0c-bfe1- ┆      ┆      ┆          ┆   ┆ l            ┆           ┆            ┆              │\n│ 4cae3c…      ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n│ 0000d9fc-4e0 ┆ 328  ┆ 88   ┆ 163      ┆ … ┆ Christopher_ ┆ 640       ┆ 427        ┆ 0            │\n│ 2-4c06-a0af- ┆      ┆      ┆          ┆   ┆ L._Wood_Chri ┆           ┆            ┆              │\n│ a55cfb…      ┆      ┆      ┆          ┆   ┆ s_Wood       ┆           ┆            ┆              │\n│ 00019306-9d8 ┆ 174  ┆ 367  ┆ 219      ┆ … ┆ Ryan_Schain  ┆ 730       ┆ 1024       ┆ 0            │\n│ 3-4334-b255- ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n│ a44774…      ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n│ 0001afd4-99a ┆ 307  ┆ 179  ┆ 492      ┆ … ┆ Laura_Ericks ┆ 1024      ┆ 680        ┆ 1            │\n│ 1-4a67-b940- ┆      ┆      ┆          ┆   ┆ on           ┆           ┆            ┆              │\n│ d41941…      ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n│ 000332b8-997 ┆ 395  ┆ 139  ┆ 262      ┆ … ┆ Dan_Irizarry ┆ 1024      ┆ 682        ┆ 0            │\n│ c-4540-9647- ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n│ 2f0a84…      ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n└──────────────┴──────┴──────┴──────────┴───┴──────────────┴───────────┴────────────┴──────────────┘\n```\n:::\n:::\n\n\n::: {#85aa4758 .cell execution_count=10}\n``` {.python .cell-code}\nprint(metadata.tail())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nshape: (5, 12)\n┌──────────────┬──────┬──────┬──────────┬───┬──────────────┬───────────┬────────────┬──────────────┐\n│ UUID         ┆ bb_x ┆ bb_y ┆ bb_width ┆ … ┆ photographer ┆ img_width ┆ img_height ┆ is_training_ │\n│ ---          ┆ ---  ┆ ---  ┆ ---      ┆   ┆ ---          ┆ ---       ┆ ---        ┆ img          │\n│ str          ┆ i64  ┆ i64  ┆ i64      ┆   ┆ str          ┆ i64       ┆ i64        ┆ ---          │\n│              ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆ i64          │\n╞══════════════╪══════╪══════╪══════════╪═══╪══════════════╪═══════════╪════════════╪══════════════╡\n│ fff86e8b-795 ┆ 344  ┆ 163  ┆ 291      ┆ … ┆ Nancy_Landry ┆ 1024      ┆ 819        ┆ 1            │\n│ f-400a-91e8- ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n│ 565bbb…      ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n│ fff926d7-cca ┆ 330  ┆ 180  ┆ 339      ┆ … ┆ Ruth_Sulliva ┆ 1024      ┆ 956        ┆ 1            │\n│ d-4788-839e- ┆      ┆      ┆          ┆   ┆ n            ┆           ┆            ┆              │\n│ 97af2d…      ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n│ fffa33ef-a76 ┆ 184  ┆ 94   ┆ 258      ┆ … ┆ Gerry_Dewagh ┆ 640       ┆ 800        ┆ 1            │\n│ 5-408d-8d66- ┆      ┆      ┆          ┆   ┆ e            ┆           ┆            ┆              │\n│ 6efc7f…      ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n│ ffff0d87-bc8 ┆ 102  ┆ 210  ┆ 461      ┆ … ┆ Muriel_Nedde ┆ 731       ┆ 1024       ┆ 0            │\n│ 4-4ef2-a47e- ┆      ┆      ┆          ┆   ┆ rmeyer       ┆           ┆            ┆              │\n│ a4bfa4…      ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n│ fffff3a5-2a7 ┆ 281  ┆ 164  ┆ 524      ┆ … ┆ Dominic_Sher ┆ 1024      ┆ 683        ┆ 0            │\n│ 5-47d0-887f- ┆      ┆      ┆          ┆   ┆ ony          ┆           ┆            ┆              │\n│ 03871e…      ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n└──────────────┴──────┴──────┴──────────┴───┴──────────────┴───────────┴────────────┴──────────────┘\n```\n:::\n:::\n\n\n::: {#33a40a14 .cell execution_count=11}\n``` {.python .cell-code}\nimport random\n\nrandom.seed(123)\nprint(metadata.sample())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nshape: (1, 12)\n┌──────────────┬──────┬──────┬──────────┬───┬──────────────┬───────────┬────────────┬──────────────┐\n│ UUID         ┆ bb_x ┆ bb_y ┆ bb_width ┆ … ┆ photographer ┆ img_width ┆ img_height ┆ is_training_ │\n│ ---          ┆ ---  ┆ ---  ┆ ---      ┆   ┆ ---          ┆ ---       ┆ ---        ┆ img          │\n│ str          ┆ i64  ┆ i64  ┆ i64      ┆   ┆ str          ┆ i64       ┆ i64        ┆ ---          │\n│              ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆ i64          │\n╞══════════════╪══════╪══════╪══════════╪═══╪══════════════╪═══════════╪════════════╪══════════════╡\n│ b20cc001-80f ┆ 382  ┆ 236  ┆ 308      ┆ … ┆ Alex_Burdo   ┆ 1024      ┆ 723        ┆ 0            │\n│ 0-4280-9cd5- ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n│ b9b569…      ┆      ┆      ┆          ┆   ┆              ┆           ┆            ┆              │\n└──────────────┴──────┴──────┴──────────┴───┴──────────────┴───────────┴────────────┴──────────────┘\n```\n:::\n:::\n\n\n::: {#4bb384de .cell execution_count=12}\n``` {.python .cell-code}\nprint(metadata.schema)\nprint(metadata.shape)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSchema({'UUID': String, 'bb_x': Int64, 'bb_y': Int64, 'bb_width': Int64, 'bb_height': Int64, 'class': Int64, 'id': String, 'path': String, 'photographer': String, 'img_width': Int64, 'img_height': Int64, 'is_training_img': Int64})\n(48562, 12)\n```\n:::\n:::\n\n\n::: {#2b5aadc1 .cell execution_count=13}\n``` {.python .cell-code}\nprint(metadata.glimpse())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 48562\nColumns: 12\n$ UUID            <str> '0000139e-21dc-4d0c-bfe1-4cae3c85c829', '0000d9fc-4e02-4c06-a0af-a55cfb16b12b', '00019306-9d83-4334-b255-a447742edce3', '0001afd4-99a1-4a67-b940-d419413e23b3', '000332b8-997c-4540-9647-2f0a8495aecf', '000343bd-5215-49ba-ab9c-7c97a70ac1a5', '0004ff8d-0cc8-47ee-94ba-43352a8b9eb4', '0007181f-a727-4481-ad89-591200c61b9d', '00071e20-8156-4bd8-b5ca-6445c2560ee5', '0007acfc-c0e6-4393-9ab6-02215a82ef63'\n$ bb_x            <i64> 83, 328, 174, 307, 395, 120, 417, 47, 260, 193\n$ bb_y            <i64> 59, 88, 367, 179, 139, 210, 109, 194, 146, 291\n$ bb_width        <i64> 128, 163, 219, 492, 262, 587, 221, 819, 578, 526\n$ bb_height       <i64> 228, 298, 378, 224, 390, 357, 467, 573, 516, 145\n$ class           <i64> 817, 860, 900, 645, 929, 652, 951, 900, 988, 400\n$ id              <str> 'Oak_Titmouse', 'Ovenbird', 'Savannah_Sparrow', 'Eared_Grebe_(Nonbreeding/juvenile)', 'Eastern_Phoebe', 'Yellow-crowned_Night-Heron_(Immature)', 'Florida_Scrub-Jay', 'Savannah_Sparrow', 'Yellow-headed_Blackbird_(Female/Immature_Male)', 'Herring_Gull_(Adult)'\n$ path            <str> '0817/0000139e21dc4d0cbfe14cae3c85c829.jpg', '0860/0000d9fc4e024c06a0afa55cfb16b12b.jpg', '0900/000193069d834334b255a447742edce3.jpg', '0645/0001afd499a14a67b940d419413e23b3.jpg', '0929/000332b8997c454096472f0a8495aecf.jpg', '0652/000343bd521549baab9c7c97a70ac1a5.jpg', '0951/0004ff8d0cc847ee94ba43352a8b9eb4.jpg', '0900/0007181fa7274481ad89591200c61b9d.jpg', '0988/00071e2081564bd8b5ca6445c2560ee5.jpg', '0400/0007acfcc0e643939ab602215a82ef63.jpg'\n$ photographer    <str> 'Ruth_Cantwell', 'Christopher_L._Wood_Chris_Wood', 'Ryan_Schain', 'Laura_Erickson', 'Dan_Irizarry', 'Ken_Schneider', 'Velma_Knowles', 'Matt_Tillett', 'Terry_Gray', 'Cory_Gregory'\n$ img_width       <i64> 296, 640, 730, 1024, 1024, 1024, 1024, 1024, 1024, 1024\n$ img_height      <i64> 341, 427, 1024, 680, 682, 768, 683, 819, 768, 681\n$ is_training_img <i64> 0, 0, 0, 1, 0, 0, 0, 1, 1, 0\n\nNone\n```\n:::\n:::\n\n\n::: {#9f630574 .cell execution_count=14}\n``` {.python .cell-code}\nprint(metadata.describe())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nshape: (9, 13)\n┌───────────┬───────────┬───────────┬───────────┬───┬───────────┬───────────┬───────────┬──────────┐\n│ statistic ┆ UUID      ┆ bb_x      ┆ bb_y      ┆ … ┆ photograp ┆ img_width ┆ img_heigh ┆ is_train │\n│ ---       ┆ ---       ┆ ---       ┆ ---       ┆   ┆ her       ┆ ---       ┆ t         ┆ ing_img  │\n│ str       ┆ str       ┆ f64       ┆ f64       ┆   ┆ ---       ┆ f64       ┆ ---       ┆ ---      │\n│           ┆           ┆           ┆           ┆   ┆ str       ┆           ┆ f64       ┆ f64      │\n╞═══════════╪═══════════╪═══════════╪═══════════╪═══╪═══════════╪═══════════╪═══════════╪══════════╡\n│ count     ┆ 48562     ┆ 48562.0   ┆ 48562.0   ┆ … ┆ 48562     ┆ 48562.0   ┆ 48562.0   ┆ 48562.0  │\n│ null_coun ┆ 0         ┆ 0.0       ┆ 0.0       ┆ … ┆ 0         ┆ 0.0       ┆ 0.0       ┆ 0.0      │\n│ t         ┆           ┆           ┆           ┆   ┆           ┆           ┆           ┆          │\n│ mean      ┆ null      ┆ 221.68531 ┆ 158.53412 ┆ … ┆ null      ┆ 898.50866 ┆ 712.33555 ┆ 0.492752 │\n│           ┆           ┆           ┆ 1         ┆   ┆           ┆ 9         ┆           ┆          │\n│ std       ┆ null      ┆ 133.05486 ┆ 80.976264 ┆ … ┆ null      ┆ 173.17803 ┆ 152.49441 ┆ 0.499953 │\n│           ┆           ┆ 4         ┆           ┆   ┆           ┆ 8         ┆           ┆          │\n│ min       ┆ 0000139e- ┆ 0.0       ┆ 0.0       ┆ … ┆ A._Walton ┆ 90.0      ┆ 98.0      ┆ 0.0      │\n│           ┆ 21dc-4d0c ┆           ┆           ┆   ┆           ┆           ┆           ┆          │\n│           ┆ -bfe1-4ca ┆           ┆           ┆   ┆           ┆           ┆           ┆          │\n│           ┆ e3c…      ┆           ┆           ┆   ┆           ┆           ┆           ┆          │\n│ 25%       ┆ null      ┆ 115.0     ┆ 99.0      ┆ … ┆ null      ┆ 800.0     ┆ 639.0     ┆ 0.0      │\n│ 50%       ┆ null      ┆ 205.0     ┆ 149.0     ┆ … ┆ null      ┆ 1024.0    ┆ 683.0     ┆ 0.0      │\n│ 75%       ┆ null      ┆ 315.0     ┆ 208.0     ┆ … ┆ null      ┆ 1024.0    ┆ 780.0     ┆ 1.0      │\n│ max       ┆ fffff3a5- ┆ 837.0     ┆ 799.0     ┆ … ┆ www.burly ┆ 1024.0    ┆ 1024.0    ┆ 1.0      │\n│           ┆ 2a75-47d0 ┆           ┆           ┆   ┆ bird.com  ┆           ┆           ┆          │\n│           ┆ -887f-038 ┆           ┆           ┆   ┆           ┆           ┆           ┆          │\n│           ┆ 71e…      ┆           ┆           ┆   ┆           ┆           ┆           ┆          │\n└───────────┴───────────┴───────────┴───────────┴───┴───────────┴───────────┴───────────┴──────────┘\n```\n:::\n:::\n\n\n## Create a training DataFrame\n\nNow we can get a subset of our metadata DataFrame with the training metadata data only:\n\n::: {#68c45554 .cell execution_count=15}\n``` {.python .cell-code}\nmetadata_train = metadata.filter(pl.col(\"is_training_img\") == 1)\n```\n:::\n\n\nQuick sanity checks:\n\n::: {#f5ab6018 .cell execution_count=16}\n``` {.python .cell-code}\nprint(metadata_train.shape)\nprint(metadata_train.row(0))\nprint(metadata_train.columns)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n(23929, 12)\n('0001afd4-99a1-4a67-b940-d419413e23b3', 307, 179, 492, 224, 645, 'Eared_Grebe_(Nonbreeding/juvenile)', '0645/0001afd499a14a67b940d419413e23b3.jpg', 'Laura_Erickson', 1024, 680, 1)\n['UUID', 'bb_x', 'bb_y', 'bb_width', 'bb_height', 'class', 'id', 'path', 'photographer', 'img_width', 'img_height', 'is_training_img']\n```\n:::\n:::\n\n\nOur metadata is ready. We can now start working with the pictures.\n\n",
    "supporting": [
      "jxai_metadata_files"
    ],
    "filters": [],
    "includes": {}
  }
}
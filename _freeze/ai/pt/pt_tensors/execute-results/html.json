{
  "hash": "0d94394beab3c624ff5c21ca6151e050",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: PyTorch tensors\naliases:\n  - tensors.html\nauthor: Marie-Hélène Burle\n---\n\n:::{.def}\n\nBefore information can be processed by algorithms, it needs to be converted to floating point numbers. Indeed, you don't pass a sentence or an image through a model; instead you input numbers representing a sequence of words or pixel values.\n\nAll these floating point numbers need to be stored in a data structure. The most suited structure is multidimensional (to hold several layers of information) and homogeneous—all data of the same type—for efficiency.\n\nPython already has several multidimensional array structures (e.g. [NumPy](https://numpy.org/)'s ndarray) but the particularities of deep learning call for special characteristics such as the ability to run operations on GPUs and/or in a distributed fashion, the ability to keep track of computation graphs for [automatic differentiation](https://en.wikipedia.org/wiki/Automatic_differentiation), and different defaults (lower precision for improved training performance).\n\nThe PyTorch tensor is a Python data structure with these characteristics that can easily be converted to/from NumPy's ndarray and integrates well with other Python libraries such as [Pandas](https://pandas.pydata.org/).\n\nIn this section, we will explore the basics of PyTorch tensors.\n\n:::\n\n## Importing PyTorch\n\nFirst of all, we need to import the `torch` library:\n\n::: {#15bca15c .cell execution_count=2}\n``` {.python .cell-code}\nimport torch\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">ModuleNotFoundError</span>                       Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[1], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">import</span><span style=\"color:rgb(188,188,188)\"> </span><span style=\"font-weight:bold;color:rgb(0,0,255)\">torch</span>\n\n<span class=\"ansi-red-fg ansi-bold\">ModuleNotFoundError</span>: No module named 'torch'</pre>\n```\n:::\n\n:::\n:::\n\n\nWe can check its version with:\n\n::: {#f6f5906e .cell execution_count=3}\n``` {.python .cell-code}\ntorch.__version__\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[2], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>__version__\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n## Creating tensors\n\nThere are many ways to create tensors:\n\n- `torch.tensor`: &emsp;&emsp;Input individual values\n- `torch.arange`: &emsp;&emsp;1D tensor with a sequence of integers\n- `torch.linspace`: &emsp;1D linear scale tensor\n- `torch.logspace`: &emsp;1D log scale tensor\n- `torch.rand`: &emsp;&emsp;&emsp;&nbsp;Random numbers from a uniform distribution on `[0, 1)`\n- `torch.randn`: &emsp;&emsp;&ensp;&nbsp;Numbers from the standard normal distribution\n- `torch.randperm`: &emsp;&nbsp;Random permutation of integers\n- `torch.empty`: &emsp;&emsp;&ensp;&nbsp;Uninitialized tensor\n- `torch.zeros`: &emsp;&emsp;&ensp;&nbsp;Tensor filled with `0`\n- `torch.ones`: &emsp;&emsp;&emsp;&nbsp;Tensor filled with `1`\n- `torch.eye`: &emsp;&emsp;&emsp;&ensp;&nbsp;&nbsp;Identity matrix\n\n### From input values\n\n::: {#1338bdf4 .cell execution_count=4}\n``` {.python .cell-code}\nt = torch.tensor(3)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[3], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> t <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>tensor(<span style=\"color:rgb(98,98,98)\">3</span>)\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n:::{.exo}\n\n:::{.yourturn}\n\nYour turn:\n\n:::\n\nWithout using the `shape` descriptor, try to get the shape of the following tensors:\n\n```{.python}\ntorch.tensor([0.9704, 0.1339, 0.4841])\n\ntorch.tensor([[0.9524, 0.0354],\n        [0.9833, 0.2562],\n        [0.0607, 0.6420]])\n\ntorch.tensor([[[0.4604, 0.2699],\n         [0.8360, 0.0317],\n         [0.3289, 0.1171]]])\n\ntorch.tensor([[[[0.0730, 0.8737],\n          [0.2305, 0.4719],\n          [0.0796, 0.2745]]],\n\n        [[[0.1534, 0.9442],\n          [0.3287, 0.9040],\n          [0.0948, 0.1480]]]])\n```\n\n:::\n\nLet's create a random tensor with a single element:\n\n::: {#30bd62a4 .cell execution_count=5}\n``` {.python .cell-code}\nt = torch.rand(1)\nt\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[4], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> t <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>rand(<span style=\"color:rgb(98,98,98)\">1</span>)\n<span class=\"ansi-green-fg\">      2</span> t\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nWe can extract the value from a tensor with one element:\n\n::: {#ee4b8ff9 .cell execution_count=6}\n``` {.python .cell-code}\nt.item()\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[5], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">t</span><span style=\"color:rgb(98,98,98)\">.</span>item()\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 't' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nAll these tensors have a single element, but an increasing number of dimensions:\n\n::: {#aa143343 .cell execution_count=7}\n``` {.python .cell-code}\ntorch.rand(1)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[6], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>rand(<span style=\"color:rgb(98,98,98)\">1</span>)\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#455ee270 .cell execution_count=8}\n``` {.python .cell-code}\ntorch.rand(1, 1)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[7], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>rand(<span style=\"color:rgb(98,98,98)\">1</span>, <span style=\"color:rgb(98,98,98)\">1</span>)\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#48e18ae3 .cell execution_count=9}\n``` {.python .cell-code}\ntorch.rand(1, 1, 1)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[8], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>rand(<span style=\"color:rgb(98,98,98)\">1</span>, <span style=\"color:rgb(98,98,98)\">1</span>, <span style=\"color:rgb(98,98,98)\">1</span>)\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#4d7c9373 .cell execution_count=10}\n``` {.python .cell-code}\ntorch.rand(1, 1, 1, 1)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[9], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>rand(<span style=\"color:rgb(98,98,98)\">1</span>, <span style=\"color:rgb(98,98,98)\">1</span>, <span style=\"color:rgb(98,98,98)\">1</span>, <span style=\"color:rgb(98,98,98)\">1</span>)\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n:::{.note}\n\nYou can tell the number of dimensions of a tensor easily by counting the number of opening square brackets.\n\n:::\n\n::: {#e39df9e9 .cell execution_count=11}\n``` {.python .cell-code}\ntorch.rand(1, 1, 1, 1).dim()\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[10], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>rand(<span style=\"color:rgb(98,98,98)\">1</span>, <span style=\"color:rgb(98,98,98)\">1</span>, <span style=\"color:rgb(98,98,98)\">1</span>, <span style=\"color:rgb(98,98,98)\">1</span>)<span style=\"color:rgb(98,98,98)\">.</span>dim()\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nTensors can have multiple elements in one dimension:\n\n::: {#acc8d5f5 .cell execution_count=12}\n``` {.python .cell-code}\ntorch.rand(6)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[11], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>rand(<span style=\"color:rgb(98,98,98)\">6</span>)\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#014fd249 .cell execution_count=13}\n``` {.python .cell-code}\ntorch.rand(6).dim()\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[12], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>rand(<span style=\"color:rgb(98,98,98)\">6</span>)<span style=\"color:rgb(98,98,98)\">.</span>dim()\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nAnd multiple elements in multiple dimensions:\n\n::: {#817db78c .cell execution_count=14}\n``` {.python .cell-code}\ntorch.rand(2, 3, 4, 5)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[13], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>rand(<span style=\"color:rgb(98,98,98)\">2</span>, <span style=\"color:rgb(98,98,98)\">3</span>, <span style=\"color:rgb(98,98,98)\">4</span>, <span style=\"color:rgb(98,98,98)\">5</span>)\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#dfc69685 .cell execution_count=15}\n``` {.python .cell-code}\ntorch.rand(2, 3, 4, 5).dim()\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[14], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>rand(<span style=\"color:rgb(98,98,98)\">2</span>, <span style=\"color:rgb(98,98,98)\">3</span>, <span style=\"color:rgb(98,98,98)\">4</span>, <span style=\"color:rgb(98,98,98)\">5</span>)<span style=\"color:rgb(98,98,98)\">.</span>dim()\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#5e7289ab .cell execution_count=16}\n``` {.python .cell-code}\ntorch.rand(2, 3, 4, 5).numel()\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[15], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>rand(<span style=\"color:rgb(98,98,98)\">2</span>, <span style=\"color:rgb(98,98,98)\">3</span>, <span style=\"color:rgb(98,98,98)\">4</span>, <span style=\"color:rgb(98,98,98)\">5</span>)<span style=\"color:rgb(98,98,98)\">.</span>numel()\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#b07ef16f .cell execution_count=17}\n``` {.python .cell-code}\ntorch.ones(2, 4)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[16], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>ones(<span style=\"color:rgb(98,98,98)\">2</span>, <span style=\"color:rgb(98,98,98)\">4</span>)\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#ed9a98ab .cell execution_count=18}\n``` {.python .cell-code}\nt = torch.rand(2, 3)\ntorch.zeros_like(t)             # Matches the size of t\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[17], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> t <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>rand(<span style=\"color:rgb(98,98,98)\">2</span>, <span style=\"color:rgb(98,98,98)\">3</span>)\n<span class=\"ansi-green-fg\">      2</span> torch<span style=\"color:rgb(98,98,98)\">.</span>zeros_like(t)             <span style=\"font-style:italic;color:rgb(95,135,135)\"># Matches the size of t</span>\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#4088e057 .cell execution_count=19}\n``` {.python .cell-code}\ntorch.ones_like(t)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[18], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>ones_like(t)\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#a106a3f2 .cell execution_count=20}\n``` {.python .cell-code}\ntorch.randn_like(t)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[19], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>randn_like(t)\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#bf472547 .cell execution_count=21}\n``` {.python .cell-code}\ntorch.arange(2, 10, 3)    # From 2 to 10 in increments of 3\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[20], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>arange(<span style=\"color:rgb(98,98,98)\">2</span>, <span style=\"color:rgb(98,98,98)\">10</span>, <span style=\"color:rgb(98,98,98)\">3</span>)    <span style=\"font-style:italic;color:rgb(95,135,135)\"># From 2 to 10 in increments of 3</span>\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#d1448b3d .cell execution_count=22}\n``` {.python .cell-code}\ntorch.linspace(2, 10, 3)  # 3 elements from 2 to 10 on the linear scale\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[21], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>linspace(<span style=\"color:rgb(98,98,98)\">2</span>, <span style=\"color:rgb(98,98,98)\">10</span>, <span style=\"color:rgb(98,98,98)\">3</span>)  <span style=\"font-style:italic;color:rgb(95,135,135)\"># 3 elements from 2 to 10 on the linear scale</span>\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#ad20d826 .cell execution_count=23}\n``` {.python .cell-code}\ntorch.logspace(2, 10, 3)  # Same on the log scale\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[22], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>logspace(<span style=\"color:rgb(98,98,98)\">2</span>, <span style=\"color:rgb(98,98,98)\">10</span>, <span style=\"color:rgb(98,98,98)\">3</span>)  <span style=\"font-style:italic;color:rgb(95,135,135)\"># Same on the log scale</span>\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#cd33e3f9 .cell execution_count=24}\n``` {.python .cell-code}\ntorch.randperm(3)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[23], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>randperm(<span style=\"color:rgb(98,98,98)\">3</span>)\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#748c2350 .cell execution_count=25}\n``` {.python .cell-code}\ntorch.eye(3)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[24], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>eye(<span style=\"color:rgb(98,98,98)\">3</span>)\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n## Conversion to/from NumPy\n\nPyTorch tensors can be converted to NumPy ndarrays and vice-versa in a very efficient manner as both objects share the same memory.\n\n### From PyTorch tensor to NumPy ndarray\n\n::: {#7d1bec16 .cell execution_count=26}\n``` {.python .cell-code}\nt = torch.rand(2, 3)\nt\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[25], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> t <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>rand(<span style=\"color:rgb(98,98,98)\">2</span>, <span style=\"color:rgb(98,98,98)\">3</span>)\n<span class=\"ansi-green-fg\">      2</span> t\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#0ad59932 .cell execution_count=27}\n``` {.python .cell-code}\nt_np = t.numpy()\nt_np\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[26], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> t_np <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">t</span><span style=\"color:rgb(98,98,98)\">.</span>numpy()\n<span class=\"ansi-green-fg\">      2</span> t_np\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 't' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n### From NumPy ndarray to PyTorch tensor\n\n::: {#2ace89ed .cell execution_count=28}\n``` {.python .cell-code}\nimport numpy as np\na = np.random.rand(2, 3)\na\n```\n\n::: {.cell-output .cell-output-display execution_count=27}\n```\narray([[0.7481594 , 0.24402294, 0.4489833 ],\n       [0.28421414, 0.9294617 , 0.78154845]])\n```\n:::\n:::\n\n\n::: {#811b9195 .cell execution_count=29}\n``` {.python .cell-code}\na_pt = torch.from_numpy(a)\na_pt\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[28], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> a_pt <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>from_numpy(a)\n<span class=\"ansi-green-fg\">      2</span> a_pt\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n:::{.note}\n\nNote the different default data types.\n\n:::\n\n## Indexing tensors\n\n::: {#3d8501a0 .cell execution_count=30}\n``` {.python .cell-code}\nt = torch.rand(3, 4)\nt\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[29], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> t <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>rand(<span style=\"color:rgb(98,98,98)\">3</span>, <span style=\"color:rgb(98,98,98)\">4</span>)\n<span class=\"ansi-green-fg\">      2</span> t\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#b4388c90 .cell execution_count=31}\n``` {.python .cell-code}\nt[:, 2]\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[30], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">t</span>[:, <span style=\"color:rgb(98,98,98)\">2</span>]\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 't' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#0278482b .cell execution_count=32}\n``` {.python .cell-code}\nt[1, :]\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[31], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">t</span>[<span style=\"color:rgb(98,98,98)\">1</span>, :]\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 't' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#f6c40dbe .cell execution_count=33}\n``` {.python .cell-code}\nt[2, 3]\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[32], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">t</span>[<span style=\"color:rgb(98,98,98)\">2</span>, <span style=\"color:rgb(98,98,98)\">3</span>]\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 't' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n:::{.info}\n\n**A word of caution about indexing**\n\nWhile indexing elements of a tensor to extract some of the data as a final step of some computation is fine, [you should not use indexing to run operations on tensor elements in a loop]{.emph} as this would be extremely inefficient.\n\nInstead, you want to use [vectorized operations]{.emph}.\n\n:::\n\n## Vectorized operations\n\nSince PyTorch tensors are homogeneous (i.e. made of a single data type), [as with NumPy's ndarrays](https://www.pythonlikeyoumeanit.com/Module3_IntroducingNumpy/VectorizedOperations.html#Vectorized-Operations), operations are vectorized and thus fast.\n\nNumPy is mostly written in C, PyTorch in C++. With either library, when you run vectorized operations on arrays/tensors, you don't use raw Python (slow) but compiled C/C++ code (much faster).\n\n[Here](https://pythonspeed.com/articles/vectorization-python/) is an excellent post explaining Python vectorization & why it makes such a big difference.\n\n## Data types\n\n### Default data type\n\nSince PyTorch tensors were built with efficiency in mind for neural networks, the default data type is **32-bit floating points**.\n\nThis is sufficient for accuracy and much faster than 64-bit floating points.\n\n:::{.note}\n\nBy contrast, NumPy ndarrays use 64-bit as their default.\n\n:::\n\n::: {#b31c6a73 .cell execution_count=34}\n``` {.python .cell-code}\nt = torch.rand(2, 4)\nt.dtype\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[33], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> t <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>rand(<span style=\"color:rgb(98,98,98)\">2</span>, <span style=\"color:rgb(98,98,98)\">4</span>)\n<span class=\"ansi-green-fg\">      2</span> t<span style=\"color:rgb(98,98,98)\">.</span>dtype\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n### Setting data type at creation\n\nThe type can be set with the `dtype` argument:\n\n::: {#a9f9e02d .cell execution_count=35}\n``` {.python .cell-code}\nt = torch.rand(2, 4, dtype=torch.float64)\nt\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[34], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> t <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>rand(<span style=\"color:rgb(98,98,98)\">2</span>, <span style=\"color:rgb(98,98,98)\">4</span>, dtype<span style=\"color:rgb(98,98,98)\">=</span>torch<span style=\"color:rgb(98,98,98)\">.</span>float64)\n<span class=\"ansi-green-fg\">      2</span> t\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n:::{.note}\n\nPrinted tensors display attributes with values ≠ default values.\n\n:::\n\n::: {#9ad03e64 .cell execution_count=36}\n``` {.python .cell-code}\nt.dtype\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[35], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">t</span><span style=\"color:rgb(98,98,98)\">.</span>dtype\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 't' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n### Changing data type\n\n::: {#dceca36f .cell execution_count=37}\n``` {.python .cell-code}\nt = torch.rand(2, 4)\nt.dtype\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[36], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> t <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>rand(<span style=\"color:rgb(98,98,98)\">2</span>, <span style=\"color:rgb(98,98,98)\">4</span>)\n<span class=\"ansi-green-fg\">      2</span> t<span style=\"color:rgb(98,98,98)\">.</span>dtype\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#83dbaa17 .cell execution_count=38}\n``` {.python .cell-code}\nt2 = t.type(torch.float64)\nt2.dtype\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[37], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> t2 <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">t</span><span style=\"color:rgb(98,98,98)\">.</span>type(torch<span style=\"color:rgb(98,98,98)\">.</span>float64)\n<span class=\"ansi-green-fg\">      2</span> t2<span style=\"color:rgb(98,98,98)\">.</span>dtype\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 't' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n### List of data types\n\n| dtype | Description |\n| ----- | ----- |\n| torch.float16 / torch.half | 16-bit / half-precision floating-point |\n| torch.float32 / torch.float | 32-bit / single-precision floating-point |\n| torch.float64 / torch.double | 64-bit / double-precision floating-point |\n| torch.uint8 | unsigned 8-bit integers |\n| torch.int8 | signed 8-bit integers |\n| torch.int16 / torch.short | signed 16-bit integers |\n| torch.int32 / torch.int | signed 32-bit integers |\n| torch.int64 / torch.long | signed 64-bit integers |\n| torch.bool | boolean |\n\n## Simple operations\n\n::: {#d9fd303f .cell execution_count=39}\n``` {.python .cell-code}\nt1 = torch.tensor([[1, 2], [3, 4]])\nt1\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[38], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> t1 <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>tensor([[<span style=\"color:rgb(98,98,98)\">1</span>, <span style=\"color:rgb(98,98,98)\">2</span>], [<span style=\"color:rgb(98,98,98)\">3</span>, <span style=\"color:rgb(98,98,98)\">4</span>]])\n<span class=\"ansi-green-fg\">      2</span> t1\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#a5948af4 .cell execution_count=40}\n``` {.python .cell-code}\nt2 = torch.tensor([[1, 1], [0, 0]])\nt2\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[39], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> t2 <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>tensor([[<span style=\"color:rgb(98,98,98)\">1</span>, <span style=\"color:rgb(98,98,98)\">1</span>], [<span style=\"color:rgb(98,98,98)\">0</span>, <span style=\"color:rgb(98,98,98)\">0</span>]])\n<span class=\"ansi-green-fg\">      2</span> t2\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nOperation performed between elements at corresponding locations:\n\n::: {#e8c217e0 .cell execution_count=41}\n``` {.python .cell-code}\nt1 + t2\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[40], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">t1</span> <span style=\"color:rgb(98,98,98)\">+</span> t2\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 't1' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nOperation applied to each element of the tensor:\n\n::: {#24b9bbfb .cell execution_count=42}\n``` {.python .cell-code}\nt1 + 1\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[41], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">t1</span> <span style=\"color:rgb(98,98,98)\">+</span> <span style=\"color:rgb(98,98,98)\">1</span>\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 't1' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n### Reduction\n\n::: {#702a7278 .cell execution_count=43}\n``` {.python .cell-code}\nt = torch.ones(2, 3, 4);\nt\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[42], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> t <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>ones(<span style=\"color:rgb(98,98,98)\">2</span>, <span style=\"color:rgb(98,98,98)\">3</span>, <span style=\"color:rgb(98,98,98)\">4</span>);\n<span class=\"ansi-green-fg\">      2</span> t\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#11a2bf90 .cell execution_count=44}\n``` {.python .cell-code}\nt.sum()   # Reduction over all entries\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[43], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">t</span><span style=\"color:rgb(98,98,98)\">.</span>sum()   <span style=\"font-style:italic;color:rgb(95,135,135)\"># Reduction over all entries</span>\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 't' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n:::{.note}\n\nOther reduction functions (e.g. mean) behave the same way.\n\n:::\n\nReduction over a specific dimension:\n\n::: {#e3ac1c50 .cell execution_count=45}\n``` {.python .cell-code}\nt.sum(0)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[44], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">t</span><span style=\"color:rgb(98,98,98)\">.</span>sum(<span style=\"color:rgb(98,98,98)\">0</span>)\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 't' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#28bb11ec .cell execution_count=46}\n``` {.python .cell-code}\nt.sum(1)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[45], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">t</span><span style=\"color:rgb(98,98,98)\">.</span>sum(<span style=\"color:rgb(98,98,98)\">1</span>)\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 't' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#f20e14c2 .cell execution_count=47}\n``` {.python .cell-code}\nt.sum(2)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[46], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">t</span><span style=\"color:rgb(98,98,98)\">.</span>sum(<span style=\"color:rgb(98,98,98)\">2</span>)\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 't' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nReduction over multiple dimensions:\n\n::: {#d24f596e .cell execution_count=48}\n``` {.python .cell-code}\nt.sum((0, 1))\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[47], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">t</span><span style=\"color:rgb(98,98,98)\">.</span>sum((<span style=\"color:rgb(98,98,98)\">0</span>, <span style=\"color:rgb(98,98,98)\">1</span>))\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 't' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#34e39705 .cell execution_count=49}\n``` {.python .cell-code}\nt.sum((0, 2))\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[48], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">t</span><span style=\"color:rgb(98,98,98)\">.</span>sum((<span style=\"color:rgb(98,98,98)\">0</span>, <span style=\"color:rgb(98,98,98)\">2</span>))\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 't' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#32e7550b .cell execution_count=50}\n``` {.python .cell-code}\nt.sum((1, 2))\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[49], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">t</span><span style=\"color:rgb(98,98,98)\">.</span>sum((<span style=\"color:rgb(98,98,98)\">1</span>, <span style=\"color:rgb(98,98,98)\">2</span>))\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 't' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n### In-place operations\n\nWith operators post-fixed with `_`:\n\n::: {#4dd00ec0 .cell execution_count=51}\n``` {.python .cell-code}\nt1 = torch.tensor([1, 2])\nt1\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[50], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> t1 <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>tensor([<span style=\"color:rgb(98,98,98)\">1</span>, <span style=\"color:rgb(98,98,98)\">2</span>])\n<span class=\"ansi-green-fg\">      2</span> t1\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#bbe440a3 .cell execution_count=52}\n``` {.python .cell-code}\nt2 = torch.tensor([1, 1])\nt2\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[51], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> t2 <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>tensor([<span style=\"color:rgb(98,98,98)\">1</span>, <span style=\"color:rgb(98,98,98)\">1</span>])\n<span class=\"ansi-green-fg\">      2</span> t2\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#0f64913a .cell execution_count=53}\n``` {.python .cell-code}\nt1.add_(t2)\nt1\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[52], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">t1</span><span style=\"color:rgb(98,98,98)\">.</span>add_(t2)\n<span class=\"ansi-green-fg\">      2</span> t1\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 't1' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#11cd133e .cell execution_count=54}\n``` {.python .cell-code}\nt1.zero_()\nt1\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[53], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">t1</span><span style=\"color:rgb(98,98,98)\">.</span>zero_()\n<span class=\"ansi-green-fg\">      2</span> t1\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 't1' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n:::{.note}\n\nWhile reassignments will use new addresses in memory, in-place operations will use the same addresses.\n\n:::\n\n### Tensor views\n\n```{.python}\nt = torch.tensor([[1, 2, 3], [4, 5, 6]]); print(t)\nt.size()\nt.view(6)\nt.view(3, 2)\nt.view(3, -1) # Same: with -1, the size is inferred from other dimensions\n```\n\n:::{.info}\n\n**Note the difference**\n\n::: {#86e82748 .cell execution_count=55}\n``` {.python .cell-code}\nt1 = torch.tensor([[1, 2, 3], [4, 5, 6]])\nt1\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[54], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> t1 <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>tensor([[<span style=\"color:rgb(98,98,98)\">1</span>, <span style=\"color:rgb(98,98,98)\">2</span>, <span style=\"color:rgb(98,98,98)\">3</span>], [<span style=\"color:rgb(98,98,98)\">4</span>, <span style=\"color:rgb(98,98,98)\">5</span>, <span style=\"color:rgb(98,98,98)\">6</span>]])\n<span class=\"ansi-green-fg\">      2</span> t1\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#f59fffa9 .cell execution_count=56}\n``` {.python .cell-code}\nt2 = t1.t()\nt2\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[55], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> t2 <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">t1</span><span style=\"color:rgb(98,98,98)\">.</span>t()\n<span class=\"ansi-green-fg\">      2</span> t2\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 't1' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#bb33c677 .cell execution_count=57}\n``` {.python .cell-code}\nt3 = t1.view(3, 2)\nt3\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[56], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> t3 <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">t1</span><span style=\"color:rgb(98,98,98)\">.</span>view(<span style=\"color:rgb(98,98,98)\">3</span>, <span style=\"color:rgb(98,98,98)\">2</span>)\n<span class=\"ansi-green-fg\">      2</span> t3\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 't1' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n:::\n\n### Logical operations\n\n::: {#0eafb585 .cell execution_count=58}\n``` {.python .cell-code}\nt1 = torch.randperm(5)\nt1\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[57], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> t1 <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>randperm(<span style=\"color:rgb(98,98,98)\">5</span>)\n<span class=\"ansi-green-fg\">      2</span> t1\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#54f6c8ce .cell execution_count=59}\n``` {.python .cell-code}\nt2 = torch.randperm(5)\nt2\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[58], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> t2 <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">torch</span><span style=\"color:rgb(98,98,98)\">.</span>randperm(<span style=\"color:rgb(98,98,98)\">5</span>)\n<span class=\"ansi-green-fg\">      2</span> t2\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'torch' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nTest each element:\n\n::: {#13b4e606 .cell execution_count=60}\n``` {.python .cell-code}\nt1 > 3\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[59], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">t1</span> <span style=\"color:rgb(98,98,98)\">&gt;</span> <span style=\"color:rgb(98,98,98)\">3</span>\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 't1' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nTest corresponding pairs of elements:\n\n::: {#f2d20c89 .cell execution_count=61}\n``` {.python .cell-code}\nt1 < t2\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[60], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">t1</span> <span style=\"color:rgb(98,98,98)\">&lt;</span> t2\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 't1' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n## Device attribute\n\nTensor data can be placed in the memory of various processor types:\n\n- the RAM of CPU,\n- the RAM of a GPU with CUDA support,\n- the RAM of a GPU with [AMD's ROCm support](https://pytorch.org/blog/pytorch-for-amd-rocm-platform-now-available-as-python-package/),\n- the RAM of an [XLA device](https://www.tensorflow.org/xla) (e.g. [Cloud TPU](https://cloud.google.com/tpu)) with the [torch_xla package](https://github.com/pytorch/xla/).\n\nThe values for the device attributes are:\n\n- CPU: &nbsp;`'cpu'`,\n- GPU (CUDA & AMD's ROCm): &nbsp;`'cuda'`,\n- XLA: &nbsp;`xm.xla_device()`.\n\nThis last option requires to load the [torch_xla package](https://github.com/pytorch/xla/) first:\n\n```{.python}\nimport torch_xla\nimport torch_xla.core.xla_model as xm\n```\n\n### Creating a tensor on a specific device\n\nBy default, tensors are created on the CPU.\n\nYou can create a tensor on an accelerator by specifying the device attribute (our current training cluster does not have GPUs, so don't run this on it):\n\n```{.python}\nt_gpu = torch.rand(2, device='cuda')\n```\n\n### Copying a tensor to a specific device\n\nYou can also make copies of a tensor on other devices:\n\n```{.python}\n# Make a copy of t on the GPU\nt_gpu = t.to(device='cuda')\nt_gpu = t.cuda()             # Alternative syntax\n\n# Make a copy of t_gpu on the CPU\nt = t_gpu.to(device='cpu')\nt = t_gpu.cpu()              # Alternative syntax\n```\n\n### Multiple GPUs\n\nIf you have multiple GPUs, you can optionally specify which one a tensor should be created on or copied to:\n\n```{.python}\nt1 = torch.rand(2, device='cuda:0')  # Create a tensor on 1st GPU\nt2 = t1.to(device='cuda:0')          # Make a copy of t1 on 1st GPU\nt3 = t1.to(device='cuda:1')          # Make a copy of t1 on 2nd GPU\n```\n\nOr the equivalent short forms:\n\n```{.python}\nt2 = t1.cuda(0)\nt3 = t1.cuda(1)\n```\n\n",
    "supporting": [
      "pt_tensors_files/figure-html"
    ],
    "filters": [],
    "includes": {}
  }
}
{
  "hash": "bba572eab9626d11d6d7d7e65d02f32e",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: DataFrames with Polars\nauthor: Marie-Hélène Burle\n---\n\n\n:::{.def}\n\n[Polars](https://pola.rs/) is a Python library built to manipulate data frames and time series.\n\n:::\n\nFor this section, we will use the Covid-19 data from the [Johns Hopkins University CSSE repository](https://github.com/CSSEGISandData/COVID-19).\n\nYou can visualize this data in [a dashboard](https://www.arcgis.com/apps/dashboards/bda7594740fd40299423467b48e9ecf6) created by the Johns Hopkins University Center for Systems Science and Engineering.\n\n## Setup\n\nFirst, we need to load the `polars` library and read in the data from the web:\n\n::: {#ea0f5eb2 .cell execution_count=1}\n``` {.python .cell-code}\n# Load the Polars library and create a shorter name for it\nimport polars as pl\n\n# The global confirmed cases are available in CSV format at the url:\nurl = \"https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv\"\n\n# Polars allows to read in data from the web directly\ncases = pl.read_csv(url)\n```\n:::\n\n\n## First look at the data\n\nWhat does our data look like?\n\n::: {#3b76352d .cell execution_count=2}\n``` {.python .cell-code}\ncases\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (289, 1_147)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>Province/State</th><th>Country/Region</th><th>Lat</th><th>Long</th><th>1/22/20</th><th>1/23/20</th><th>1/24/20</th><th>1/25/20</th><th>1/26/20</th><th>1/27/20</th><th>1/28/20</th><th>1/29/20</th><th>1/30/20</th><th>1/31/20</th><th>2/1/20</th><th>2/2/20</th><th>2/3/20</th><th>2/4/20</th><th>2/5/20</th><th>2/6/20</th><th>2/7/20</th><th>2/8/20</th><th>2/9/20</th><th>2/10/20</th><th>2/11/20</th><th>2/12/20</th><th>2/13/20</th><th>2/14/20</th><th>2/15/20</th><th>2/16/20</th><th>2/17/20</th><th>2/18/20</th><th>2/19/20</th><th>2/20/20</th><th>2/21/20</th><th>2/22/20</th><th>2/23/20</th><th>&hellip;</th><th>2/1/23</th><th>2/2/23</th><th>2/3/23</th><th>2/4/23</th><th>2/5/23</th><th>2/6/23</th><th>2/7/23</th><th>2/8/23</th><th>2/9/23</th><th>2/10/23</th><th>2/11/23</th><th>2/12/23</th><th>2/13/23</th><th>2/14/23</th><th>2/15/23</th><th>2/16/23</th><th>2/17/23</th><th>2/18/23</th><th>2/19/23</th><th>2/20/23</th><th>2/21/23</th><th>2/22/23</th><th>2/23/23</th><th>2/24/23</th><th>2/25/23</th><th>2/26/23</th><th>2/27/23</th><th>2/28/23</th><th>3/1/23</th><th>3/2/23</th><th>3/3/23</th><th>3/4/23</th><th>3/5/23</th><th>3/6/23</th><th>3/7/23</th><th>3/8/23</th><th>3/9/23</th></tr><tr><td>str</td><td>str</td><td>f64</td><td>f64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>&hellip;</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td></tr></thead><tbody><tr><td>null</td><td>&quot;Afghanistan&quot;</td><td>33.93911</td><td>67.709953</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>&hellip;</td><td>208552</td><td>208669</td><td>208669</td><td>208621</td><td>208627</td><td>208704</td><td>208721</td><td>208771</td><td>208771</td><td>208943</td><td>208971</td><td>208982</td><td>209011</td><td>209036</td><td>209056</td><td>209072</td><td>209083</td><td>209084</td><td>209107</td><td>209153</td><td>209181</td><td>209181</td><td>209215</td><td>209230</td><td>209246</td><td>209274</td><td>209308</td><td>209322</td><td>209340</td><td>209358</td><td>209362</td><td>209369</td><td>209390</td><td>209406</td><td>209436</td><td>209451</td><td>209451</td></tr><tr><td>null</td><td>&quot;Albania&quot;</td><td>41.1533</td><td>20.1683</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>&hellip;</td><td>334177</td><td>334187</td><td>334203</td><td>334204</td><td>334211</td><td>334211</td><td>334211</td><td>334222</td><td>334229</td><td>334229</td><td>334234</td><td>334255</td><td>334255</td><td>334264</td><td>334264</td><td>334273</td><td>334291</td><td>334305</td><td>334314</td><td>334315</td><td>334336</td><td>334336</td><td>334345</td><td>334356</td><td>334373</td><td>334378</td><td>334380</td><td>334391</td><td>334408</td><td>334408</td><td>334427</td><td>334427</td><td>334427</td><td>334427</td><td>334427</td><td>334443</td><td>334457</td></tr><tr><td>null</td><td>&quot;Algeria&quot;</td><td>28.0339</td><td>1.6596</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>&hellip;</td><td>271385</td><td>271386</td><td>271394</td><td>271394</td><td>271394</td><td>271395</td><td>271399</td><td>271403</td><td>271406</td><td>271406</td><td>271409</td><td>271409</td><td>271409</td><td>271409</td><td>271421</td><td>271424</td><td>271424</td><td>271425</td><td>271425</td><td>271426</td><td>271428</td><td>271431</td><td>271432</td><td>271436</td><td>271439</td><td>271440</td><td>271440</td><td>271441</td><td>271448</td><td>271463</td><td>271469</td><td>271469</td><td>271477</td><td>271477</td><td>271490</td><td>271494</td><td>271496</td></tr><tr><td>null</td><td>&quot;Andorra&quot;</td><td>42.5063</td><td>1.5218</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>&hellip;</td><td>47839</td><td>47839</td><td>47850</td><td>47850</td><td>47850</td><td>47850</td><td>47850</td><td>47850</td><td>47860</td><td>47860</td><td>47860</td><td>47860</td><td>47860</td><td>47860</td><td>47860</td><td>47866</td><td>47866</td><td>47866</td><td>47866</td><td>47866</td><td>47866</td><td>47866</td><td>47866</td><td>47866</td><td>47866</td><td>47866</td><td>47866</td><td>47866</td><td>47875</td><td>47875</td><td>47875</td><td>47875</td><td>47875</td><td>47875</td><td>47875</td><td>47890</td><td>47890</td></tr><tr><td>null</td><td>&quot;Angola&quot;</td><td>-11.2027</td><td>17.8739</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>&hellip;</td><td>105184</td><td>105184</td><td>105184</td><td>105184</td><td>105184</td><td>105184</td><td>105184</td><td>105184</td><td>105184</td><td>105184</td><td>105184</td><td>105184</td><td>105184</td><td>105184</td><td>105184</td><td>105184</td><td>105184</td><td>105184</td><td>105184</td><td>105184</td><td>105184</td><td>105205</td><td>105205</td><td>105205</td><td>105205</td><td>105205</td><td>105255</td><td>105255</td><td>105277</td><td>105277</td><td>105277</td><td>105277</td><td>105277</td><td>105277</td><td>105277</td><td>105288</td><td>105288</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>null</td><td>&quot;West Bank and Gaza&quot;</td><td>31.9522</td><td>35.2332</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>&hellip;</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td><td>703228</td></tr><tr><td>null</td><td>&quot;Winter Olympics 2022&quot;</td><td>39.9042</td><td>116.4074</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>&hellip;</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td><td>535</td></tr><tr><td>null</td><td>&quot;Yemen&quot;</td><td>15.552727</td><td>48.516388</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>&hellip;</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td><td>11945</td></tr><tr><td>null</td><td>&quot;Zambia&quot;</td><td>-13.133897</td><td>27.849332</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>&hellip;</td><td>340944</td><td>341261</td><td>341397</td><td>341573</td><td>341573</td><td>341690</td><td>341690</td><td>341936</td><td>342114</td><td>342114</td><td>342288</td><td>342288</td><td>342317</td><td>342317</td><td>342317</td><td>342317</td><td>342317</td><td>342317</td><td>342317</td><td>342724</td><td>342782</td><td>342831</td><td>342831</td><td>342831</td><td>342831</td><td>342831</td><td>342831</td><td>343012</td><td>343012</td><td>343079</td><td>343079</td><td>343079</td><td>343135</td><td>343135</td><td>343135</td><td>343135</td><td>343135</td></tr><tr><td>null</td><td>&quot;Zimbabwe&quot;</td><td>-19.015438</td><td>29.154857</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>&hellip;</td><td>262324</td><td>262324</td><td>262324</td><td>262324</td><td>262324</td><td>262324</td><td>262324</td><td>263083</td><td>263083</td><td>263083</td><td>263083</td><td>263083</td><td>263083</td><td>263083</td><td>263642</td><td>263642</td><td>263642</td><td>263642</td><td>263642</td><td>263642</td><td>263642</td><td>263921</td><td>263921</td><td>263921</td><td>263921</td><td>263921</td><td>263921</td><td>263921</td><td>264127</td><td>264127</td><td>264127</td><td>264127</td><td>264127</td><td>264127</td><td>264127</td><td>264276</td><td>264276</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n::: {#197e734e .cell execution_count=3}\n``` {.python .cell-code}\n# Quick summary of the data\ncases.describe()\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (9, 1_148)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>statistic</th><th>Province/State</th><th>Country/Region</th><th>Lat</th><th>Long</th><th>1/22/20</th><th>1/23/20</th><th>1/24/20</th><th>1/25/20</th><th>1/26/20</th><th>1/27/20</th><th>1/28/20</th><th>1/29/20</th><th>1/30/20</th><th>1/31/20</th><th>2/1/20</th><th>2/2/20</th><th>2/3/20</th><th>2/4/20</th><th>2/5/20</th><th>2/6/20</th><th>2/7/20</th><th>2/8/20</th><th>2/9/20</th><th>2/10/20</th><th>2/11/20</th><th>2/12/20</th><th>2/13/20</th><th>2/14/20</th><th>2/15/20</th><th>2/16/20</th><th>2/17/20</th><th>2/18/20</th><th>2/19/20</th><th>2/20/20</th><th>2/21/20</th><th>2/22/20</th><th>&hellip;</th><th>2/1/23</th><th>2/2/23</th><th>2/3/23</th><th>2/4/23</th><th>2/5/23</th><th>2/6/23</th><th>2/7/23</th><th>2/8/23</th><th>2/9/23</th><th>2/10/23</th><th>2/11/23</th><th>2/12/23</th><th>2/13/23</th><th>2/14/23</th><th>2/15/23</th><th>2/16/23</th><th>2/17/23</th><th>2/18/23</th><th>2/19/23</th><th>2/20/23</th><th>2/21/23</th><th>2/22/23</th><th>2/23/23</th><th>2/24/23</th><th>2/25/23</th><th>2/26/23</th><th>2/27/23</th><th>2/28/23</th><th>3/1/23</th><th>3/2/23</th><th>3/3/23</th><th>3/4/23</th><th>3/5/23</th><th>3/6/23</th><th>3/7/23</th><th>3/8/23</th><th>3/9/23</th></tr><tr><td>str</td><td>str</td><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>&hellip;</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;count&quot;</td><td>&quot;91&quot;</td><td>&quot;289&quot;</td><td>287.0</td><td>287.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>&hellip;</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td><td>289.0</td></tr><tr><td>&quot;null_count&quot;</td><td>&quot;198&quot;</td><td>&quot;0&quot;</td><td>2.0</td><td>2.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>&hellip;</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td></tr><tr><td>&quot;mean&quot;</td><td>null</td><td>null</td><td>19.718719</td><td>22.182084</td><td>1.927336</td><td>2.273356</td><td>3.266436</td><td>4.972318</td><td>7.33564</td><td>10.134948</td><td>19.307958</td><td>21.346021</td><td>28.50173</td><td>34.349481</td><td>41.653979</td><td>58.086505</td><td>68.813149</td><td>82.695502</td><td>95.653979</td><td>106.595156</td><td>119.031142</td><td>128.480969</td><td>138.968858</td><td>147.99654</td><td>155.065744</td><td>156.512111</td><td>208.941176</td><td>231.529412</td><td>238.944637</td><td>246.49827</td><td>253.539792</td><td>260.051903</td><td>261.782007</td><td>263.723183</td><td>265.903114</td><td>272.0</td><td>&hellip;</td><td>2.3219e6</td><td>2.3228e6</td><td>2.3236e6</td><td>2.3240e6</td><td>2.3243e6</td><td>2.3248e6</td><td>2.3255e6</td><td>2.3263e6</td><td>2.3272e6</td><td>2.3277e6</td><td>2.3281e6</td><td>2.3284e6</td><td>2.3289e6</td><td>2.3295e6</td><td>2.3304e6</td><td>2.3311e6</td><td>2.3318e6</td><td>2.3321e6</td><td>2.3324e6</td><td>2.3327e6</td><td>2.3333e6</td><td>2.3342e6</td><td>2.3349e6</td><td>2.3354e6</td><td>2.3356e6</td><td>2.3358e6</td><td>2.3362e6</td><td>2.3368e6</td><td>2.3375e6</td><td>2.3382e6</td><td>2.3388e6</td><td>2.3390e6</td><td>2.3392e6</td><td>2.3394e6</td><td>2.3398e6</td><td>2.3405e6</td><td>2.3411e6</td></tr><tr><td>&quot;std&quot;</td><td>null</td><td>null</td><td>25.956609</td><td>77.870931</td><td>26.173664</td><td>26.270191</td><td>32.707271</td><td>45.523871</td><td>63.623197</td><td>85.724481</td><td>210.329649</td><td>211.628535</td><td>291.630499</td><td>345.759248</td><td>425.471558</td><td>661.171033</td><td>799.258224</td><td>985.038344</td><td>1160.785189</td><td>1304.872173</td><td>1472.006165</td><td>1598.378021</td><td>1747.162098</td><td>1870.449899</td><td>1966.785835</td><td>1967.121793</td><td>2838.127785</td><td>3202.384554</td><td>3310.754868</td><td>3424.390905</td><td>3530.604364</td><td>3630.11703</td><td>3650.660287</td><td>3674.805102</td><td>3687.812705</td><td>3771.362586</td><td>&hellip;</td><td>8.4392e6</td><td>8.4439e6</td><td>8.4473e6</td><td>8.4483e6</td><td>8.4491e6</td><td>8.4511e6</td><td>8.4544e6</td><td>8.4592e6</td><td>8.4639e6</td><td>8.4655e6</td><td>8.4669e6</td><td>8.4674e6</td><td>8.4695e6</td><td>8.4726e6</td><td>8.4776e6</td><td>8.4812e6</td><td>8.4843e6</td><td>8.4852e6</td><td>8.4857e6</td><td>8.4865e6</td><td>8.4900e6</td><td>8.4957e6</td><td>8.4993e6</td><td>8.5010e6</td><td>8.5014e6</td><td>8.5019e6</td><td>8.5037e6</td><td>8.5066e6</td><td>8.5113e6</td><td>8.5145e6</td><td>8.5180e6</td><td>8.5184e6</td><td>8.5186e6</td><td>8.5193e6</td><td>8.5216e6</td><td>8.5250e6</td><td>8.5278e6</td></tr><tr><td>&quot;min&quot;</td><td>&quot;Alberta&quot;</td><td>&quot;Afghanistan&quot;</td><td>-71.9499</td><td>-178.1165</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>&hellip;</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td></tr><tr><td>&quot;25%&quot;</td><td>null</td><td>null</td><td>4.210484</td><td>-23.0418</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>&hellip;</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td><td>14567.0</td></tr><tr><td>&quot;50%&quot;</td><td>null</td><td>null</td><td>21.512583</td><td>20.9394</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>&hellip;</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td><td>103248.0</td></tr><tr><td>&quot;75%&quot;</td><td>null</td><td>null</td><td>40.463667</td><td>90.3563</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>&hellip;</td><td>1.049457e6</td><td>1.049537e6</td><td>1.04964e6</td><td>1.049729e6</td><td>1.049828e6</td><td>1.049944e6</td><td>1.049944e6</td><td>1.05e6</td><td>1.050127e6</td><td>1.050241e6</td><td>1.05033e6</td><td>1.050402e6</td><td>1.050402e6</td><td>1.050549e6</td><td>1.050621e6</td><td>1.050736e6</td><td>1.050824e6</td><td>1.050961e6</td><td>1.051079e6</td><td>1.051162e6</td><td>1.051241e6</td><td>1.051336e6</td><td>1.051457e6</td><td>1.051589e6</td><td>1.051732e6</td><td>1.051862e6</td><td>1.05193e6</td><td>1.051998e6</td><td>1.052122e6</td><td>1.052247e6</td><td>1.052382e6</td><td>1.052519e6</td><td>1.052664e6</td><td>1.052664e6</td><td>1.052926e6</td><td>1.053068e6</td><td>1.053213e6</td></tr><tr><td>&quot;max&quot;</td><td>&quot;Zhejiang&quot;</td><td>&quot;Zimbabwe&quot;</td><td>71.7069</td><td>178.065</td><td>444.0</td><td>444.0</td><td>549.0</td><td>761.0</td><td>1058.0</td><td>1423.0</td><td>3554.0</td><td>3554.0</td><td>4903.0</td><td>5806.0</td><td>7153.0</td><td>11177.0</td><td>13522.0</td><td>16678.0</td><td>19665.0</td><td>22112.0</td><td>24953.0</td><td>27100.0</td><td>29631.0</td><td>31728.0</td><td>33366.0</td><td>33366.0</td><td>48206.0</td><td>54406.0</td><td>56249.0</td><td>58182.0</td><td>59989.0</td><td>61682.0</td><td>62031.0</td><td>62442.0</td><td>62662.0</td><td>64084.0</td><td>&hellip;</td><td>1.02479379e8</td><td>1.02561054e8</td><td>1.02599784e8</td><td>1.02603942e8</td><td>1.02606868e8</td><td>1.02631179e8</td><td>1.02676694e8</td><td>1.02760211e8</td><td>1.02842061e8</td><td>1.02855101e8</td><td>1.0285951e8</td><td>1.02862879e8</td><td>1.02886005e8</td><td>1.02934224e8</td><td>1.03023231e8</td><td>1.0308391e8</td><td>1.03131898e8</td><td>1.03134605e8</td><td>1.03136077e8</td><td>1.03138119e8</td><td>1.03198669e8</td><td>1.03308832e8</td><td>1.03365511e8</td><td>1.03378408e8</td><td>1.03381157e8</td><td>1.03382763e8</td><td>1.03399827e8</td><td>1.03443455e8</td><td>1.03533872e8</td><td>1.03589757e8</td><td>1.0364869e8</td><td>1.03650837e8</td><td>1.03646975e8</td><td>1.03655539e8</td><td>1.0369091e8</td><td>1.03755771e8</td><td>1.03802702e8</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n:::{.note}\n\nOf course, this value is meaningless for `Lat` and `Long`!\n\n:::\n\n::: {#ad34b393 .cell execution_count=4}\n``` {.python .cell-code}\n# Data types of the various columns\n# cases.dtypes\n```\n:::\n\n\n::: {#32525ef2 .cell execution_count=5}\n``` {.python .cell-code}\n# cases.info()\n```\n:::\n\n\n::: {#0c7d9796 .cell execution_count=6}\n``` {.python .cell-code}\ncases.shape\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```\n(289, 1147)\n```\n:::\n:::\n\n\n## Cases per country by date\n\nThe dataset is a time series: this means that we have the cumulative numbers up to each date.\n\n::: {#2c5ee8b7 .cell execution_count=7}\n``` {.python .cell-code}\n# Let's get rid of the latitude and longitude to simplify our data\nsimple = cases.drop(columns=['Lat', 'Long'])\nsimple\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">TypeError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[7], line 2</span>\n<span class=\"ansi-green-fg\">      1</span> <span style=\"font-style:italic;color:rgb(95,135,135)\"># Let's get rid of the latitude and longitude to simplify our data</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 2</span> simple <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-red-bg\">cases</span><span style=\"color:rgb(98,98,98)\" class=\"ansi-red-bg\">.</span><span class=\"ansi-red-bg\">drop</span><span class=\"ansi-red-bg\">(</span><span class=\"ansi-red-bg\">columns</span><span style=\"color:rgb(98,98,98)\" class=\"ansi-red-bg\">=</span><span class=\"ansi-red-bg\">[</span><span style=\"color:rgb(175,0,0)\" class=\"ansi-red-bg\">'</span><span style=\"color:rgb(175,0,0)\" class=\"ansi-red-bg\">Lat</span><span style=\"color:rgb(175,0,0)\" class=\"ansi-red-bg\">'</span><span class=\"ansi-red-bg\">,</span><span class=\"ansi-red-bg\"> </span><span style=\"color:rgb(175,0,0)\" class=\"ansi-red-bg\">'</span><span style=\"color:rgb(175,0,0)\" class=\"ansi-red-bg\">Long</span><span style=\"color:rgb(175,0,0)\" class=\"ansi-red-bg\">'</span><span class=\"ansi-red-bg\">]</span><span class=\"ansi-red-bg\">)</span>\n<span class=\"ansi-green-fg\">      3</span> simple\n\n<span class=\"ansi-red-fg ansi-bold\">TypeError</span>: DataFrame.drop() got an unexpected keyword argument 'columns'</pre>\n```\n:::\n\n:::\n:::\n\n\n<br>\nSome countries (e.g. Australia) are split between several provinces or states so we will have to add the values of all their provinces/states to get their totals.\n\n[Here is how to make the sum for all Australian states:]{.underline}\n\nLet's first select all the data for Australia: we want all the rows for which the `Country/Region` column is equal to `Australia`.\n\nFirst, we want to select the `Country/Region` column. There are several ways to index in Polars.\n\nWhen indexing columns, one can use square brackets directly after the DataFrame to index:\n\n::: {#0540ace8 .cell execution_count=8}\n``` {.python .cell-code}\nsimple['Country/Region']\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[8], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-red-bg\">simple</span>[<span style=\"color:rgb(175,0,0)\">'</span><span style=\"color:rgb(175,0,0)\">Country/Region</span><span style=\"color:rgb(175,0,0)\">'</span>]\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'simple' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nHowever, it is more efficient to use the `.loc` or `.iloc` methods.\n\n- Use `.loc` when using labels or booleans:\n\n::: {#05a71bab .cell execution_count=9}\n``` {.python .cell-code}\n# simple.loc[:, 'Country/Region']\n```\n:::\n\n\n-  Use `.iloc` when using indices:\n\n::: {#1ac9df27 .cell execution_count=10}\n``` {.python .cell-code}\n# simple.iloc[:, 1]\n```\n:::\n\n\n:::{.note}\n\n`Country/Region` is the 2nd column, but indexing starts at 0 in Python.\n\n:::\n\nThen we need a conditional to filter the rows for which the value is equal to `Australia`:\n\n::: {#ed073186 .cell execution_count=11}\n``` {.python .cell-code}\n# simple.loc[:, 'Country/Region'] == 'Australia'\n```\n:::\n\n\nFinally, we index, out of our entire data frame, the rows for which that condition returns `True`:\n\n::: {#607b0444 .cell execution_count=12}\n``` {.python .cell-code}\n# simple.loc[simple.loc[:, 'Country/Region'] == 'Australia']\n```\n:::\n\n\n:::{.note}\n\nHere we use `.loc` to index based on a boolean array.\n\n:::\n\nWe can now make the sum for all of Australia for each day:\n\n::: {#28dfc3e0 .cell execution_count=13}\n``` {.python .cell-code}\ntotal_australia = simple.loc[simple.loc[:, 'Country/Region'] == 'Australia'].sum(numeric_only=True)\ntotal_australia\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[13], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> total_australia <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-red-bg\">simple</span><span style=\"color:rgb(98,98,98)\">.</span>loc[simple<span style=\"color:rgb(98,98,98)\">.</span>loc[:, <span style=\"color:rgb(175,0,0)\">'</span><span style=\"color:rgb(175,0,0)\">Country/Region</span><span style=\"color:rgb(175,0,0)\">'</span>] <span style=\"color:rgb(98,98,98)\">==</span> <span style=\"color:rgb(175,0,0)\">'</span><span style=\"color:rgb(175,0,0)\">Australia</span><span style=\"color:rgb(175,0,0)\">'</span>]<span style=\"color:rgb(98,98,98)\">.</span>sum(numeric_only<span style=\"color:rgb(98,98,98)\">=</span><span style=\"font-weight:bold;color:rgb(0,135,0)\">True</span>)\n<span class=\"ansi-green-fg\">      2</span> total_australia\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'simple' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n[We can do this for all countries by grouping them:]{.underline}\n\n::: {#23e603a3 .cell execution_count=14}\n``` {.python .cell-code}\ntotals = simple.groupby('Country/Region').sum(numeric_only=True)\ntotals\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[14], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> totals <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-red-bg\">simple</span><span style=\"color:rgb(98,98,98)\">.</span>groupby(<span style=\"color:rgb(175,0,0)\">'</span><span style=\"color:rgb(175,0,0)\">Country/Region</span><span style=\"color:rgb(175,0,0)\">'</span>)<span style=\"color:rgb(98,98,98)\">.</span>sum(numeric_only<span style=\"color:rgb(98,98,98)\">=</span><span style=\"font-weight:bold;color:rgb(0,135,0)\">True</span>)\n<span class=\"ansi-green-fg\">      2</span> totals\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'simple' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n<br>\nNow, we can look at the totals for any date:\n\n::: {#dc01a221 .cell execution_count=15}\n``` {.python .cell-code}\ntotals.loc[:, '6/12/21']\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[15], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-red-bg\">totals</span><span style=\"color:rgb(98,98,98)\">.</span>loc[:, <span style=\"color:rgb(175,0,0)\">'</span><span style=\"color:rgb(175,0,0)\">6/12/21</span><span style=\"color:rgb(175,0,0)\">'</span>]\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'totals' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nTo make it easier to read, let's order those numbers by decreasing order:\n\n::: {#e353c5c9 .cell execution_count=16}\n``` {.python .cell-code}\ntotals.loc[:, '6/12/21'].sort_values(ascending=False)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[16], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-red-bg\">totals</span><span style=\"color:rgb(98,98,98)\">.</span>loc[:, <span style=\"color:rgb(175,0,0)\">'</span><span style=\"color:rgb(175,0,0)\">6/12/21</span><span style=\"color:rgb(175,0,0)\">'</span>]<span style=\"color:rgb(98,98,98)\">.</span>sort_values(ascending<span style=\"color:rgb(98,98,98)\">=</span><span style=\"font-weight:bold;color:rgb(0,135,0)\">False</span>)\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'totals' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nWe can also index the data for a particular country by indexing a row instead of a column:\n\n::: {#fbb91cf4 .cell execution_count=17}\n``` {.python .cell-code}\ntotals.loc['Albania', :]\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[17], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-red-bg\">totals</span><span style=\"color:rgb(98,98,98)\">.</span>loc[<span style=\"color:rgb(175,0,0)\">'</span><span style=\"color:rgb(175,0,0)\">Albania</span><span style=\"color:rgb(175,0,0)\">'</span>, :]\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'totals' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nWhen indexing rows, this syntax can be simplified to:\n\n::: {#9312a2b5 .cell execution_count=18}\n``` {.python .cell-code}\ntotals.loc['Albania']\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[18], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-red-bg\">totals</span><span style=\"color:rgb(98,98,98)\">.</span>loc[<span style=\"color:rgb(175,0,0)\">'</span><span style=\"color:rgb(175,0,0)\">Albania</span><span style=\"color:rgb(175,0,0)\">'</span>]\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'totals' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n## Global totals\n\nNow, what if we want to have the world totals for each day? We calculate the columns totals (i.e. the sum across countries):\n\n::: {#9d3b5878 .cell execution_count=19}\n``` {.python .cell-code}\ntotals.sum()\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[19], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-red-bg\">totals</span><span style=\"color:rgb(98,98,98)\">.</span>sum()\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'totals' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n:::{.exo}\n\n:::{.yourturn}\n\nYour turn:\n\n:::\n\nHow many confirmed cases were there in Venezuela by March 10, 2021?\n\n:::\n\n:::{.callout-warning collapse=\"true\"}\n\n## Solution\n\nFirst, we need to select the data for Venezuela:\n\n::: {#83f8eee6 .cell execution_count=20}\n``` {.python .cell-code}\nvenez = totals.loc['Venezuela']\nvenez\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[20], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> venez <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-red-bg\">totals</span><span style=\"color:rgb(98,98,98)\">.</span>loc[<span style=\"color:rgb(175,0,0)\">'</span><span style=\"color:rgb(175,0,0)\">Venezuela</span><span style=\"color:rgb(175,0,0)\">'</span>]\n<span class=\"ansi-green-fg\">      2</span> venez\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'totals' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nThen, we need to select for the proper date:\n\n::: {#1fec9a6e .cell execution_count=21}\n``` {.python .cell-code}\nanswer = venez.loc['3/10/21']\nanswer\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[21], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> answer <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-red-bg\">venez</span><span style=\"color:rgb(98,98,98)\">.</span>loc[<span style=\"color:rgb(175,0,0)\">'</span><span style=\"color:rgb(175,0,0)\">3/10/21</span><span style=\"color:rgb(175,0,0)\">'</span>]\n<span class=\"ansi-green-fg\">      2</span> answer\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'venez' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nWe could have done it at once by indexing the row and column:\n\n::: {#0eade911 .cell execution_count=22}\n``` {.python .cell-code}\ntotals.loc['Venezuela', '3/10/21']\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg ansi-bold\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg ansi-bold\">In[22], line 1</span>\n<span class=\"ansi-green-fg ansi-bold\">----&gt; 1</span> <span class=\"ansi-red-bg\">totals</span><span style=\"color:rgb(98,98,98)\">.</span>loc[<span style=\"color:rgb(175,0,0)\">'</span><span style=\"color:rgb(175,0,0)\">Venezuela</span><span style=\"color:rgb(175,0,0)\">'</span>, <span style=\"color:rgb(175,0,0)\">'</span><span style=\"color:rgb(175,0,0)\">3/10/21</span><span style=\"color:rgb(175,0,0)\">'</span>]\n\n<span class=\"ansi-red-fg ansi-bold\">NameError</span>: name 'totals' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n:::\n\n## Polars documentation\n\n",
    "supporting": [
      "ws_polars_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}
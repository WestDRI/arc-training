{
  "hash": "50bbc1fceb037e9fbb7705819e1ff622",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Sentiment analysis\nauthor: Marie-Hélène Burle\n---\n\n:::{.def}\n\nOne of the common tasks of natural language processing is [sentiment analysis](https://en.wikipedia.org/wiki/Sentiment_analysis). Let's see how it works with TextBlob.\n\n:::\n\n:::{.callout-note collapse=\"true\"}\n\n## Necessary code from previous sessions\n\nHere is the necessary code from previous sessions, stripped to the minimum:\n\n::: {#d484957b .cell execution_count=2}\n``` {.python .cell-code}\n# Load packages\nimport requests\nimport pymupdf\nfrom textblob import TextBlob\n\n# Download the data\nurl = \"https://funnyengwish.wordpress.com/wp-content/uploads/2017/05/pratchett_terry_wyrd_sisters_-_royallib_ru.pdf\"\nresponse = requests.get(url)\n\n# Extract data from pdf\ndata = response.content\ndoc = pymupdf.Document(stream=data)\n\n# Create text from first pdf page\npage1 = doc[0].get_text()\n\n# Turn text into TextBlob\ntext = TextBlob(page1)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bright-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-bright-red-fg\">ModuleNotFoundError</span>                       Traceback (most recent call last)\n<span class=\"ansi-bright-cyan-fg\">Cell</span><span class=\"ansi-bright-cyan-fg\"> </span><span class=\"ansi-green-fg\">In[1]</span><span class=\"ansi-green-fg\">, line 3</span>\n<span class=\"ansi-bright-green-fg\">      1</span> <span style=\"color:rgb(138,138,138)\"># Load packages</span>\n<span class=\"ansi-bright-green-fg\">      2</span> <span style=\"color:rgb(255,95,135)\">import</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg\">requests</span>\n<span class=\"ansi-bright-green-fg\">----&gt; </span><span class=\"ansi-bright-green-fg\">3</span> <span style=\"color:rgb(255,95,135)\">import</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg\">pymupdf</span>\n<span class=\"ansi-bright-green-fg\">      4</span> <span style=\"color:rgb(255,95,135)\">from</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg\">textblob</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">import</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg\">TextBlob</span>\n<span class=\"ansi-bright-green-fg\">      6</span> <span style=\"color:rgb(138,138,138)\"># Download the data</span>\n\n<span class=\"ansi-bright-red-fg\">ModuleNotFoundError</span>: No module named 'pymupdf'</pre>\n```\n:::\n\n:::\n:::\n\n\n:::\n\n## The data\n\nIt wouldn't make much sense to do sentiment analysis on the first pdf page of Wyrd Sisters. Instead, let's use some [Goodreads reviews of Wyrd Sisters](https://www.goodreads.com/book/show/34504.Wyrd_Sisters?from_search=true&from_srp=true&qid=sObiiwRnLg&rank=1).\n\nThe method is as easy as everything we have seen so far: you simply use the `sentiment` attribute of a `TextBlob` object and you get a named tuple with the polarity on a continuous scale from -1 to +1 and a subjectivity ranging from 0 to 1.\n\nWe could get very fancy, scrape the site and analyse all the reviews, but this is not the purpose of this course. Instead, we will simply copy and paste a few reviews in the `TextBlob` function to turn them into `TextBlob` objects and look at their `sentiment` attributes.\n\nIf TextBlob does a good job at analysing those reviews, we should get a polarity close to 1 for four and five-star reviews and a polarity close to -1 for one-star reviews.\n\n## Results\n\n:::{.note}\n\nBe careful that you have to remove all end of lines when you paste the reviews into your code to make sure that you create a Python string.\n\n:::\n\nLet's create a string with one of the four-star reviews:\n\n::: {#0b750fa4 .cell execution_count=3}\n``` {.python .cell-code}\nreview1 = \"How have I never read Terry Pratchett before? He's like ... Shakespeare and Wodehouse and Monty Python all wrapped into one! A student gave me this book while we were studying Macbeth in class. Wyrd Sisters is a sort of parallel story, which manages to poke fun at the play, revere the play, make inside jokes about the play, and ... well, generally turn the play on its head. All the while, you, the reader, get to feel very smart and superior for getting all the jokes and allusions. And yet it manages to avoid being gimmicky. It really is a good story with good characters, too. This is no Life of Brian where the story itself matters less than the hilarity of the parody. Wyrd Sisters may draw a good deal of life from Macbeth, but its real liveliness comes from Pratchett's skilled characterizations of a regicidal Duke, his murderess Dutchess, their depressed Fool, and three very colorful witches. Oh, it's just genius. My only problem is figuring out what Pratchett novel to read next ... he's dauntingly prolific!\"\n```\n:::\n\n\nWe need to turn the string into a `TextBlob` object:\n\n::: {#c5304d8c .cell execution_count=4}\n``` {.python .cell-code}\nr1 = TextBlob(review1)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bright-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-bright-red-fg\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansi-bright-cyan-fg\">Cell</span><span class=\"ansi-bright-cyan-fg\"> </span><span class=\"ansi-green-fg\">In[3]</span><span class=\"ansi-green-fg\">, line 1</span>\n<span class=\"ansi-bright-green-fg\">----&gt; </span><span class=\"ansi-bright-green-fg\">1</span> <span class=\"ansi-bright-white-fg\">r1</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg ansi-yellow-bg\">TextBlob</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">review1</span><span class=\"ansi-bright-white-fg\">)</span>\n\n<span class=\"ansi-bright-red-fg\">NameError</span>: name 'TextBlob' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nAnd now we can see the result of the sentiment analysis:\n\n::: {#5770010e .cell execution_count=5}\n``` {.python .cell-code}\nprint(r1.sentiment)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bright-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-bright-red-fg\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansi-bright-cyan-fg\">Cell</span><span class=\"ansi-bright-cyan-fg\"> </span><span class=\"ansi-green-fg\">In[4]</span><span class=\"ansi-green-fg\">, line 1</span>\n<span class=\"ansi-bright-green-fg\">----&gt; </span><span class=\"ansi-bright-green-fg\">1</span> <span class=\"ansi-bright-white-fg\">print</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg ansi-yellow-bg\">r1</span><span style=\"color:rgb(255,95,135)\">.</span><span class=\"ansi-bright-white-fg\">sentiment</span><span class=\"ansi-bright-white-fg\">)</span>\n\n<span class=\"ansi-bright-red-fg\">NameError</span>: name 'r1' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nThe result is a bit far from 1 for a four-star review. Maybe we can do better. TextBlob can use a more fancy approach for sentiment analysis based on a naive Bayes analyzer from NLTK trained on a movie reviews corpus. Let's see if we get better results.\n\nFirst, we need to load the module:\n\n::: {#0e48c05c .cell execution_count=6}\n``` {.python .cell-code}\nfrom textblob.sentiments import NaiveBayesAnalyzer\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bright-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-bright-red-fg\">ModuleNotFoundError</span>                       Traceback (most recent call last)\n<span class=\"ansi-bright-cyan-fg\">Cell</span><span class=\"ansi-bright-cyan-fg\"> </span><span class=\"ansi-green-fg\">In[5]</span><span class=\"ansi-green-fg\">, line 1</span>\n<span class=\"ansi-bright-green-fg\">----&gt; </span><span class=\"ansi-bright-green-fg\">1</span> <span style=\"color:rgb(255,95,135)\">from</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg\">textblob</span><span class=\"ansi-bright-white-fg\">.</span><span class=\"ansi-bright-white-fg\">sentiments</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">import</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg\">NaiveBayesAnalyzer</span>\n\n<span class=\"ansi-bright-red-fg\">ModuleNotFoundError</span>: No module named 'textblob'</pre>\n```\n:::\n\n:::\n:::\n\n\nThen we run the analysis:\n\n::: {#19a45f2b .cell execution_count=7}\n``` {.python .cell-code}\nr1b = TextBlob(review1, analyzer=NaiveBayesAnalyzer())\nprint(r1b.sentiment)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bright-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-bright-red-fg\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansi-bright-cyan-fg\">Cell</span><span class=\"ansi-bright-cyan-fg\"> </span><span class=\"ansi-green-fg\">In[6]</span><span class=\"ansi-green-fg\">, line 1</span>\n<span class=\"ansi-bright-green-fg\">----&gt; </span><span class=\"ansi-bright-green-fg\">1</span> <span class=\"ansi-bright-white-fg\">r1b</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg ansi-yellow-bg\">TextBlob</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">review1</span><span class=\"ansi-bright-white-fg\">,</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg\">analyzer</span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\">NaiveBayesAnalyzer</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">)</span><span class=\"ansi-bright-white-fg\">)</span>\n<span class=\"ansi-bright-green-fg\">      2</span> <span class=\"ansi-bright-white-fg\">print</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">r1b</span><span style=\"color:rgb(255,95,135)\">.</span><span class=\"ansi-bright-white-fg\">sentiment</span><span class=\"ansi-bright-white-fg\">)</span>\n\n<span class=\"ansi-bright-red-fg\">NameError</span>: name 'TextBlob' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nIt looks a lot better!\n\nLet's try on a five-star review this time:\n\n::: {#b781f07a .cell execution_count=8}\n``` {.python .cell-code}\nreview2 = \"A veritable smorgasbord of Shakespeare references sees the 6th Discworld novel come to life, dragging the two most prominent witches (Granny and Nanny) and their occult-leaning protege, Magrat, though thickets and thick-cities alike as they attempt to make sure fate happens. Maybe with a few encouraging prods along the way… A mixture of Macbeth and Hamlet with a little dollop of King Lear thrown in, along with many other Shakespeare nonsense that doesn’t stand out right way, Wyrd Sisters is one of PTerry’s very early masterpieces. His hands and head seem to meld together as one, where his imagination is not shackled by the human-only speed of his writing (or typing) or the darned debilitation of the English language.The plot simmers nicely, following and then not following the true path of how this kind of story goes. It’s so nice to see the Discworld countryside getting a deep look-in, and how well it contrasts with city-life, but also manages to co-exist very peacefully (as long as the city stays far away from the countryside, thank you). Whilst previously we visited vast open vistas on the Disc, these close-quarter scenes are even more brimful of life and curiosity and share yet another facet to not only PTerry’s imagination, but the world he has created. One of the best things about PTerry (and of any comedy at all) is that, whilst he does take the mickey out of Shakespeare and fantasy and all those things, he does it with such love and reverence that it shines through and makes the humour that much more poignant and, well, funny. (My previous review of this had me not enjoying it and I’m actually pretty baffled by that. I loved every single minute of this re-read and it’s curious how your tastes and feelings can change even after only a few years. I’ll leave the old review below just for the sake of it: Wyrd Sisters is the second of the Witch mini-series, in the ever popular Discworld series. Equal Rites was the first and we were introduced to one of the greatest characters of all-time: Granny Weatherwax. Wyrd Sisters brings two more witches-and mentions of many others-in to fray: Nanny Ogg, Granny's best friend, and Magrat Garlick, a new-wave witch who thinks jangling jewellery and occult symbols makes you a better witch. Adding two new witches alongside Granny just emphasises how cantankerous, stubborn and bloody brilliant she is. Even they can't deny that she's the best. She is tolerated most of the time, but there's always an underlying current of total respect, in the same way you respect your grandparents because they lived through the war, even if they do still say \\\"does anyone want to get a Chinky?\\\" The plot is Shakespearean-Macbeth in particular-and takes many plot points from that, as well as a lot of the quotes. It's a wonderful juxtaposition of Discworld nonsense and Shakespearean tragedy that is twisted with unique Pratchett humour. It is written much the same way all the early Discworld books were. Very well, hardly any technical faults and smatterings of Pratchett humour. Despite the wonderful Granny, the amusing Nanny and the Straightforward but naive Magrat, and my love for all the Discworld witches, I couldn't enjoy this as much as I wanted. It was funny in a tittering kind of way, and the plot was interesting, but it never quite held my attention. I never felt like I wanted to read it all the time, or try and finish reading it. It took me quite a while to get through it (for other reasons I won't go in to) but it never really held me enough to want it. Still a better love story than Twilight.)\"\n\nr2 = TextBlob(review2)\nr2b = TextBlob(review2, analyzer=NaiveBayesAnalyzer())\n\nprint(r2.sentiment)\nprint(r2b.sentiment)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bright-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-bright-red-fg\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansi-bright-cyan-fg\">Cell</span><span class=\"ansi-bright-cyan-fg\"> </span><span class=\"ansi-green-fg\">In[7]</span><span class=\"ansi-green-fg\">, line 3</span>\n<span class=\"ansi-bright-green-fg\">      1</span> <span class=\"ansi-bright-white-fg\">review2</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(215,215,135)\">\"</span><span style=\"color:rgb(215,215,135)\">A veritable smorgasbord of Shakespeare references sees the 6th Discworld novel come to life, dragging the two most prominent witches (Granny and Nanny) and their occult-leaning protege, Magrat, though thickets and thick-cities alike as they attempt to make sure fate happens. Maybe with a few encouraging prods along the way… A mixture of Macbeth and Hamlet with a little dollop of King Lear thrown in, along with many other Shakespeare nonsense that doesn’t stand out right way, Wyrd Sisters is one of PTerry’s very early masterpieces. His hands and head seem to meld together as one, where his imagination is not shackled by the human-only speed of his writing (or typing) or the darned debilitation of the English language.The plot simmers nicely, following and then not following the true path of how this kind of story goes. It’s so nice to see the Discworld countryside getting a deep look-in, and how well it contrasts with city-life, but also manages to co-exist very peacefully (as long as the city stays far away from the countryside, thank you). Whilst previously we visited vast open vistas on the Disc, these close-quarter scenes are even more brimful of life and curiosity and share yet another facet to not only PTerry’s imagination, but the world he has created. One of the best things about PTerry (and of any comedy at all) is that, whilst he does take the mickey out of Shakespeare and fantasy and all those things, he does it with such love and reverence that it shines through and makes the humour that much more poignant and, well, funny. (My previous review of this had me not enjoying it and I’m actually pretty baffled by that. I loved every single minute of this re-read and it’s curious how your tastes and feelings can change even after only a few years. I’ll leave the old review below just for the sake of it: Wyrd Sisters is the second of the Witch mini-series, in the ever popular Discworld series. Equal Rites was the first and we were introduced to one of the greatest characters of all-time: Granny Weatherwax. Wyrd Sisters brings two more witches-and mentions of many others-in to fray: Nanny Ogg, Granny</span><span style=\"color:rgb(215,215,135)\">'</span><span style=\"color:rgb(215,215,135)\">s best friend, and Magrat Garlick, a new-wave witch who thinks jangling jewellery and occult symbols makes you a better witch. Adding two new witches alongside Granny just emphasises how cantankerous, stubborn and bloody brilliant she is. Even they can</span><span style=\"color:rgb(215,215,135)\">'</span><span style=\"color:rgb(215,215,135)\">t deny that she</span><span style=\"color:rgb(215,215,135)\">'</span><span style=\"color:rgb(215,215,135)\">s the best. She is tolerated most of the time, but there</span><span style=\"color:rgb(215,215,135)\">'</span><span style=\"color:rgb(215,215,135)\">s always an underlying current of total respect, in the same way you respect your grandparents because they lived through the war, even if they do still say </span><span style=\"color:rgb(175,135,255)\">\\\"</span><span style=\"color:rgb(215,215,135)\">does anyone want to get a Chinky?</span><span style=\"color:rgb(175,135,255)\">\\\"</span><span style=\"color:rgb(215,215,135)\"> The plot is Shakespearean-Macbeth in particular-and takes many plot points from that, as well as a lot of the quotes. It</span><span style=\"color:rgb(215,215,135)\">'</span><span style=\"color:rgb(215,215,135)\">s a wonderful juxtaposition of Discworld nonsense and Shakespearean tragedy that is twisted with unique Pratchett humour. It is written much the same way all the early Discworld books were. Very well, hardly any technical faults and smatterings of Pratchett humour. Despite the wonderful Granny, the amusing Nanny and the Straightforward but naive Magrat, and my love for all the Discworld witches, I couldn</span><span style=\"color:rgb(215,215,135)\">'</span><span style=\"color:rgb(215,215,135)\">t enjoy this as much as I wanted. It was funny in a tittering kind of way, and the plot was interesting, but it never quite held my attention. I never felt like I wanted to read it all the time, or try and finish reading it. It took me quite a while to get through it (for other reasons I won</span><span style=\"color:rgb(215,215,135)\">'</span><span style=\"color:rgb(215,215,135)\">t go in to) but it never really held me enough to want it. Still a better love story than Twilight.)</span><span style=\"color:rgb(215,215,135)\">\"</span>\n<span class=\"ansi-bright-green-fg\">----&gt; </span><span class=\"ansi-bright-green-fg\">3</span> <span class=\"ansi-bright-white-fg\">r2</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg ansi-yellow-bg\">TextBlob</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">review2</span><span class=\"ansi-bright-white-fg\">)</span>\n<span class=\"ansi-bright-green-fg\">      4</span> <span class=\"ansi-bright-white-fg\">r2b</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg\">TextBlob</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">review2</span><span class=\"ansi-bright-white-fg\">,</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg\">analyzer</span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\">NaiveBayesAnalyzer</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">)</span><span class=\"ansi-bright-white-fg\">)</span>\n<span class=\"ansi-bright-green-fg\">      6</span> <span class=\"ansi-bright-white-fg\">print</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">r2</span><span style=\"color:rgb(255,95,135)\">.</span><span class=\"ansi-bright-white-fg\">sentiment</span><span class=\"ansi-bright-white-fg\">)</span>\n\n<span class=\"ansi-bright-red-fg\">NameError</span>: name 'TextBlob' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nHere too, the naive Bayesian classifier performs **a lot** better.\n\nNow, let's see what we get for a one-star review:\n\n::: {#1a459f6b .cell execution_count=9}\n``` {.python .cell-code}\nreview3 = \"I struggled finishing the book as I lost interest.\"\n\nr3 = TextBlob(review3)\nr3b = TextBlob(review3, analyzer=NaiveBayesAnalyzer())\n\nprint(r3.sentiment)\nprint(r3b.sentiment)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bright-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-bright-red-fg\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansi-bright-cyan-fg\">Cell</span><span class=\"ansi-bright-cyan-fg\"> </span><span class=\"ansi-green-fg\">In[8]</span><span class=\"ansi-green-fg\">, line 3</span>\n<span class=\"ansi-bright-green-fg\">      1</span> <span class=\"ansi-bright-white-fg\">review3</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(215,215,135)\">\"</span><span style=\"color:rgb(215,215,135)\">I struggled finishing the book as I lost interest.</span><span style=\"color:rgb(215,215,135)\">\"</span>\n<span class=\"ansi-bright-green-fg\">----&gt; </span><span class=\"ansi-bright-green-fg\">3</span> <span class=\"ansi-bright-white-fg\">r3</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg ansi-yellow-bg\">TextBlob</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">review3</span><span class=\"ansi-bright-white-fg\">)</span>\n<span class=\"ansi-bright-green-fg\">      4</span> <span class=\"ansi-bright-white-fg\">r3b</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg\">TextBlob</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">review3</span><span class=\"ansi-bright-white-fg\">,</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg\">analyzer</span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\">NaiveBayesAnalyzer</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">)</span><span class=\"ansi-bright-white-fg\">)</span>\n<span class=\"ansi-bright-green-fg\">      6</span> <span class=\"ansi-bright-white-fg\">print</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">r3</span><span style=\"color:rgb(255,95,135)\">.</span><span class=\"ansi-bright-white-fg\">sentiment</span><span class=\"ansi-bright-white-fg\">)</span>\n\n<span class=\"ansi-bright-red-fg\">NameError</span>: name 'TextBlob' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nWell... 🙁 Frankly, both models performed poorly here.\n\nLet's try another one-star review:\n\n::: {#e75aa409 .cell execution_count=10}\n``` {.python .cell-code}\nreview4 = \"I did not enjoy this book at all. Slow and tedious. It had some funny bits in the beginning, but I struggled to finish it.\"\n\nr4 = TextBlob(review4)\nr4b = TextBlob(review4, analyzer=NaiveBayesAnalyzer())\n\nprint(r4.sentiment)\nprint(r4b.sentiment)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bright-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-bright-red-fg\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansi-bright-cyan-fg\">Cell</span><span class=\"ansi-bright-cyan-fg\"> </span><span class=\"ansi-green-fg\">In[9]</span><span class=\"ansi-green-fg\">, line 3</span>\n<span class=\"ansi-bright-green-fg\">      1</span> <span class=\"ansi-bright-white-fg\">review4</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(215,215,135)\">\"</span><span style=\"color:rgb(215,215,135)\">I did not enjoy this book at all. Slow and tedious. It had some funny bits in the beginning, but I struggled to finish it.</span><span style=\"color:rgb(215,215,135)\">\"</span>\n<span class=\"ansi-bright-green-fg\">----&gt; </span><span class=\"ansi-bright-green-fg\">3</span> <span class=\"ansi-bright-white-fg\">r4</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg ansi-yellow-bg\">TextBlob</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">review4</span><span class=\"ansi-bright-white-fg\">)</span>\n<span class=\"ansi-bright-green-fg\">      4</span> <span class=\"ansi-bright-white-fg\">r4b</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg\">TextBlob</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">review4</span><span class=\"ansi-bright-white-fg\">,</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg\">analyzer</span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\">NaiveBayesAnalyzer</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">)</span><span class=\"ansi-bright-white-fg\">)</span>\n<span class=\"ansi-bright-green-fg\">      6</span> <span class=\"ansi-bright-white-fg\">print</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">r4</span><span style=\"color:rgb(255,95,135)\">.</span><span class=\"ansi-bright-white-fg\">sentiment</span><span class=\"ansi-bright-white-fg\">)</span>\n\n<span class=\"ansi-bright-red-fg\">NameError</span>: name 'TextBlob' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nHere again, both models perform poorly, but the Bayesian model does even worse than the default pattern analyzer.\n\nLet's do a few more one-star reviews:\n\n::: {#fc40c74b .cell execution_count=11}\n``` {.python .cell-code}\nreview5 = \"It doesn't get much more boring than that. Zero improvement from Equal Rights, a complete snore-fest, poorly paced and with a clear lack of stakes and humour. I quit Discworld.\"\n\nr5 = TextBlob(review5)\nr5b = TextBlob(review5, analyzer=NaiveBayesAnalyzer())\n\nprint(r5.sentiment)\nprint(r5b.sentiment)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bright-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-bright-red-fg\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansi-bright-cyan-fg\">Cell</span><span class=\"ansi-bright-cyan-fg\"> </span><span class=\"ansi-green-fg\">In[10]</span><span class=\"ansi-green-fg\">, line 3</span>\n<span class=\"ansi-bright-green-fg\">      1</span> <span class=\"ansi-bright-white-fg\">review5</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(215,215,135)\">\"</span><span style=\"color:rgb(215,215,135)\">It doesn</span><span style=\"color:rgb(215,215,135)\">'</span><span style=\"color:rgb(215,215,135)\">t get much more boring than that. Zero improvement from Equal Rights, a complete snore-fest, poorly paced and with a clear lack of stakes and humour. I quit Discworld.</span><span style=\"color:rgb(215,215,135)\">\"</span>\n<span class=\"ansi-bright-green-fg\">----&gt; </span><span class=\"ansi-bright-green-fg\">3</span> <span class=\"ansi-bright-white-fg\">r5</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg ansi-yellow-bg\">TextBlob</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">review5</span><span class=\"ansi-bright-white-fg\">)</span>\n<span class=\"ansi-bright-green-fg\">      4</span> <span class=\"ansi-bright-white-fg\">r5b</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg\">TextBlob</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">review5</span><span class=\"ansi-bright-white-fg\">,</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg\">analyzer</span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\">NaiveBayesAnalyzer</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">)</span><span class=\"ansi-bright-white-fg\">)</span>\n<span class=\"ansi-bright-green-fg\">      6</span> <span class=\"ansi-bright-white-fg\">print</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">r5</span><span style=\"color:rgb(255,95,135)\">.</span><span class=\"ansi-bright-white-fg\">sentiment</span><span class=\"ansi-bright-white-fg\">)</span>\n\n<span class=\"ansi-bright-red-fg\">NameError</span>: name 'TextBlob' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#e3dc8bba .cell execution_count=12}\n``` {.python .cell-code}\nreview6 = \"Hated this book. To be fair, not my style. Only read parts of it because it was assigned for a book club.\"\n\nr6 = TextBlob(review6)\nr6b = TextBlob(review6, analyzer=NaiveBayesAnalyzer())\n\nprint(r6.sentiment)\nprint(r6b.sentiment)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bright-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-bright-red-fg\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansi-bright-cyan-fg\">Cell</span><span class=\"ansi-bright-cyan-fg\"> </span><span class=\"ansi-green-fg\">In[11]</span><span class=\"ansi-green-fg\">, line 3</span>\n<span class=\"ansi-bright-green-fg\">      1</span> <span class=\"ansi-bright-white-fg\">review6</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(215,215,135)\">\"</span><span style=\"color:rgb(215,215,135)\">Hated this book. To be fair, not my style. Only read parts of it because it was assigned for a book club.</span><span style=\"color:rgb(215,215,135)\">\"</span>\n<span class=\"ansi-bright-green-fg\">----&gt; </span><span class=\"ansi-bright-green-fg\">3</span> <span class=\"ansi-bright-white-fg\">r6</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg ansi-yellow-bg\">TextBlob</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">review6</span><span class=\"ansi-bright-white-fg\">)</span>\n<span class=\"ansi-bright-green-fg\">      4</span> <span class=\"ansi-bright-white-fg\">r6b</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg\">TextBlob</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">review6</span><span class=\"ansi-bright-white-fg\">,</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg\">analyzer</span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\">NaiveBayesAnalyzer</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">)</span><span class=\"ansi-bright-white-fg\">)</span>\n<span class=\"ansi-bright-green-fg\">      6</span> <span class=\"ansi-bright-white-fg\">print</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">r6</span><span style=\"color:rgb(255,95,135)\">.</span><span class=\"ansi-bright-white-fg\">sentiment</span><span class=\"ansi-bright-white-fg\">)</span>\n\n<span class=\"ansi-bright-red-fg\">NameError</span>: name 'TextBlob' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#e5b26133 .cell execution_count=13}\n``` {.python .cell-code}\nreview7 = \"Dnf - boring\"\n\nr7 = TextBlob(review7)\nr7b = TextBlob(review7, analyzer=NaiveBayesAnalyzer())\n\nprint(r7.sentiment)\nprint(r7b.sentiment)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bright-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-bright-red-fg\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansi-bright-cyan-fg\">Cell</span><span class=\"ansi-bright-cyan-fg\"> </span><span class=\"ansi-green-fg\">In[12]</span><span class=\"ansi-green-fg\">, line 3</span>\n<span class=\"ansi-bright-green-fg\">      1</span> <span class=\"ansi-bright-white-fg\">review7</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(215,215,135)\">\"</span><span style=\"color:rgb(215,215,135)\">Dnf - boring</span><span style=\"color:rgb(215,215,135)\">\"</span>\n<span class=\"ansi-bright-green-fg\">----&gt; </span><span class=\"ansi-bright-green-fg\">3</span> <span class=\"ansi-bright-white-fg\">r7</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg ansi-yellow-bg\">TextBlob</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">review7</span><span class=\"ansi-bright-white-fg\">)</span>\n<span class=\"ansi-bright-green-fg\">      4</span> <span class=\"ansi-bright-white-fg\">r7b</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg\">TextBlob</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">review7</span><span class=\"ansi-bright-white-fg\">,</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg\">analyzer</span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\">NaiveBayesAnalyzer</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">)</span><span class=\"ansi-bright-white-fg\">)</span>\n<span class=\"ansi-bright-green-fg\">      6</span> <span class=\"ansi-bright-white-fg\">print</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">r7</span><span style=\"color:rgb(255,95,135)\">.</span><span class=\"ansi-bright-white-fg\">sentiment</span><span class=\"ansi-bright-white-fg\">)</span>\n\n<span class=\"ansi-bright-red-fg\">NameError</span>: name 'TextBlob' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nThese fared better, although, the results are not exactly impressive.\n\n## Rule-based vs data-based NLP\n\nTextBlob (as well as [NLTK](https://www.nltk.org/) on which it is built) uses a rule-based or lexicon-based approach to NLP. This is an old technique that requires linguistic knowledge, but is computationally basic. As we saw, it has many limitations.\n\nThe recent successes of [large language models (LLMs)](https://en.wikipedia.org/wiki/Large_language_model) have shown unequivocally that AI algorithms fed vast amounts of data do a much better job. They do not need to be programmed explicitly since they learn by experience. They do however require a lot of computing power and data for training.\n\nSuch models are built from multiple complex [artificial neural networks](https://en.wikipedia.org/wiki/Neural_network_(machine_learning)) trained using machine learning frameworks such as [PyTorch](https://pytorch.org/) or [JAX](https://jax.readthedocs.io/en/latest/index.html).\n\nAs [Frederick Jelinek](https://en.wikipedia.org/wiki/Frederick_Jelinek) is famously often quoted for saying (although what he said was probably slightly different):\n\n> Every time I fire a linguist, the performance of the speech recognizer goes up.\n\n:::{.emph}\n\nI will quickly demo how much better any of the LLMs out there does at this task.\n\n:::\n\n",
    "supporting": [
      "nlp_analysis_files"
    ],
    "filters": [],
    "includes": {}
  }
}
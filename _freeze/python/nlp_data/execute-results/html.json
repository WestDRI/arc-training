{
  "hash": "609f591d7078a10cb46ef47384823566",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Getting the data\nauthor: Marie-Hélène Burle\n---\n\n:::{.def}\n\nIn this section, we will import the pdf of a book from an online URL into Python.\n\n:::\n\n## The text\n\n::::{layout=\"[8, -1, 12]\"}\n\n:::{.col1}\n\n[Wyrd Sisters](https://en.wikipedia.org/wiki/Wyrd_Sisters), the sixth [Discworld](https://en.wikipedia.org/wiki/Discworld) novel by [Terry Pratchett](https://en.wikipedia.org/wiki/Terry_Pratchett) published in 1988, has countless references to [Macbeth](https://en.wikipedia.org/wiki/Macbeth) (including, obviously, the title), other [Shakespeare](https://en.wikipedia.org/wiki/William_Shakespeare)'s plays, [the Marx Brothers](https://en.wikipedia.org/wiki/Marx_Brothers), [Charlie Chaplin](https://en.wikipedia.org/wiki/Charlie_Chaplin), and [Laurel and Hardy](https://en.wikipedia.org/wiki/Laurel_and_Hardy).\n<br><br>\nThe book is available as a pdf at [this URL](https://funnyengwish.wordpress.com/wp-content/uploads/2017/05/pratchett_terry_wyrd_sisters_-_royallib_ru.pdf) and this is the text we will use for this course.\n\n:::\n\n:::{.col2}\n\n![Art by [Josh Kirby](https://en.wikipedia.org/wiki/Josh_Kirby) used for the cover of Wyrd Sisters](img/wyrd.jpg)\n\n:::\n\n::::\n\n## Packages needed\n\nFirst off, we need to load two of the packages that you installed in the previous section:\n\n- [Requests](https://requests.readthedocs.io/en/latest/): this package sends requests to websites to download information. We will use it to download the pdf.\n- [PyMuPDF](https://pymupdf.readthedocs.io/en/latest/): this package will allow us to extract the content from the pdf.\n\nLet's load the packages into our session to make them available:\n\n::: {#888de9c2 .cell execution_count=2}\n``` {.python .cell-code}\nimport requests\nimport pymupdf\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bright-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-bright-red-fg\">ModuleNotFoundError</span>                       Traceback (most recent call last)\n<span class=\"ansi-bright-cyan-fg\">Cell</span><span class=\"ansi-bright-cyan-fg\"> </span><span class=\"ansi-green-fg\">In[1]</span><span class=\"ansi-green-fg\">, line 2</span>\n<span class=\"ansi-bright-green-fg\">      1</span> <span style=\"color:rgb(255,95,135)\">import</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg\">requests</span>\n<span class=\"ansi-bright-green-fg\">----&gt; </span><span class=\"ansi-bright-green-fg\">2</span> <span style=\"color:rgb(255,95,135)\">import</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg\">pymupdf</span>\n\n<span class=\"ansi-bright-red-fg\">ModuleNotFoundError</span>: No module named 'pymupdf'</pre>\n```\n:::\n\n:::\n:::\n\n\n## Download the data\n\nFirst, let's create a string with the URL of the online pdf:\n\n::: {#ee52d809 .cell execution_count=3}\n``` {.python .cell-code}\nurl = \"https://funnyengwish.wordpress.com/wp-content/uploads/2017/05/pratchett_terry_wyrd_sisters_-_royallib_ru.pdf\"\n```\n:::\n\n\nNow we can send a request to that URL to download the data and create a `response` object:\n\n::: {#f6afd95d .cell execution_count=4}\n``` {.python .cell-code}\nresponse = requests.get(url)\n```\n:::\n\n\nLet's print the value of our response to ensure that it was successful:\n\n::: {#8330d3b1 .cell execution_count=5}\n``` {.python .cell-code}\nprint(response)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<Response [200]>\n```\n:::\n:::\n\n\n:::{.note}\n\nOn the list of [HTTP status codes](https://en.wikipedia.org/wiki/List_of_HTTP_status_codes), you can see that `200` means OK. So our request was successful.\n\n:::\n\nThen we extract the text from the pdf:\n\n::: {#220294b6 .cell execution_count=6}\n``` {.python .cell-code}\ndata = response.content\ndoc = pymupdf.Document(stream=data)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bright-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-bright-red-fg\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansi-bright-cyan-fg\">Cell</span><span class=\"ansi-bright-cyan-fg\"> </span><span class=\"ansi-green-fg\">In[5]</span><span class=\"ansi-green-fg\">, line 2</span>\n<span class=\"ansi-bright-green-fg\">      1</span> <span class=\"ansi-bright-white-fg\">data</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg\">response</span><span style=\"color:rgb(255,95,135)\">.</span><span class=\"ansi-bright-white-fg\">content</span>\n<span class=\"ansi-bright-green-fg\">----&gt; </span><span class=\"ansi-bright-green-fg\">2</span> <span class=\"ansi-bright-white-fg\">doc</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg ansi-yellow-bg\">pymupdf</span><span style=\"color:rgb(255,95,135)\">.</span><span class=\"ansi-bright-white-fg\">Document</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">stream</span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\">data</span><span class=\"ansi-bright-white-fg\">)</span>\n\n<span class=\"ansi-bright-red-fg\">NameError</span>: name 'pymupdf' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nLet's explore this `doc` object that we created.\n\nIt is a `Document` object from the pymupdf package:\n\n::: {#1118357c .cell execution_count=7}\n``` {.python .cell-code}\ntype(doc)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bright-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-bright-red-fg\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansi-bright-cyan-fg\">Cell</span><span class=\"ansi-bright-cyan-fg\"> </span><span class=\"ansi-green-fg\">In[6]</span><span class=\"ansi-green-fg\">, line 1</span>\n<span class=\"ansi-bright-green-fg\">----&gt; </span><span class=\"ansi-bright-green-fg\">1</span> <span class=\"ansi-bright-white-fg\">type</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg ansi-yellow-bg\">doc</span><span class=\"ansi-bright-white-fg\">)</span>\n\n<span class=\"ansi-bright-red-fg\">NameError</span>: name 'doc' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nThe first element corresponds to the first page of the pdf:\n\n::: {#910c04f0 .cell execution_count=8}\n``` {.python .cell-code}\ndoc[0]\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bright-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-bright-red-fg\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansi-bright-cyan-fg\">Cell</span><span class=\"ansi-bright-cyan-fg\"> </span><span class=\"ansi-green-fg\">In[7]</span><span class=\"ansi-green-fg\">, line 1</span>\n<span class=\"ansi-bright-green-fg\">----&gt; </span><span class=\"ansi-bright-green-fg\">1</span> <span class=\"ansi-bright-white-fg ansi-yellow-bg\">doc</span><span class=\"ansi-bright-white-fg\">[</span><span style=\"color:rgb(175,135,255)\">0</span><span class=\"ansi-bright-white-fg\">]</span>\n\n<span class=\"ansi-bright-red-fg\">NameError</span>: name 'doc' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n:::{.note}\n\nRemember that indexing in Python starts at `0`.\n\n:::\n\n::: {#7dc7a241 .cell execution_count=9}\n``` {.python .cell-code}\ntype(doc[0])\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bright-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-bright-red-fg\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansi-bright-cyan-fg\">Cell</span><span class=\"ansi-bright-cyan-fg\"> </span><span class=\"ansi-green-fg\">In[8]</span><span class=\"ansi-green-fg\">, line 1</span>\n<span class=\"ansi-bright-green-fg\">----&gt; </span><span class=\"ansi-bright-green-fg\">1</span> <span class=\"ansi-bright-white-fg\">type</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg ansi-yellow-bg\">doc</span><span class=\"ansi-bright-white-fg\">[</span><span style=\"color:rgb(175,135,255)\">0</span><span class=\"ansi-bright-white-fg\">]</span><span class=\"ansi-bright-white-fg\">)</span>\n\n<span class=\"ansi-bright-red-fg\">NameError</span>: name 'doc' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nThe pdf had 139 pages:\n\n::: {#4eada3f1 .cell execution_count=10}\n``` {.python .cell-code}\nlen(doc)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bright-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-bright-red-fg\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansi-bright-cyan-fg\">Cell</span><span class=\"ansi-bright-cyan-fg\"> </span><span class=\"ansi-green-fg\">In[9]</span><span class=\"ansi-green-fg\">, line 1</span>\n<span class=\"ansi-bright-green-fg\">----&gt; </span><span class=\"ansi-bright-green-fg\">1</span> <span class=\"ansi-bright-white-fg\">len</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg ansi-yellow-bg\">doc</span><span class=\"ansi-bright-white-fg\">)</span>\n\n<span class=\"ansi-bright-red-fg\">NameError</span>: name 'doc' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nWe can get the text of the first page with the `get_text` method. Let's create an string that we call `page1` with this text:\n\n::: {#a39fe2f9 .cell execution_count=11}\n``` {.python .cell-code}\npage1 = doc[0].get_text()\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bright-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-bright-red-fg\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansi-bright-cyan-fg\">Cell</span><span class=\"ansi-bright-cyan-fg\"> </span><span class=\"ansi-green-fg\">In[10]</span><span class=\"ansi-green-fg\">, line 1</span>\n<span class=\"ansi-bright-green-fg\">----&gt; </span><span class=\"ansi-bright-green-fg\">1</span> <span class=\"ansi-bright-white-fg\">page1</span><span class=\"ansi-bright-white-fg\"> </span><span style=\"color:rgb(255,95,135)\">=</span><span class=\"ansi-bright-white-fg\"> </span><span class=\"ansi-bright-white-fg ansi-yellow-bg\">doc</span><span class=\"ansi-bright-white-fg\">[</span><span style=\"color:rgb(175,135,255)\">0</span><span class=\"ansi-bright-white-fg\">]</span><span style=\"color:rgb(255,95,135)\">.</span><span class=\"ansi-bright-white-fg\">get_text</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg\">)</span>\n\n<span class=\"ansi-bright-red-fg\">NameError</span>: name 'doc' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\nWe can now print the text of the first page of the pdf:\n\n::: {#0e43b32d .cell execution_count=12}\n``` {.python .cell-code}\nprint(page1)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bright-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-bright-red-fg\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansi-bright-cyan-fg\">Cell</span><span class=\"ansi-bright-cyan-fg\"> </span><span class=\"ansi-green-fg\">In[11]</span><span class=\"ansi-green-fg\">, line 1</span>\n<span class=\"ansi-bright-green-fg\">----&gt; </span><span class=\"ansi-bright-green-fg\">1</span> <span class=\"ansi-bright-white-fg\">print</span><span class=\"ansi-bright-white-fg\">(</span><span class=\"ansi-bright-white-fg ansi-yellow-bg\">page1</span><span class=\"ansi-bright-white-fg\">)</span>\n\n<span class=\"ansi-bright-red-fg\">NameError</span>: name 'page1' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n",
    "supporting": [
      "nlp_data_files"
    ],
    "filters": [],
    "includes": {}
  }
}
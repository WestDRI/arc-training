{
  "hash": "55ed514c96143952b5531be10229153d",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: DataFrames inspection\nauthor: Marie-Hélène Burle\n---\n\n:::{.def}\n\nOnce we have a DataFrame, it is important to quickly get some basic information about it. In this section, we will see how to do so.\n\n:::\n\nLet's use the [la_riots dataset](https://github.com/vega/vega-datasets/blob/main/datapackage.md#la_riots), an open-source dataset on fatalities during the civil unrest in Los Angeles in April and May 1992, provided by the plotting library [Vega-Altair](https://altair-viz.github.io/). The dataset is hosted online as a CSV file.\n\nYou can read in a CSV file (local or from the Internet) with [`polars.read_csv`](https://docs.pola.rs/api/python/stable/reference/api/polars.read_csv.html):\n\n::: {#87aeb8f4 .cell execution_count=2}\n``` {.python .cell-code}\nimport polars as pl\n\ndf = pl.read_csv(\"https://cdn.jsdelivr.net/npm/vega-datasets/data/la-riots.csv\")\nprint(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nshape: (63, 11)\n┌─────────────┬───────────┬─────┬────────┬───┬─────────────┬─────────────┬─────────────┬───────────┐\n│ first_name  ┆ last_name ┆ age ┆ gender ┆ … ┆ neighborhoo ┆ type        ┆ longitude   ┆ latitude  │\n│ ---         ┆ ---       ┆ --- ┆ ---    ┆   ┆ d           ┆ ---         ┆ ---         ┆ ---       │\n│ str         ┆ str       ┆ i64 ┆ str    ┆   ┆ ---         ┆ str         ┆ f64         ┆ f64       │\n│             ┆           ┆     ┆        ┆   ┆ str         ┆             ┆             ┆           │\n╞═════════════╪═══════════╪═════╪════════╪═══╪═════════════╪═════════════╪═════════════╪═══════════╡\n│ Cesar A.    ┆ Aguilar   ┆ 18  ┆ Male   ┆ … ┆ Westlake    ┆ Officer-inv ┆ -118.273976 ┆ 34.059281 │\n│             ┆           ┆     ┆        ┆   ┆             ┆ olved       ┆             ┆           │\n│             ┆           ┆     ┆        ┆   ┆             ┆ shooting    ┆             ┆           │\n│ George      ┆ Alvarez   ┆ 42  ┆ Male   ┆ … ┆ Chinatown   ┆ Not riot-re ┆ -118.234098 ┆ 34.06269  │\n│             ┆           ┆     ┆        ┆   ┆             ┆ lated       ┆             ┆           │\n│ Wilson      ┆ Alvarez   ┆ 40  ┆ Male   ┆ … ┆ Hawthorne   ┆ Homicide    ┆ -118.326816 ┆ 33.901662 │\n│ Brian E.    ┆ Andrew    ┆ 30  ┆ Male   ┆ … ┆ Compton     ┆ Officer-inv ┆ -118.21539  ┆ 33.903457 │\n│             ┆           ┆     ┆        ┆   ┆             ┆ olved       ┆             ┆           │\n│             ┆           ┆     ┆        ┆   ┆             ┆ shooting    ┆             ┆           │\n│ Vivian      ┆ Austin    ┆ 87  ┆ Female ┆ … ┆ Harvard     ┆ Death       ┆ -118.304741 ┆ 33.985667 │\n│             ┆           ┆     ┆        ┆   ┆ Park        ┆             ┆             ┆           │\n│ …           ┆ …         ┆ …   ┆ …      ┆ … ┆ …           ┆ …           ┆ …           ┆ …         │\n│ Fredrick    ┆ Ward      ┆ 20  ┆ Male   ┆ … ┆ Pacoima     ┆ Homicide    ┆ -118.412778 ┆ 34.287098 │\n│ Louis A.    ┆ Watson    ┆ 18  ┆ Male   ┆ … ┆ Vermont     ┆ Homicide    ┆ -118.291557 ┆ 34.005244 │\n│             ┆           ┆     ┆        ┆   ┆ Square      ┆             ┆             ┆           │\n│ Elbert O.   ┆ Wilkins   ┆ 33  ┆ Male   ┆ … ┆ Gramercy    ┆ Homicide    ┆ -118.310004 ┆ 33.952767 │\n│             ┆           ┆     ┆        ┆   ┆ Park        ┆             ┆             ┆           │\n│ John H.     ┆ Willers   ┆ 37  ┆ Male   ┆ … ┆ Mission     ┆ Homicide    ┆ -118.46777  ┆ 34.263184 │\n│             ┆           ┆     ┆        ┆   ┆ Hills       ┆             ┆             ┆           │\n│ Willie      ┆ Williams  ┆ 29  ┆ Male   ┆ … ┆ Chesterfiel ┆ Death       ┆ -118.308952 ┆ 33.982363 │\n│ Bernard     ┆           ┆     ┆        ┆   ┆ d Square    ┆             ┆             ┆           │\n└─────────────┴───────────┴─────┴────────┴───┴─────────────┴─────────────┴─────────────┴───────────┘\n```\n:::\n:::\n\n\n## Printing a few rows\n\nPrint first rows (5 by default):\n\n::: {#51708a23 .cell execution_count=3}\n``` {.python .cell-code}\nprint(df.head())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nshape: (5, 11)\n┌────────────┬───────────┬─────┬────────┬───┬──────────────┬─────────────┬─────────────┬───────────┐\n│ first_name ┆ last_name ┆ age ┆ gender ┆ … ┆ neighborhood ┆ type        ┆ longitude   ┆ latitude  │\n│ ---        ┆ ---       ┆ --- ┆ ---    ┆   ┆ ---          ┆ ---         ┆ ---         ┆ ---       │\n│ str        ┆ str       ┆ i64 ┆ str    ┆   ┆ str          ┆ str         ┆ f64         ┆ f64       │\n╞════════════╪═══════════╪═════╪════════╪═══╪══════════════╪═════════════╪═════════════╪═══════════╡\n│ Cesar A.   ┆ Aguilar   ┆ 18  ┆ Male   ┆ … ┆ Westlake     ┆ Officer-inv ┆ -118.273976 ┆ 34.059281 │\n│            ┆           ┆     ┆        ┆   ┆              ┆ olved       ┆             ┆           │\n│            ┆           ┆     ┆        ┆   ┆              ┆ shooting    ┆             ┆           │\n│ George     ┆ Alvarez   ┆ 42  ┆ Male   ┆ … ┆ Chinatown    ┆ Not riot-re ┆ -118.234098 ┆ 34.06269  │\n│            ┆           ┆     ┆        ┆   ┆              ┆ lated       ┆             ┆           │\n│ Wilson     ┆ Alvarez   ┆ 40  ┆ Male   ┆ … ┆ Hawthorne    ┆ Homicide    ┆ -118.326816 ┆ 33.901662 │\n│ Brian E.   ┆ Andrew    ┆ 30  ┆ Male   ┆ … ┆ Compton      ┆ Officer-inv ┆ -118.21539  ┆ 33.903457 │\n│            ┆           ┆     ┆        ┆   ┆              ┆ olved       ┆             ┆           │\n│            ┆           ┆     ┆        ┆   ┆              ┆ shooting    ┆             ┆           │\n│ Vivian     ┆ Austin    ┆ 87  ┆ Female ┆ … ┆ Harvard Park ┆ Death       ┆ -118.304741 ┆ 33.985667 │\n└────────────┴───────────┴─────┴────────┴───┴──────────────┴─────────────┴─────────────┴───────────┘\n```\n:::\n:::\n\n\n::: {#74d9b6a9 .cell execution_count=4}\n``` {.python .cell-code}\nprint(df.head(2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nshape: (2, 11)\n┌────────────┬───────────┬─────┬────────┬───┬──────────────┬─────────────┬─────────────┬───────────┐\n│ first_name ┆ last_name ┆ age ┆ gender ┆ … ┆ neighborhood ┆ type        ┆ longitude   ┆ latitude  │\n│ ---        ┆ ---       ┆ --- ┆ ---    ┆   ┆ ---          ┆ ---         ┆ ---         ┆ ---       │\n│ str        ┆ str       ┆ i64 ┆ str    ┆   ┆ str          ┆ str         ┆ f64         ┆ f64       │\n╞════════════╪═══════════╪═════╪════════╪═══╪══════════════╪═════════════╪═════════════╪═══════════╡\n│ Cesar A.   ┆ Aguilar   ┆ 18  ┆ Male   ┆ … ┆ Westlake     ┆ Officer-inv ┆ -118.273976 ┆ 34.059281 │\n│            ┆           ┆     ┆        ┆   ┆              ┆ olved       ┆             ┆           │\n│            ┆           ┆     ┆        ┆   ┆              ┆ shooting    ┆             ┆           │\n│ George     ┆ Alvarez   ┆ 42  ┆ Male   ┆ … ┆ Chinatown    ┆ Not riot-re ┆ -118.234098 ┆ 34.06269  │\n│            ┆           ┆     ┆        ┆   ┆              ┆ lated       ┆             ┆           │\n└────────────┴───────────┴─────┴────────┴───┴──────────────┴─────────────┴─────────────┴───────────┘\n```\n:::\n:::\n\n\nPrint last rows (5 by default):\n\n::: {#f164ed0a .cell execution_count=5}\n``` {.python .cell-code}\nprint(df.tail(2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nshape: (2, 11)\n┌───────────────┬───────────┬─────┬────────┬───┬──────────────┬──────────┬─────────────┬───────────┐\n│ first_name    ┆ last_name ┆ age ┆ gender ┆ … ┆ neighborhood ┆ type     ┆ longitude   ┆ latitude  │\n│ ---           ┆ ---       ┆ --- ┆ ---    ┆   ┆ ---          ┆ ---      ┆ ---         ┆ ---       │\n│ str           ┆ str       ┆ i64 ┆ str    ┆   ┆ str          ┆ str      ┆ f64         ┆ f64       │\n╞═══════════════╪═══════════╪═════╪════════╪═══╪══════════════╪══════════╪═════════════╪═══════════╡\n│ John H.       ┆ Willers   ┆ 37  ┆ Male   ┆ … ┆ Mission      ┆ Homicide ┆ -118.46777  ┆ 34.263184 │\n│               ┆           ┆     ┆        ┆   ┆ Hills        ┆          ┆             ┆           │\n│ Willie        ┆ Williams  ┆ 29  ┆ Male   ┆ … ┆ Chesterfield ┆ Death    ┆ -118.308952 ┆ 33.982363 │\n│ Bernard       ┆           ┆     ┆        ┆   ┆ Square       ┆          ┆             ┆           │\n└───────────────┴───────────┴─────┴────────┴───┴──────────────┴──────────┴─────────────┴───────────┘\n```\n:::\n:::\n\n\nPrint random rows (this is very useful as the head and tail of your DataFrame may not be representative of your data):\n\n::: {#fd757e5c .cell execution_count=6}\n``` {.python .cell-code}\nimport random\n\nprint(df.sample(4))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nshape: (4, 11)\n┌────────────┬───────────┬─────┬────────┬───┬─────────────────┬──────────┬─────────────┬───────────┐\n│ first_name ┆ last_name ┆ age ┆ gender ┆ … ┆ neighborhood    ┆ type     ┆ longitude   ┆ latitude  │\n│ ---        ┆ ---       ┆ --- ┆ ---    ┆   ┆ ---             ┆ ---      ┆ ---         ┆ ---       │\n│ str        ┆ str       ┆ i64 ┆ str    ┆   ┆ str             ┆ str      ┆ f64         ┆ f64       │\n╞════════════╪═══════════╪═════╪════════╪═══╪═════════════════╪══════════╪═════════════╪═══════════╡\n│ Darnell R. ┆ Mallory   ┆ 18  ┆ Male   ┆ … ┆ Hollywood       ┆ Death    ┆ -118.334138 ┆ 34.090972 │\n│ Paul D.    ┆ Horace    ┆ 38  ┆ Male   ┆ … ┆ Central-Alameda ┆ Homicide ┆ -118.247414 ┆ 34.021735 │\n│ Louis A.   ┆ Watson    ┆ 18  ┆ Male   ┆ … ┆ Vermont Square  ┆ Homicide ┆ -118.291557 ┆ 34.005244 │\n│ Ira F.     ┆ McCurry   ┆ 45  ┆ Male   ┆ … ┆ Green Meadows   ┆ Homicide ┆ -118.265163 ┆ 33.943756 │\n└────────────┴───────────┴─────┴────────┴───┴─────────────────┴──────────┴─────────────┴───────────┘\n```\n:::\n:::\n\n\n## Structure\n\nOverview of the DataFrame and its structure:\n\n::: {#4d63ec09 .cell execution_count=7}\n``` {.python .cell-code}\ndf.glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 63\nColumns: 11\n$ first_name   <str> 'Cesar A.', 'George', 'Wilson', 'Brian E.', 'Vivian', 'Franklin', 'Carol', 'Patrick', 'Hector', 'Jerel L.'\n$ last_name    <str> 'Aguilar', 'Alvarez', 'Alvarez', 'Andrew', 'Austin', 'Benavidez', 'Benson', 'Bettan', 'Castro', 'Channell'\n$ age          <i64> 18, 42, 40, 30, 87, 27, 42, 30, 49, 26\n$ gender       <str> 'Male', 'Male', 'Male', 'Male', 'Female', 'Male', 'Female', 'Male', 'Male', 'Male'\n$ race         <str> 'Latino', 'Latino', 'Latino', 'Black', 'Black', 'Latino', 'Black', 'White', 'Latino', 'Black'\n$ death_date   <str> '1992-04-30', '1992-05-01', '1992-05-23', '1992-04-30', '1992-05-03', '1992-04-30', '1992-05-02', '1992-04-30', '1992-04-30', '1992-04-30'\n$ address      <str> '2009 W. 6th St.', 'Main & College streets', '3100 Rosecrans Ave.', 'Rosecrans & Chester avenues', '1600 W. 60th St.', '4404 S. Western Ave.', 'Harbor Freeway near Slauson Avenue', '2740 W. Olympic Blvd.', 'Vermont & Leeward avenues', 'Santa Monica Boulevard & Seward Street'\n$ neighborhood <str> 'Westlake', 'Chinatown', 'Hawthorne', 'Compton', 'Harvard Park', 'Vermont Square', 'South Park', 'Koreatown', 'Koreatown', 'Hollywood'\n$ type         <str> 'Officer-involved shooting', 'Not riot-related', 'Homicide', 'Officer-involved shooting', 'Death', 'Officer-involved shooting', 'Death', 'Homicide', 'Homicide', 'Death'\n$ longitude    <f64> -118.2739756, -118.2340982, -118.326816, -118.2153903, -118.304741, -118.3088215, -118.2805037, -118.293181, -118.291654, -118.3323783\n$ latitude     <f64> 34.0592814, 34.0626901, 33.901662, 33.9034569, 33.985667, 34.0034731, 33.98916756, 34.052068, 34.0587022, 34.09129756\n\n```\n:::\n:::\n\n\n:::{.note}\n\nThis is similar to the `str()` function in R.\n\n:::\n\nThe list of columns (variable names) can be accessed with the `columns` attribute:\n\n::: {#cffaf3f7 .cell execution_count=8}\n``` {.python .cell-code}\nprint(df.columns)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n['first_name', 'last_name', 'age', 'gender', 'race', 'death_date', 'address', 'neighborhood', 'type', 'longitude', 'latitude']\n```\n:::\n:::\n\n\nTo print a list of the data types of each variable, you can use:\n\n::: {#89532f77 .cell execution_count=9}\n``` {.python .cell-code}\nprint(df.dtypes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[String, String, Int64, String, String, String, String, String, String, Float64, Float64]\n```\n:::\n:::\n\n\nBut the printing of a Polars DataFrame already gives you this information (along with the shape).\n\nThe schema of a Polars DataFrame sets the names of the variables (columns) and their data types:\n\n::: {#246ef804 .cell execution_count=10}\n``` {.python .cell-code}\ndf.schema\n```\n\n::: {.cell-output .cell-output-display execution_count=20}\n```\nSchema([('first_name', String),\n        ('last_name', String),\n        ('age', Int64),\n        ('gender', String),\n        ('race', String),\n        ('death_date', String),\n        ('address', String),\n        ('neighborhood', String),\n        ('type', String),\n        ('longitude', Float64),\n        ('latitude', Float64)])\n```\n:::\n:::\n\n\n## Summary statistics\n\nThe statistics (mean, standard deviation, min, max, and quartiles) may not be meaningful, depending on your data, but it will always give you one useful piece of information: the number of missing values for each variable. Here, additionally, it is useful for the `age` variable:\n\n::: {#cc3f8529 .cell execution_count=11}\n``` {.python .cell-code}\nprint(df.describe())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nshape: (9, 12)\n┌───────────┬───────────┬───────────┬───────────┬───┬───────────┬───────────┬───────────┬──────────┐\n│ statistic ┆ first_nam ┆ last_name ┆ age       ┆ … ┆ neighborh ┆ type      ┆ longitude ┆ latitude │\n│ ---       ┆ e         ┆ ---       ┆ ---       ┆   ┆ ood       ┆ ---       ┆ ---       ┆ ---      │\n│ str       ┆ ---       ┆ str       ┆ f64       ┆   ┆ ---       ┆ str       ┆ f64       ┆ f64      │\n│           ┆ str       ┆           ┆           ┆   ┆ str       ┆           ┆           ┆          │\n╞═══════════╪═══════════╪═══════════╪═══════════╪═══╪═══════════╪═══════════╪═══════════╪══════════╡\n│ count     ┆ 63        ┆ 63        ┆ 62.0      ┆ … ┆ 63        ┆ 63        ┆ 63.0      ┆ 63.0     │\n│ null_coun ┆ 0         ┆ 0         ┆ 1.0       ┆ … ┆ 0         ┆ 0         ┆ 0.0       ┆ 0.0      │\n│ t         ┆           ┆           ┆           ┆   ┆           ┆           ┆           ┆          │\n│ mean      ┆ null      ┆ null      ┆ 32.370968 ┆ … ┆ null      ┆ null      ┆ -118.2799 ┆ 34.02671 │\n│           ┆           ┆           ┆           ┆   ┆           ┆           ┆ 1         ┆ 3        │\n│ std       ┆ null      ┆ null      ┆ 14.253253 ┆ … ┆ null      ┆ null      ┆ 0.105198  ┆ 0.098471 │\n│ min       ┆ Aaron     ┆ Aguilar   ┆ 15.0      ┆ … ┆ Altadena  ┆ Death     ┆ -118.4717 ┆ 33.78985 │\n│           ┆           ┆           ┆           ┆   ┆           ┆           ┆ 45        ┆ 7        │\n│ 25%       ┆ null      ┆ null      ┆ 21.0      ┆ … ┆ null      ┆ null      ┆ -118.3098 ┆ 33.97418 │\n│           ┆           ┆           ┆           ┆   ┆           ┆           ┆ 22        ┆          │\n│ 50%       ┆ null      ┆ null      ┆ 31.0      ┆ … ┆ null      ┆ null      ┆ -118.2914 ┆ 34.00548 │\n│           ┆           ┆           ┆           ┆   ┆           ┆           ┆ 95        ┆ 5        │\n│ 75%       ┆ null      ┆ null      ┆ 38.0      ┆ … ┆ null      ┆ null      ┆ -118.2531 ┆ 34.07023 │\n│           ┆           ┆           ┆           ┆   ┆           ┆           ┆ 97        ┆ 8        │\n│ max       ┆ Wilson    ┆ Williams  ┆ 87.0      ┆ … ┆ Westlake  ┆ Officer-i ┆ -117.7306 ┆ 34.28709 │\n│           ┆           ┆           ┆           ┆   ┆           ┆ nvolved   ┆ 47        ┆ 8        │\n│           ┆           ┆           ┆           ┆   ┆           ┆ shooting  ┆           ┆          │\n└───────────┴───────────┴───────────┴───────────┴───┴───────────┴───────────┴───────────┴──────────┘\n```\n:::\n:::\n\n\n",
    "supporting": [
      "polars_inspection_files"
    ],
    "filters": [],
    "includes": {}
  }
}
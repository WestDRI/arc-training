{
  "hash": "e4d0e25a8013b825701ce9f36d7ba594",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"matplotlib: a brief introduction\"\nauthor: Marie-Hélène Burle\n---\n\n:::{.def}\n\nWe don't have time in this course to cover matplotlib at length, but this section will get you started with the library. The [website](https://matplotlib.org/) contains the full documentation along with many examples and tutorials.\n\n:::\n\n## Input data\n\nAt its chore, matplotlib is a library for arrays and it needs [NumPy ndarrays](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray) or objects that can be converted to them as input (such as [Polars](https://docs.pola.rs/) and [pandas](https://pandas.pydata.org/) DataFrames).\n\n## Plots elements\n\nA matplotlib plot is typically made of several elements, all subclasses of the [`Artist` class](https://matplotlib.org/stable/api/artist_api.html#matplotlib.artist.Artist):\n\n- a [`Figure`](https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure) (the container for the plot),\n- one or more [`Axes`](https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes) (the subplot(s) within your plot),\n- all the objects contained in each of the Axes:\n  - [`Axis`](https://matplotlib.org/stable/api/axis_api.html#matplotlib.axis.Axis) (ticks and ticks labels),\n  - [`Text` objects](https://matplotlib.org/stable/api/text_api.html#matplotlib.text.Text),\n  - [`Line2D` objects](https://matplotlib.org/stable/api/_as_gen/matplotlib.lines.Line2D.html#matplotlib.lines.Line2D) (lines in 2D graphs),\n  - [`Polygon` objects](https://matplotlib.org/stable/api/_as_gen/matplotlib.patches.Polygon.html#matplotlib.patches.Polygon),\n  - etc.\n\n![from [matplotlib website](https://matplotlib.org/stable/users/explain/quick_start.html)](img/matplotlib_elements.png)\n\nLet's explore some of these elements.\n\n## Figure\n\nThe common way to use matplotlib is via the `pyplot` API:\n\n::: {#253734cb .cell execution_count=2}\n``` {.python .cell-code}\nimport matplotlib.pyplot as plt\n```\n:::\n\n\nYou can define a `Figure` with [`matplotlib.pyplot.figure`](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html):\n\n::: {#d3721714 .cell execution_count=3}\n``` {.python .cell-code}\nfig = plt.figure()\n```\n\n::: {.cell-output .cell-output-display}\n```\n<Figure size 672x480 with 0 Axes>\n```\n:::\n:::\n\n\n::: {#316fdd32 .cell execution_count=4}\n``` {.python .cell-code}\nprint(fig)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nFigure(672x480)\n```\n:::\n:::\n\n\nYou can change the dimensions of a `Figure`:\n\n::: {#039913a1 .cell execution_count=5}\n``` {.python .cell-code}\nfig = plt.figure(figsize=(9, 7))\n```\n\n::: {.cell-output .cell-output-display}\n```\n<Figure size 864x672 with 0 Axes>\n```\n:::\n:::\n\n\n## Figure and Axes\n\n### Single Axes\n\nYou can create a `Figure` as we saw above, then add `Axes` with [`matplotlib.figure.Figure.subplots`](https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.subplots.html):\n\n::: {#ef8aa322 .cell execution_count=6}\n``` {.python .cell-code}\nfig = plt.figure()\nax = fig.subplots()\n```\n\n::: {.cell-output .cell-output-display}\n![](intro_matplotlib_files/figure-html/cell-6-output-1.png){width=581 height=416}\n:::\n:::\n\n\n:::{.note}\n\nIn Jupyter notebooks, matplotlib plots are displayed automatically as soon as they have `Axes`. Outside of Jupyter, you display the plot with [`matplotlib.pyplot.show`](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show) (which means that here, you would run `plt.show()`).\n\n:::\n\nIf you don't pass any argument to `subplots`, this creates a single `Axes`.\n\n[`matplotlib.pyplot.subplots`](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots) provides a convenient way to create a `Figure` and the `Axes` at the same time:\n\n::: {#323d3928 .cell execution_count=7}\n``` {.python .cell-code}\nfig, ax = plt.subplots()\n```\n\n::: {.cell-output .cell-output-display}\n![](intro_matplotlib_files/figure-html/cell-7-output-1.png){width=581 height=416}\n:::\n:::\n\n\n::: {#2bcccc29 .cell execution_count=8}\n``` {.python .cell-code}\nprint(type(fig))\nprint(type(ax))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<class 'matplotlib.figure.Figure'>\n<class 'matplotlib.axes._axes.Axes'>\n```\n:::\n:::\n\n\n### Multiple Axes\n\nIf you pass values to the arguments `nrows` and `ncols` of the `subplots` function (their defaults are `1`), this creates an array of `Axes` and thus multiple subplots in the plot:\n\n::: {#d36432b7 .cell execution_count=9}\n``` {.python .cell-code}\nfig, axs = plt.subplots(2, 3)\n```\n\n::: {.cell-output .cell-output-display}\n![](intro_matplotlib_files/figure-html/cell-9-output-1.png){width=581 height=416}\n:::\n:::\n\n\nThe default is a little squished. We can fix that by increasing the size of the `Figure`:\n\n::: {#93dd777f .cell execution_count=10}\n``` {.python .cell-code}\nfig, axs = plt.subplots(2, 3, figsize=(9, 7))\n```\n\n::: {.cell-output .cell-output-display}\n![](intro_matplotlib_files/figure-html/cell-10-output-1.png){width=734 height=564}\n:::\n:::\n\n\n::: {#b81b77d5 .cell execution_count=11}\n``` {.python .cell-code}\nprint(type(fig))\nprint(type(axs))\nprint(axs.shape)\nprint(axs)\nprint(type(axs[0][0]))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<class 'matplotlib.figure.Figure'>\n<class 'numpy.ndarray'>\n(2, 3)\n[[<Axes: > <Axes: > <Axes: >]\n [<Axes: > <Axes: > <Axes: >]]\n<class 'matplotlib.axes._axes.Axes'>\n```\n:::\n:::\n\n\n[`matplotlib.pyplot.subplot_mosaic\n`](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplot_mosaic.html#matplotlib.pyplot.subplot_mosaic) allows to customize the location of the various `Axes` thanks to nested lists:\n\n::: {#eb0aa05a .cell execution_count=12}\n``` {.python .cell-code}\nfig, axs = plt.subplot_mosaic([['A', 'B'],\n                               ['A', 'C']], figsize=(9, 7))\n```\n\n::: {.cell-output .cell-output-display}\n![](intro_matplotlib_files/figure-html/cell-12-output-1.png){width=730 height=564}\n:::\n:::\n\n\n::: {#55e18742 .cell execution_count=13}\n``` {.python .cell-code}\nfig, axs = plt.subplot_mosaic([['A', 'A', 'B'],\n                               ['C', '.', 'B']], figsize=(9, 7))\n```\n\n::: {.cell-output .cell-output-display}\n![](intro_matplotlib_files/figure-html/cell-13-output-1.png){width=734 height=564}\n:::\n:::\n\n\n::: {#1ce3f1d6 .cell execution_count=14}\n``` {.python .cell-code}\nfig, axs = plt.subplot_mosaic([['A', 'B'],\n                               ['A', 'B']], figsize=(9, 7))\n```\n\n::: {.cell-output .cell-output-display}\n![](intro_matplotlib_files/figure-html/cell-14-output-1.png){width=730 height=564}\n:::\n:::\n\n\n## Adding data\n\n### Single Axes\n\nLet's make up some array data:\n\n::: {#ab7abfae .cell execution_count=15}\n``` {.python .cell-code}\nimport numpy as np\n\nx = np.linspace(0, 10, 100)\ny = 4 + 1 * np.sin(2 * x)\n```\n:::\n\n\nNow, let's plot a `Figure` with a single `Axes` and our data:\n\n::: {#68a09a1f .cell execution_count=16}\n``` {.python .cell-code}\nfig, ax = plt.subplots()\nax.plot(x, y)\n```\n\n::: {.cell-output .cell-output-display}\n![](intro_matplotlib_files/figure-html/cell-16-output-1.png){width=579 height=411}\n:::\n:::\n\n\nThe [`matplotlib.axes.Axes.plot`](https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.plot.html#matplotlib.axes.Axes.plot) function plots the 2^nd^ argument (`y` here) as the dependent variable and the 1^st^ argument (`x` here) as the independent variable as lines and/or markers using an object of the class [`matplotlib.lines.Line2D`](https://matplotlib.org/stable/api/_as_gen/matplotlib.lines.Line2D.html#matplotlib.lines.Line2D).\n\n:::{.note}\n\nIf we don't want to print the address in memory of our `Line2D`, we can add a semi-colon after the `plot` function:\n\n::: {#c453527c .cell execution_count=17}\n``` {.python .cell-code}\nfig, ax = plt.subplots()\nax.plot(x, y);\n```\n\n::: {.cell-output .cell-output-display}\n![](intro_matplotlib_files/figure-html/cell-17-output-1.png){width=579 height=411}\n:::\n:::\n\n\n:::\n\nYou can customize the line and/or add makers by passing arguments to the `plot` function.\n\n::: {#5daf4cd3 .cell execution_count=18}\n``` {.python .cell-code}\n# Customize line:\nfig, ax = plt.subplots()\nax.plot(x, y, linewidth=4, color='g', linestyle=':');\n```\n\n::: {.cell-output .cell-output-display}\n![](intro_matplotlib_files/figure-html/cell-18-output-1.png){width=579 height=411}\n:::\n:::\n\n\n::: {#f41b5ddd .cell execution_count=19}\n``` {.python .cell-code}\n# Add markers:\nfig, ax = plt.subplots()\nax.plot(x, y, marker='*');\n```\n\n::: {.cell-output .cell-output-display}\n![](intro_matplotlib_files/figure-html/cell-19-output-1.png){width=579 height=411}\n:::\n:::\n\n\nYou can add more data to the plot:\n\n::: {#48137318 .cell execution_count=20}\n``` {.python .cell-code}\ny2 = np.cos(x)\n\nfig, ax = plt.subplots()\nax.plot(x, y)\nax.plot(x, y2);\n```\n\n::: {.cell-output .cell-output-display}\n![](intro_matplotlib_files/figure-html/cell-20-output-1.png){width=569 height=411}\n:::\n:::\n\n\nWe can add a legend, title, and axes labels:\n\n::: {#62a81863 .cell execution_count=21}\n``` {.python .cell-code}\nfig, ax = plt.subplots()\nax.plot(x, y, label='Data 1')\nax.plot(x, y2, label='Data 2')\nax.legend()\nax.set_xlabel('x')\nax.set_ylabel('y')\nax.set_title('Example plot');\n```\n\n::: {.cell-output .cell-output-display}\n![](intro_matplotlib_files/figure-html/cell-21-output-1.png){width=587 height=449}\n:::\n:::\n\n\n### Multiple Axes\n\nWe also of course add data to a plot with multiple `Axes`:\n\n::: {#6eba3c96 .cell execution_count=22}\n``` {.python .cell-code}\nfig, axs = plt.subplots(1, 2, figsize=(9, 7))\naxs[0].plot(x, y)\naxs[1].plot(x, y2);\n```\n\n::: {.cell-output .cell-output-display}\n![](intro_matplotlib_files/figure-html/cell-22-output-1.png){width=728 height=559}\n:::\n:::\n\n\n:::{.exo}\n\n:::{.yourturn}\n\nYour turn:\n\n:::\n\nAdd axes labels and a title for each of the subplot to get something similar to the figure below:\n\n::: {#29711557 .cell execution_count=23}\n\n::: {.cell-output .cell-output-display}\n![](intro_matplotlib_files/figure-html/cell-23-output-1.png){width=683 height=491}\n:::\n:::\n\n\n:::\n\n## Complex plots\n\nNow that you understand the fundamentals of matplotlib functioning, you can visit [the gallery](https://matplotlib.org/stable/gallery/), look for plots that match your needs and adapt the code.\n\nHere is an example from the gallery:\n\n::: {#e96ab344 .cell execution_count=24}\n``` {.python .cell-code}\nimport matplotlib.pyplot as plt\nimport numpy as np\n\n\ndef lorenz(xyz, *, s=10, r=28, b=2.667):\n    \"\"\"\n    Parameters\n    ----------\n    xyz : array-like, shape (3,)\n       Point of interest in three-dimensional space.\n    s, r, b : float\n       Parameters defining the Lorenz attractor.\n\n    Returns\n    -------\n    xyz_dot : array, shape (3,)\n       Values of the Lorenz attractor's partial derivatives at *xyz*.\n    \"\"\"\n    x, y, z = xyz\n    x_dot = s*(y - x)\n    y_dot = r*x - y - x*z\n    z_dot = x*y - b*z\n    return np.array([x_dot, y_dot, z_dot])\n\n\ndt = 0.01\nnum_steps = 10000\n\nxyzs = np.empty((num_steps + 1, 3))  # Need one more for the initial values\nxyzs[0] = (0., 1., 1.05)  # Set initial values\n# Step through \"time\", calculating the partial derivatives at the current point\n# and using them to estimate the next point\nfor i in range(num_steps):\n    xyzs[i + 1] = xyzs[i] + lorenz(xyzs[i]) * dt\n\n# Plot\nax = plt.figure().add_subplot(projection='3d')\n\nax.plot(*xyzs.T, lw=0.5)\nax.set_xlabel(\"X Axis\")\nax.set_ylabel(\"Y Axis\")\nax.set_zlabel(\"Z Axis\")\nax.set_title(\"Lorenz Attractor\");\n```\n\n::: {.cell-output .cell-output-display}\n![](intro_matplotlib_files/figure-html/cell-24-output-1.png){width=405 height=414}\n:::\n:::\n\n\n## Saving plots\n\nYou can save a plot with [`matplotlib.figure.Figure.savefig`](https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.savefig.html#matplotlib.figure.Figure.savefig):\n\n```{.python}\nfig.savefig('our_graph.png')\n```\n\nYou can set the size, dpi, file type, etc. of the saved file by passing options to the `savefig` function.\n\nPlots can be saved in `.png`, `.pdf`, `.svg`, `.jpg`, `.tif`, `.gif`, `.raw`, among others.\n\n## A note on syntax\n\nThere are many ways to do anything in matplotlib and you will come across various syntaxes linked with the [many APIs](https://matplotlib.org/stable/users/explain/figure/api_interfaces.html#api-interfaces). This can be very confusing!\n\nIn this course, we stick to the native explicit \"Axes\" interface which is the most customizable and the most standard way to use matplotlib.\n\n",
    "supporting": [
      "intro_matplotlib_files"
    ],
    "filters": [],
    "includes": {}
  }
}
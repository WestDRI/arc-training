---
title: Subsetting data
author: Marie-Hélène Burle
---

:::{.def}

The syntax to subset data is very different in Polars compared to the indexing of pandas and other languages. Action verbs are used in a style very similar to that of [R's dplyr](https://cran.r-project.org/web/packages/dplyr/index.html) from [the tidyverse](https://www.tidyverse.org/).

:::

Let's start with the same data frame we used in the previous section:

```{python}
import polars as pl

df = pl.read_csv("https://raw.githubusercontent.com/razoumov/publish/master/jeopardy.csv")

print(df)
```

## Selecting rows

You can select rows based on any expression that evaluates to a Boolean.

:::{.example}

Example:

:::

```{python}
from datetime import date

df_sub = df.filter(
    pl.col("Air Date") == "5/8/09"
    )

print(df_sub)
```

You can combine conditions:

```{python}
df_sub = df.filter(
    pl.col("Air Date") == "5/8/09",
    pl.col("Round") != "Double Jeopardy!"    
    )

print(df_sub)
```

## Selecting columns

```{python}
df_sub = df.select(
    pl.col("Show Number"),
    pl.col("Category")
    )

print(df_sub)
```

## Creating new columns with output of expressions

```{python}
from datetime import datetime

df_new = df.select(
    show_div=pl.col("Show Number") / 1000
    )

print(df_new)
```

If you want to keep all columns in the output, you use `with_columns`:

```{python}
df_new = df.with_columns(
    show_div=pl.col("Show Number") / 1000
    )

print(df_new)
```
